window.Handsontable={version:"0.15.0-beta5",buildDate:"Wed Jun 03 2015 14:13:30 GMT+0200 (CEST)"};
require=function outer(q,r,a){function e(c,b){if(!r[c]){if(!q[c]){var p="function"==typeof require&&require;if(!b&&p)return p(c,!0);if(d)return d(c,!0);if(k[c]&&"undefined"!==typeof window[k[c]])return window[k[c]];p=Error("Cannot find module '"+c+"'");p.code="MODULE_NOT_FOUND";throw p;}p=r[c]={exports:{}};q[c][0].call(p.exports,function(b){var g=q[c][1][b];return e(g?g:b)},p,p.exports,outer,q,r,a)}return r[c].exports}for(var d="function"==typeof require&&require,k=JSON.parse('{"zeroclipboard":"ZeroClipboard","copyPaste":"copyPaste","SheetClip":"SheetClip","jsonpatch":"jsonpatch","moment":"moment","numeral":"numeral","autoResize":"autoResize","pikaday":"Pikaday"}')||
{},m=0;m<a.length;m++)e(a[m]);return e}({1:[function(h,q,r){window.jQuery&&function(a,e,d){e.fn.handsontable=function(a){var m,c,b,p,l=this.first(),g=l.data("handsontable");if("string"!==typeof a)return m=a||{},g?g.updateSettings(m):(g=new d.Core(l[0],m),l.data("handsontable",g),g.init()),l;b=[];if(1<arguments.length)for(m=1,c=arguments.length;m<c;m++)b.push(arguments[m]);if(g)if("undefined"!==typeof g[a])p=g[a].apply(g,b),"destroy"===a&&l.removeData();else throw Error("Handsontable do not provide action: "+
a);return p}}(window,jQuery,Handsontable)},{}],2:[function(h,q,r){function a(b,l){var g,t=function(){this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};this.selectionHandles.topLeft.className="topLeftSelectionHandle";this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea";this.selectionHandles.bottomRight.className="bottomRightSelectionHandle";
this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea";this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var b={position:"absolute",height:"40px",width:"40px","border-radius":parseInt(40/1.5,10)+"px"},g;for(g in b)b.hasOwnProperty(g)&&(this.selectionHandles.styles.bottomRightHitArea[g]=
b[g],this.selectionHandles.styles.topLeftHitArea[g]=b[g]);b={position:"absolute",height:"10px",width:"10px","border-radius":parseInt(10/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(g in b)b.hasOwnProperty(g)&&(this.selectionHandles.styles.bottomRight[g]=b[g],this.selectionHandles.styles.topLeft[g]=b[g]);this.main.appendChild(this.selectionHandles.topLeft);this.main.appendChild(this.selectionHandles.bottomRight);this.main.appendChild(this.selectionHandles.topLeftHitArea);this.main.appendChild(this.selectionHandles.bottomRightHitArea)};
if(l){var v=c(b);this.instance=b;this.settings=l;this.main=document.createElement("div");g=this.main.style;g.position="absolute";g.top=0;g.left=0;for(var f=["top","left","bottom","right","corner"],n=0;5>n;n++){var w=f[n],m=document.createElement("DIV");m.className="wtBorder "+(this.settings.className||"");this.settings[w]&&this.settings[w].hide&&(m.className+=" hidden");g=m.style;g.backgroundColor=this.settings[w]&&this.settings[w].color?this.settings[w].color:l.border.color;g.height=this.settings[w]&&
this.settings[w].width?this.settings[w].width+"px":l.border.width+"px";g.width=this.settings[w]&&this.settings[w].width?this.settings[w].width+"px":l.border.width+"px";this.main.appendChild(m)}this.top=this.main.childNodes[0];this.left=this.main.childNodes[1];this.bottom=this.main.childNodes[2];this.right=this.main.childNodes[3];this.topStyle=this.top.style;this.leftStyle=this.left.style;this.bottomStyle=this.bottom.style;this.rightStyle=this.right.style;this.cornerDefaultStyle={width:"5px",height:"5px",
borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"};this.corner=this.main.childNodes[4];this.corner.className+=" corner";this.cornerStyle=this.corner.style;this.cornerStyle.width=this.cornerDefaultStyle.width;this.cornerStyle.height=this.cornerDefaultStyle.height;this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" ");Handsontable.mobileBrowser&&t.call(this);this.disappear();b.wtTable.bordersHolder||(b.wtTable.bordersHolder=
document.createElement("div"),b.wtTable.bordersHolder.className="htBorders",b.wtTable.spreader.appendChild(b.wtTable.bordersHolder));b.wtTable.bordersHolder.insertBefore(this.main,b.wtTable.bordersHolder.firstChild);var a=!1;v.addEventListener(document.body,"mousedown",function(){a=!0});v.addEventListener(document.body,"mouseup",function(){a=!1});g=0;for(t=this.main.childNodes.length;g<t;g++)v.addEventListener(this.main.childNodes[g],"mouseenter",function(g){if(a&&b.getSetting("hideBorderOnMouseDownOver")){g.preventDefault();
g.stopImmediatePropagation();var f=this.getBoundingClientRect();this.style.display="none";var n=function(b){b=b.clientY<Math.floor(f.top)||b.clientY>Math.ceil(f.top+f.height)||b.clientX<Math.floor(f.left)||b.clientX>Math.ceil(f.left+f.width)?!0:void 0;b&&(v.removeEventListener(document.body,"mousemove",n),this.style.display="block")};v.addEventListener(document.body,"mousemove",n)}})}}Object.defineProperties(r,{WalkontableBorder:{get:function(){return a}},__esModule:{value:!0}});var e,d,k,m=(e=h("./../../../dom.js"),
e&&e.__esModule&&e||{default:e}),c=(d=h("./../../../eventManager.js"),d&&d.__esModule&&d||{default:d}).eventManager,b=(k=h("./cell/coords.js"),k&&k.__esModule&&k||{default:k}).WalkontableCellCoords;a.prototype.appear=function(c){if(!this.disabled){var l=this.instance,g,t,v,f,n,w,a,e,d,k,F,h=function(){return!this.instance.selections.area.cellRange||k==this.instance.selections.area.cellRange.to.row&&F==this.instance.selections.area.cellRange.to.col?!1:!0},z=function(b,g,f,n){var t=parseInt(this.selectionHandles.styles.topLeft.width,
10),c=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(b-t,10)+"px";this.selectionHandles.styles.topLeft.left=parseInt(g-t,10)+"px";this.selectionHandles.styles.topLeftHitArea.top=parseInt(b-c/4*3,10)+"px";this.selectionHandles.styles.topLeftHitArea.left=parseInt(g-c/4*3,10)+"px";this.selectionHandles.styles.bottomRight.top=parseInt(b+n,10)+"px";this.selectionHandles.styles.bottomRight.left=parseInt(g+f,10)+"px";this.selectionHandles.styles.bottomRightHitArea.top=
parseInt(b+n-c/4,10)+"px";this.selectionHandles.styles.bottomRightHitArea.left=parseInt(g+f-c/4,10)+"px";this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",h.call(this)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display=
"block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none");e==this.instance.wtSettings.getSetting("fixedRowsTop")||d==this.instance.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex=
"9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")};t=l.cloneOverlay instanceof WalkontableTopOverlay||l.cloneOverlay instanceof WalkontableCornerOverlay?l.getSetting("fixedRowsTop"):l.wtTable.getRenderedRowsCount();for(g=0;g<t;g++)if(v=l.wtTable.rowFilter.renderedToSource(g),v>=c[0]&&v<=c[2]){e=v;break}for(g=t-1;0<=g;g--)if(v=l.wtTable.rowFilter.renderedToSource(g),v>=c[0]&&v<=c[2]){k=v;break}t=l.wtTable.getRenderedColumnsCount();for(g=
0;g<t;g++)if(v=l.wtTable.columnFilter.renderedToSource(g),v>=c[1]&&v<=c[3]){d=v;break}for(g=t-1;0<=g;g--)if(v=l.wtTable.columnFilter.renderedToSource(g),v>=c[1]&&v<=c[3]){F=v;break}void 0!==e&&void 0!==d?(g=e!==k||d!==F,t=l.wtTable.getCell(new b(e,d)),c=g?l.wtTable.getCell(new b(k,F)):t,v=m.offset(t),f=g?m.offset(c):v,n=m.offset(l.wtTable.TABLE),w=v.top,g=f.top+m.outerHeight(c)-w,a=v.left,v=f.left+m.outerWidth(c)-a,w=w-n.top-1,n=a-n.left-1,t=m.getComputedStyle(t),0<parseInt(t.borderTopWidth,10)&&
(w+=1,g=0<g?g-1:0),0<parseInt(t.borderLeftWidth,10)&&(n+=1,v=0<v?v-1:0),this.topStyle.top=w+"px",this.topStyle.left=n+"px",this.topStyle.width=v+"px",this.topStyle.display="block",this.leftStyle.top=w+"px",this.leftStyle.left=n+"px",this.leftStyle.height=g+"px",this.leftStyle.display="block",t=Math.floor(this.settings.border.width/2),this.bottomStyle.top=w+g-t+"px",this.bottomStyle.left=n+"px",this.bottomStyle.width=v+"px",this.bottomStyle.display="block",this.rightStyle.top=w+"px",this.rightStyle.left=
n+v-t+"px",this.rightStyle.height=g+1+"px",this.rightStyle.display="block",Handsontable.mobileBrowser||!this.hasSetting(this.settings.border.cornerVisible)||h.call(this)?this.cornerStyle.display="none":(this.cornerStyle.top=w+g-4+"px",this.cornerStyle.left=n+v-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="block",F===this.instance.getSetting("totalColumns")-1&&(l=m.getTrimmingContainer(l.wtTable.TABLE),
c.offsetLeft+m.outerWidth(c)>=m.innerWidth(l)&&(this.cornerStyle.left=Math.floor(n+v-3-parseInt(this.cornerDefaultStyle.width)/2)+"px",this.cornerStyle.borderRightWidth=0))),Handsontable.mobileBrowser&&z.call(this,w,n,v,g)):this.disappear()}};a.prototype.disappear=function(){this.topStyle.display="none";this.leftStyle.display="none";this.bottomStyle.display="none";this.rightStyle.display="none";this.cornerStyle.display="none";Handsontable.mobileBrowser&&(this.selectionHandles.styles.topLeft.display=
"none",this.selectionHandles.styles.bottomRight.display="none")};a.prototype.hasSetting=function(b){return"function"===typeof b?b():!!b};window.WalkontableBorder=a},{"./../../../dom.js":27,"./../../../eventManager.js":41,"./cell/coords.js":5}],3:[function(h,q,r){Object.defineProperties(r,{WalkontableViewportColumnsCalculator:{get:function(){return e}},__esModule:{value:!0}});var a=new WeakMap,e=function(e,m,c,b,p,l,g){a.set(this,{viewportWidth:e,scrollOffset:m,totalColumns:c,columnWidthFn:b,overrideFn:p,
onlyFullyVisible:l});this.count=0;this.startPosition=this.endColumn=this.startColumn=null;this.stretchLastWidth=this.stretchAllRatio=0;this.stretch=g;this.totalTargetWidth=0;this.needVerifyLastColumnWidth=!0;this.stretchAllColumnsWidth=[];this.calculate()},d=e;$traceurRuntime.createClass(e,{calculate:function(){for(var e=0,m=!0,c=[],b,p=a.get(this),l=p.onlyFullyVisible,g=p.overrideFn,t=p.scrollOffset,v=p.totalColumns,p=p.viewportWidth,f=0;f<v;f++)if(b=this._getColumnWidth(f),e<=t&&!l&&(this.startColumn=
f),e>=t&&e+b<=t+p&&(null==this.startColumn&&(this.startColumn=f),this.endColumn=f),c.push(e),e+=b,l||(this.endColumn=f),e>=t+p){m=!1;break}if(this.endColumn===v-1&&m)for(this.startColumn=this.endColumn;0<this.startColumn&&!(e=c[this.endColumn]+b-c[this.startColumn-1],(e<=p||!l)&&this.startColumn--,e>p););null!==this.startColumn&&g&&g(this);this.startPosition=c[this.startColumn];void 0==this.startPosition&&(this.startPosition=null);null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+
1)},refreshStretching:function(e){if("none"!==this.stretch){for(var m=0,c,b=a.get(this).totalColumns,p=0;p<b;p++)c=this._getColumnWidth(p),m+=c;this.totalTargetWidth=e;c=m-e;"all"===this.stretch&&0>c?(this.stretchAllRatio=e/m,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0):"last"===this.stretch&&Infinity!==e&&(this.stretchLastWidth=-c+this._getColumnWidth(b-1))}},getStretchedColumnWidth:function(a,m){var c=null;"all"===this.stretch&&0!==this.stretchAllRatio?c=this._getStretchedAllColumnWidth(a,
m):"last"===this.stretch&&0!==this.stretchLastWidth&&(c=this._getStretchedLastColumnWidth(a));return c},_getStretchedAllColumnWidth:function(e,m){var c=0,b=a.get(this).totalColumns;this.stretchAllColumnsWidth[e]||(this.stretchAllColumnsWidth[e]=Math.round(m*this.stretchAllRatio));if(this.stretchAllColumnsWidth.length===b&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(b=0;b<this.stretchAllColumnsWidth.length;b++)c+=this.stretchAllColumnsWidth[b];c!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-
1]+=this.totalTargetWidth-c)}return this.stretchAllColumnsWidth[e]},_getStretchedLastColumnWidth:function(e){var m=a.get(this).totalColumns;return e===m-1?this.stretchLastWidth:null},_getColumnWidth:function(e){e=a.get(this).columnWidthFn(e);void 0===e&&(e=d.DEFAULT_WIDTH);return e}},{get DEFAULT_WIDTH(){return 50}});window.WalkontableViewportColumnsCalculator=e},{}],4:[function(h,q,r){Object.defineProperties(r,{WalkontableViewportRowsCalculator:{get:function(){return e}},__esModule:{value:!0}});
var a=new WeakMap,e=function(e,m,c,b,p,l){a.set(this,{viewportHeight:e,scrollOffset:m,totalRows:c,rowHeightFn:b,overrideFn:p,onlyFullyVisible:l});this.count=0;this.startPosition=this.endRow=this.startRow=null;this.calculate()},d=e;$traceurRuntime.createClass(e,{calculate:function(){for(var e=0,m=!0,c=[],b=a.get(this),p=b.onlyFullyVisible,l=b.overrideFn,g=b.rowHeightFn,t=b.scrollOffset,v=b.totalRows,b=b.viewportHeight,f=0;f<v;f++){var n=g(f);void 0===n&&(n=d.DEFAULT_HEIGHT);e<=t&&!p&&(this.startRow=
f);e>=t&&e+n<=t+b&&(null===this.startRow&&(this.startRow=f),this.endRow=f);c.push(e);e+=n;p||(this.endRow=f);if(e>=t+b){m=!1;break}}if(this.endRow===v-1&&m)for(this.startRow=this.endRow;0<this.startRow&&!(e=c[this.endRow]+n-c[this.startRow-1],(e<=b||!p)&&this.startRow--,e>=b););null!==this.startRow&&l&&l(this);this.startPosition=c[this.startRow];void 0==this.startPosition&&(this.startPosition=null);null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}},{get DEFAULT_HEIGHT(){return 23}});
window.WalkontableViewportRowsCalculator=e},{}],5:[function(h,q,r){Object.defineProperties(r,{WalkontableCellCoords:{get:function(){return a}},__esModule:{value:!0}});var a=function(a,d){"undefined"!==typeof a&&"undefined"!==typeof d?(this.row=a,this.col=d):this.col=this.row=null};$traceurRuntime.createClass(a,{isValid:function(a){return 0>this.row||0>this.col||this.row>=a.getSetting("totalRows")||this.col>=a.getSetting("totalColumns")?!1:!0},isEqual:function(a){return a===this?!0:this.row===a.row&&
this.col===a.col},isSouthEastOf:function(a){return this.row>=a.row&&this.col>=a.col},isNorthWestOf:function(a){return this.row<=a.row&&this.col<=a.col},isSouthWestOf:function(a){return this.row>=a.row&&this.col<=a.col},isNorthEastOf:function(a){return this.row<=a.row&&this.col>=a.col}},{});window.WalkontableCellCoords=a},{}],6:[function(h,q,r){Object.defineProperties(r,{WalkontableCellRange:{get:function(){return d}},__esModule:{value:!0}});var a,e=(a=h("./../cell/coords.js"),a&&a.__esModule&&a||
{default:a}).WalkontableCellCoords,d=function(a,c,b){this.highlight=a;this.from=c;this.to=b},k=d;$traceurRuntime.createClass(d,{isValid:function(a){return this.from.isValid(a)&&this.to.isValid(a)},isSingle:function(){return this.from.row===this.to.row&&this.from.col===this.to.col},getHeight:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1},getWidth:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1},includes:function(a){var c=
this.getTopLeftCorner(),b=this.getBottomRightCorner();0>a.row&&(a.row=0);0>a.col&&(a.col=0);return c.row<=a.row&&b.row>=a.row&&c.col<=a.col&&b.col>=a.col},includesRange:function(a){return this.includes(a.getTopLeftCorner())&&this.includes(a.getBottomRightCorner())},isEqual:function(a){return Math.min(this.from.row,this.to.row)==Math.min(a.from.row,a.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(a.from.row,a.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(a.from.col,a.to.col)&&Math.max(this.from.col,
this.to.col)==Math.max(a.from.col,a.to.col)},overlaps:function(a){return a.isSouthEastOf(this.getTopLeftCorner())&&a.isNorthWestOf(this.getBottomRightCorner())},isSouthEastOf:function(a){return this.getTopLeftCorner().isSouthEastOf(a)||this.getBottomRightCorner().isSouthEastOf(a)},isNorthWestOf:function(a){return this.getTopLeftCorner().isNorthWestOf(a)||this.getBottomRightCorner().isNorthWestOf(a)},expand:function(a){var c=this.getTopLeftCorner(),b=this.getBottomRightCorner();return a.row<c.row||
a.col<c.col||a.row>b.row||a.col>b.col?(this.from=new e(Math.min(c.row,a.row),Math.min(c.col,a.col)),this.to=new e(Math.max(b.row,a.row),Math.max(b.col,a.col)),!0):!1},expandByRange:function(a){if(this.includesRange(a)||!this.overlaps(a))return!1;var c=this.getTopLeftCorner(),b=this.getBottomRightCorner();this.getTopRightCorner();this.getBottomLeftCorner();var p=a.getTopLeftCorner(),l=a.getBottomRightCorner(),g=Math.min(c.row,p.row),c=Math.min(c.col,p.col),p=Math.max(b.row,l.row),b=Math.max(b.col,
l.col),l=new e(g,c),t=new e(p,b),v=(new k(l,l,t)).isCorner(this.from,a);a=a.isEqual(new k(l,l,t));v&&!a&&(this.from.col>l.col&&(l.col=b,t.col=c),this.from.row>l.row&&(l.row=p,t.row=g));this.from=l;this.to=t;return!0},getDirection:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"},setDirection:function(a){switch(a){case "NW-SE":this.from=this.getTopLeftCorner();
this.to=this.getBottomRightCorner();break;case "NE-SW":this.from=this.getTopRightCorner();this.to=this.getBottomLeftCorner();break;case "SE-NW":this.from=this.getBottomRightCorner();this.to=this.getTopLeftCorner();break;case "SW-NE":this.from=this.getBottomLeftCorner(),this.to=this.getTopRightCorner()}},getTopLeftCorner:function(){return new e(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},getBottomRightCorner:function(){return new e(Math.max(this.from.row,this.to.row),
Math.max(this.from.col,this.to.col))},getTopRightCorner:function(){return new e(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getBottomLeftCorner:function(){return new e(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},isCorner:function(a,c){return c&&c.includes(a)&&(this.getTopLeftCorner().isEqual(new e(c.from.row,c.from.col))||this.getTopRightCorner().isEqual(new e(c.from.row,c.to.col))||this.getBottomLeftCorner().isEqual(new e(c.to.row,c.from.col))||
this.getBottomRightCorner().isEqual(new e(c.to.row,c.to.col)))?!0:a.isEqual(this.getTopLeftCorner())||a.isEqual(this.getTopRightCorner())||a.isEqual(this.getBottomLeftCorner())||a.isEqual(this.getBottomRightCorner())},getOppositeCorner:function(a,c){if(!(a instanceof e))return!1;if(c&&c.includes(a)){if(this.getTopLeftCorner().isEqual(new e(c.from.row,c.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new e(c.from.row,c.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new e(c.to.row,
c.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new e(c.to.row,c.to.col)))return this.getTopLeftCorner()}if(a.isEqual(this.getBottomRightCorner()))return this.getTopLeftCorner();if(a.isEqual(this.getTopLeftCorner()))return this.getBottomRightCorner();if(a.isEqual(this.getTopRightCorner()))return this.getBottomLeftCorner();if(a.isEqual(this.getBottomLeftCorner()))return this.getTopRightCorner()},getBordersSharedWith:function(a){if(!this.includesRange(a))return[];
var c=Math.min(this.from.row,this.to.row),b=Math.max(this.from.row,this.to.row),p=Math.min(this.from.col,this.to.col),l=Math.max(this.from.col,this.to.col),g=Math.min(a.from.row,a.to.row),t=Math.max(a.from.row,a.to.row),v=Math.min(a.from.col,a.to.col);a=Math.max(a.from.col,a.to.col);var f=[];c==g&&f.push("top");l==a&&f.push("right");b==t&&f.push("bottom");p==v&&f.push("left");return f},getInner:function(){for(var a=this.getTopLeftCorner(),c=this.getBottomRightCorner(),b=[],p=a.row;p<=c.row;p++)for(var l=
a.col;l<=c.col;l++)this.from.row===p&&this.from.col===l||this.to.row===p&&this.to.col===l||b.push(new e(p,l));return b},getAll:function(){for(var a=this.getTopLeftCorner(),c=this.getBottomRightCorner(),b=[],p=a.row;p<=c.row;p++)for(var l=a.col;l<=c.col;l++)a.row===p&&a.col===l?b.push(a):c.row===p&&c.col===l?b.push(c):b.push(new e(p,l));return b},forAll:function(a){for(var c=this.getTopLeftCorner(),b=this.getBottomRightCorner(),p=c.row;p<=b.row;p++)for(var l=c.col;l<=b.col;l++)if(!1===a(p,l))return}},
{});window.WalkontableCellRange=d},{"./../cell/coords.js":5}],7:[function(h,q,r){Object.defineProperties(r,{Walkontable:{get:function(){return N}},__esModule:{value:!0}});var a,e,d,k,m,c,b,p,l=(a=h("./../../../dom.js"),a&&a.__esModule&&a||{default:a}),g=(e=h("./../../../helpers.js"),e&&e.__esModule&&e||{default:e}).randomString,t=(d=h("./event.js"),d&&d.__esModule&&d||{default:d}).WalkontableEvent,v=(k=h("./overlays.js"),k&&k.__esModule&&k||{default:k}).WalkontableOverlays,f=(m=h("./scroll.js"),m&&
m.__esModule&&m||{default:m}).WalkontableScroll,n=(c=h("./settings.js"),c&&c.__esModule&&c||{default:c}).WalkontableSettings,w=(b=h("./table.js"),b&&b.__esModule&&b||{default:b}).WalkontableTable,I=(p=h("./viewport.js"),p&&p.__esModule&&p||{default:p}).WalkontableViewport,N=function(b){var a=[];this.guid="wt_"+g();b.cloneSource?(this.cloneSource=b.cloneSource,this.cloneOverlay=b.cloneOverlay,this.wtSettings=b.cloneSource.wtSettings,this.wtTable=new w(this,b.table,b.wtRootElement),this.wtScroll=new f(this),
this.wtViewport=b.cloneSource.wtViewport,this.wtEvent=new t(this),this.selections=this.cloneSource.selections):(this.wtSettings=new n(this,b),this.wtTable=new w(this,b.table),this.wtScroll=new f(this),this.wtViewport=new I(this),this.wtEvent=new t(this),this.selections=this.getSetting("selections"),this.wtOverlays=new v(this));if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){b=0;for(var c=this.wtTable.THEAD.childNodes[0].childNodes.length;b<c;b++)a.push(this.wtTable.THEAD.childNodes[0].childNodes[b].innerHTML);
this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(b,g){l.fastInnerText(g,a[b])}])}this.drawInterrupted=this.drawn=!1};$traceurRuntime.createClass(N,{draw:function(b){b=void 0!==b?b:!1;this.drawInterrupted=!1;b||l.isVisible(this.wtTable.TABLE)?this.wtTable.draw(b):this.drawInterrupted=!0;return this},getCell:function(b,g){if(void 0===g||!g)return this.wtTable.getCell(b);var f=this.wtSettings.getSetting("fixedRowsTop"),n=this.wtSettings.getSetting("fixedColumnsLeft");return b.row<
f&&b.col<n?this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(b):b.row<f?this.wtOverlays.topOverlay.clone.wtTable.getCell(b):b.col<n?this.wtOverlays.leftOverlay.clone.wtTable.getCell(b):this.wtTable.getCell(b)},update:function(b,g){return this.wtSettings.update(b,g)},scrollVertical:function(b){this.wtOverlays.topOverlay.scrollTo(b);this.getSetting("onScrollVertically");return this},scrollHorizontal:function(b){this.wtOverlays.leftOverlay.scrollTo(b);this.getSetting("onScrollHorizontally");
return this},scrollViewport:function(b){this.wtScroll.scrollViewport(b);return this},getViewport:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},getOverlayName:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"},getSetting:function(b,g,f,n,a){return this.wtSettings.getSetting(b,g,f,n,a)},hasSetting:function(b){return this.wtSettings.has(b)},destroy:function(){this.wtOverlays.destroy();
this.wtEvent&&this.wtEvent.destroy()}},{});window.Walkontable=N},{"./../../../dom.js":27,"./../../../helpers.js":42,"./event.js":8,"./overlays.js":16,"./scroll.js":17,"./settings.js":19,"./table.js":20,"./viewport.js":22}],8:[function(h,q,r){function a(a){var b=this,p=m(a);this.instance=a;var l=[null,null];this.dblClickTimeout=[null,null];var g=function(g){var f=b.parentCell(g.realTarget);k.hasClass(g.realTarget,"corner")?b.instance.getSetting("onCellCornerMouseDown",g,g.realTarget):f.TD&&b.instance.hasSetting("onCellMouseDown")&&
b.instance.getSetting("onCellMouseDown",g,f.coords,f.TD,b.instance);2!==g.button&&f.TD&&(l[0]=f.TD,clearTimeout(b.dblClickTimeout[0]),b.dblClickTimeout[0]=setTimeout(function(){l[0]=null},1E3))},t=function(g){b.instance.touchMoving=!0},v=function(f){p.addEventListener(this,"touchmove",t);b.checkIfTouchMove=setTimeout(function(){!0===b.instance.touchMoving?(b.instance.touchMoving=void 0,p.removeEventListener("touchmove",t,!1)):g(f)},30)},f,n=function(g){if(2!==g.button){var f=b.parentCell(g.realTarget);
f.TD===l[0]&&f.TD===l[1]?(k.hasClass(g.realTarget,"corner")?b.instance.getSetting("onCellCornerDblClick",g,f.coords,f.TD,b.instance):b.instance.getSetting("onCellDblClick",g,f.coords,f.TD,b.instance),l[0]=null,l[1]=null):f.TD===l[0]&&(l[1]=f.TD,clearTimeout(b.dblClickTimeout[1]),b.dblClickTimeout[1]=setTimeout(function(){l[1]=null},500))}},w=function(b){clearTimeout(void 0);b.preventDefault();n(b)};p.addEventListener(this.instance.wtTable.holder,"mousedown",g);p.addEventListener(this.instance.wtTable.TABLE,
"mouseover",function(g){var n,a;b.instance.hasSetting("onCellMouseOver")&&(n=b.instance.wtTable.TABLE,(a=k.closest(g.realTarget,["TD","TH"],n))&&a!==f&&k.isChildOf(a,n)&&(f=a,b.instance.getSetting("onCellMouseOver",g,b.instance.wtTable.getCoords(a),a,b.instance)))});p.addEventListener(this.instance.wtTable.holder,"mouseup",n);if(this.instance.wtTable.holder.parentNode.parentNode&&Handsontable.mobileBrowser&&!b.instance.wtTable.isWorkingOnClone()){var e="."+this.instance.wtTable.holder.parentNode.className.split(" ").join(".");
p.addEventListener(this.instance.wtTable.holder,"touchstart",function(g){b.instance.touchApplied=!0;k.isChildOf(g.target,e)&&v.call(g.target,g)});p.addEventListener(this.instance.wtTable.holder,"touchend",function(g){b.instance.touchApplied=!1;k.isChildOf(g.target,e)&&w.call(g.target,g)});b.instance.momentumScrolling||(b.instance.momentumScrolling={});p.addEventListener(this.instance.wtTable.holder,"scroll",function(g){clearTimeout(b.instance.momentumScrolling._timeout);b.instance.momentumScrolling.ongoing||
b.instance.getSetting("onBeforeTouchScroll");b.instance.momentumScrolling.ongoing=!0;b.instance.momentumScrolling._timeout=setTimeout(function(){b.instance.touchApplied||(b.instance.momentumScrolling.ongoing=!1,b.instance.getSetting("onAfterMomentumScroll"))},200)})}p.addEventListener(window,"resize",function(){"none"!==b.instance.getSetting("stretchH")&&b.instance.draw()});this.destroy=function(){clearTimeout(this.dblClickTimeout[0]);clearTimeout(this.dblClickTimeout[1]);p.clear()}}Object.defineProperties(r,
{WalkontableEvent:{get:function(){return a}},__esModule:{value:!0}});var e,d,k=(e=h("./../../../dom.js"),e&&e.__esModule&&e||{default:e}),m=(d=h("./../../../eventManager.js"),d&&d.__esModule&&d||{default:d}).eventManager;a.prototype.parentCell=function(a){var b={},p=this.instance.wtTable.TABLE,l=k.closest(a,["TD","TH"],p);l&&k.isChildOf(l,p)?(b.coords=this.instance.wtTable.getCoords(l),b.TD=l):k.hasClass(a,"wtBorder")&&k.hasClass(a,"current")?(b.coords=this.instance.selections.current.cellRange.highlight,
b.TD=this.instance.wtTable.getCell(b.coords)):k.hasClass(a,"wtBorder")&&k.hasClass(a,"area")&&this.instance.selections.area.cellRange&&(b.coords=this.instance.selections.area.cellRange.to,b.TD=this.instance.wtTable.getCell(b.coords));return b};window.WalkontableEvent=a},{"./../../../dom.js":27,"./../../../eventManager.js":41}],9:[function(h,q,r){Object.defineProperties(r,{WalkontableColumnFilter:{get:function(){return a}},__esModule:{value:!0}});var a=function(a,d,k){this.offset=a;this.total=d;this.countTH=
k};$traceurRuntime.createClass(a,{offsetted:function(a){return a+this.offset},unOffsetted:function(a){return a-this.offset},renderedToSource:function(a){return this.offsetted(a)},sourceToRendered:function(a){return this.unOffsetted(a)},offsettedTH:function(a){return a-this.countTH},unOffsettedTH:function(a){return a+this.countTH},visibleRowHeadedColumnToSourceColumn:function(a){return this.renderedToSource(this.offsettedTH(a))},sourceColumnToVisibleRowHeadedColumn:function(a){return this.unOffsettedTH(this.sourceToRendered(a))}},
{});window.WalkontableColumnFilter=a},{}],10:[function(h,q,r){Object.defineProperties(r,{WalkontableRowFilter:{get:function(){return a}},__esModule:{value:!0}});var a=function(a,d,k){this.offset=a;this.total=d;this.countTH=k};$traceurRuntime.createClass(a,{offsetted:function(a){return a+this.offset},unOffsetted:function(a){return a-this.offset},renderedToSource:function(a){return this.offsetted(a)},sourceToRendered:function(a){return this.unOffsetted(a)},offsettedTH:function(a){return a-this.countTH},
unOffsettedTH:function(a){return a+this.countTH},visibleColHeadedRowToSourceRow:function(a){return this.renderedToSource(this.offsettedTH(a))},sourceRowToVisibleColHeadedRow:function(a){return this.unOffsettedTH(this.sourceToRendered(a))}},{});window.WalkontableRowFilter=a},{}],11:[function(h,q,r){Object.defineProperties(r,{WalkontableOverlay:{get:function(){return b}},__esModule:{value:!0}});var a,e,d,k=(a=h("./../../../../dom.js"),a&&a.__esModule&&a||{default:a}),m=(e=h("./../../../../helpers.js"),
e&&e.__esModule&&e||{default:e}).defineGetter,c=(d=h("./../../../../eventManager.js"),d&&d.__esModule&&d||{default:d}).eventManager,b=function(b){m(this,"wot",b,{writable:!1});this.instance=this.wot;this.type="";this.TABLE=this.wot.wtTable.TABLE;this.hider=this.wot.wtTable.hider;this.spreader=this.wot.wtTable.spreader;this.holder=this.wot.wtTable.holder;this.wtRootElement=this.wot.wtTable.wtRootElement;this.trimmingContainer=k.getTrimmingContainer(this.hider.parentNode.parentNode);this.mainTableScrollableElement=
k.getScrollableElement(this.wot.wtTable.TABLE);this.needFullRender=this.shouldBeRendered();this.isElementSizesAdjusted=!1},p=b;$traceurRuntime.createClass(b,{shouldBeRendered:function(){return!0},makeClone:function(b){if(-1===p.CLONE_TYPES.indexOf(b))throw Error('Clone type "'+b+'" is not supported.');var g=document.createElement("DIV"),a=document.createElement("TABLE");g.className="ht_clone_"+b+" handsontable";g.style.position="absolute";g.style.top=0;g.style.left=0;g.style.overflow="hidden";a.className=
this.wot.wtTable.TABLE.className;g.appendChild(a);this.type=b;this.wot.wtTable.wtRootElement.parentNode.appendChild(g);return new Walkontable({cloneSource:this.wot,cloneOverlay:this,table:a})},refresh:function(b){b=void 0!==b?b:!1;var g=this.shouldBeRendered();this.clone&&(this.needFullRender||g)&&this.clone.draw(b);this.needFullRender=g},destroy:function(){c(this.clone).clear()}},{get CLONE_TOP(){return"top"},get CLONE_LEFT(){return"left"},get CLONE_CORNER(){return"corner"},get CLONE_DEBUG(){return"debug"},
get CLONE_TYPES(){return[p.CLONE_TOP,p.CLONE_LEFT,p.CLONE_CORNER,p.CLONE_DEBUG]}});window.WalkontableOverlay=b},{"./../../../../dom.js":27,"./../../../../eventManager.js":41,"./../../../../helpers.js":42}],12:[function(h,q,r){Object.defineProperties(r,{WalkontableCornerOverlay:{get:function(){return m}},__esModule:{value:!0}});var a,e,d=(a=h("./../../../../dom.js"),a&&a.__esModule&&a||{default:a}),k=(e=h("./_base.js"),e&&e.__esModule&&e||{default:e}).WalkontableOverlay,m=function(b){$traceurRuntime.superConstructor(c).call(this,
b);this.clone=this.makeClone(k.CLONE_CORNER)},c=m;$traceurRuntime.createClass(m,{shouldBeRendered:function(){return(this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length)&&(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length)?!0:!1},resetFixedPosition:function(){if(this.wot.wtTable.holder.parentNode){var b=this.clone.wtTable.holder.parentNode,a=d.outerHeight(this.clone.wtTable.TABLE),c=d.outerWidth(this.clone.wtTable.TABLE);if(this.trimmingContainer===
window){var g=this.wot.wtTable.hider.getBoundingClientRect(),t=Math.ceil(g.top),v=Math.ceil(g.left),f=Math.ceil(g.bottom),g=Math.ceil(g.right);d.setOverlayPosition(b,0>v&&0<g-b.offsetWidth?-v+"px":"0",0>t&&0<f-b.offsetHeight?-t+"px":"0")}b.style.height=(0===a?a:a+4)+"px";b.style.width=(0===c?c:c+4)+"px"}}},{},k);window.WalkontableCornerOverlay=m},{"./../../../../dom.js":27,"./_base.js":11}],13:[function(h,q,r){Object.defineProperties(r,{WalkontableDebugOverlay:{get:function(){return m}},__esModule:{value:!0}});
var a,e,d=(a=h("./../../../../dom.js"),a&&a.__esModule&&a||{default:a}),k=(e=h("./_base.js"),e&&e.__esModule&&e||{default:e}).WalkontableOverlay,m=function(b){$traceurRuntime.superConstructor(c).call(this,b);this.clone=this.makeClone(k.CLONE_DEBUG);this.clone.wtTable.holder.style.opacity=.4;this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000";d.addClass(this.clone.wtTable.holder.parentNode,"wtDebugVisible")},c=m;$traceurRuntime.createClass(m,{},{},k);window.WalkontableDebugOverlay=m},{"./../../../../dom.js":27,
"./_base.js":11}],14:[function(h,q,r){Object.defineProperties(r,{WalkontableLeftOverlay:{get:function(){return m}},__esModule:{value:!0}});var a,e,d=(a=h("./../../../../dom.js"),a&&a.__esModule&&a||{default:a}),k=(e=h("./_base.js"),e&&e.__esModule&&e||{default:e}).WalkontableOverlay,m=function(b){$traceurRuntime.superConstructor(c).call(this,b);this.clone=this.makeClone(k.CLONE_LEFT)},c=m;$traceurRuntime.createClass(m,{shouldBeRendered:function(){return this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length?
!0:!1},resetFixedPosition:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var b=this.clone.wtTable.holder.parentNode,a=0;if(this.trimmingContainer===window){var c=this.wot.wtTable.hider.getBoundingClientRect(),a=Math.ceil(c.left),g=Math.ceil(c.right),c=this.wot.wtTable.hider.style.top,a=g=0>a&&0<g-b.offsetWidth?-a:0;d.setOverlayPosition(b,g+"px",""===c?0:c)}else a=this.getScrollPosition();this.adjustHeaderBordersPosition(a)}},setScrollPosition:function(b){this.mainTableScrollableElement===
window?window.scrollTo(b,d.getWindowScrollTop()):this.mainTableScrollableElement.scrollLeft=b},onScroll:function(){this.wot.getSetting("onScrollHorizontally")},sumCellSizes:function(b,a){for(var c=0,g=this.wot.wtSettings.defaultColumnWidth;b<a;)c+=this.wot.wtTable.getStretchedColumnWidth(b)||g,b++;return c},adjustElementsSize:function(){this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildsSize(),this.isElementSizesAdjusted=!0)},adjustRootElementSize:function(){var b=this.wot.wtTable.holder,
a=b.clientHeight!==b.offsetHeight?d.getScrollbarWidth():0,b=this.clone.wtTable.holder.parentNode.style;this.trimmingContainer!==window&&(b.height=this.wot.wtViewport.getWorkspaceHeight()-a+"px");this.clone.wtTable.holder.style.height=b.height;a=d.outerWidth(this.clone.wtTable.TABLE);b.width=(0===a?a:a+4)+"px"},adjustRootChildsSize:function(){var b=d.getScrollbarWidth();this.clone.wtTable.hider.style.height=this.hider.style.height;this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height;
0===b&&(b=30);this.clone.wtTable.holder.style.width=parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+b+"px"},applyToDOM:function(){var b=this.wot.getSetting("totalColumns");this.isElementSizesAdjusted||this.adjustElementsSize();if("number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px";else if(0===b)this.spreader.style.left="0";else throw Error("Incorrect value of the columnsRenderCalculator");
this.spreader.style.right="";this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){this.clone.wtTable.spreader.style.top="number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":""},scrollTo:function(b,a){var c=this.getTableParentOffset(),g=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,t=0;a&&g.offsetWidth!==g.clientWidth&&(t=d.getScrollbarWidth());a?(c+=this.sumCellSizes(0,b+1),
c-=this.wot.wtViewport.getViewportWidth()):c+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),b);this.setScrollPosition(c+t)},getTableParentOffset:function(){return this.trimmingContainer===window?this.wot.wtTable.holderOffset.left:0},getScrollPosition:function(){return d.getScrollLeft(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(b){if(0===this.wot.getSetting("fixedColumnsLeft")&&0<this.wot.getSetting("rowHeaders").length){var a=this.wot.wtTable.holder.parentNode,
c=d.hasClass(a,"innerBorderLeft");b?d.addClass(a,"innerBorderLeft"):d.removeClass(a,"innerBorderLeft");(!c&&b||c&&!b)&&this.wot.wtOverlays.adjustElementsSize()}}},{},k);window.WalkontableLeftOverlay=m},{"./../../../../dom.js":27,"./_base.js":11}],15:[function(h,q,r){Object.defineProperties(r,{WalkontableTopOverlay:{get:function(){return m}},__esModule:{value:!0}});var a,e,d=(a=h("./../../../../dom.js"),a&&a.__esModule&&a||{default:a}),k=(e=h("./_base.js"),e&&e.__esModule&&e||{default:e}).WalkontableOverlay,
m=function(b){$traceurRuntime.superConstructor(c).call(this,b);this.clone=this.makeClone(k.CLONE_TOP)},c=m;$traceurRuntime.createClass(m,{shouldBeRendered:function(){return this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length?!0:!1},resetFixedPosition:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var b=this.clone.wtTable.holder.parentNode,a=0;if(this.wot.wtOverlays.leftOverlay.trimmingContainer===window){var c=this.wot.wtTable.hider.getBoundingClientRect(),
a=Math.ceil(c.top),g=Math.ceil(c.bottom),c=this.wot.wtTable.hider.style.left,a=g=0>a&&0<g-b.offsetHeight?-a:0;d.setOverlayPosition(b,""===c?0:c,g+"px")}else a=this.getScrollPosition();this.adjustHeaderBordersPosition(a)}},setScrollPosition:function(b){this.mainTableScrollableElement===window?window.scrollTo(d.getWindowScrollLeft(),b):this.mainTableScrollableElement.scrollTop=b},onScroll:function(){this.wot.getSetting("onScrollVertically")},sumCellSizes:function(b,a){for(var c=0,g=this.wot.wtSettings.settings.defaultRowHeight;b<
a;)c+=this.wot.wtTable.getRowHeight(b)||g,b++;return c},adjustElementsSize:function(){this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildsSize(),this.isElementSizesAdjusted=!0)},adjustRootElementSize:function(){var b=this.wot.wtTable.holder,a=b.clientWidth!==b.offsetWidth?d.getScrollbarWidth():0,b=this.clone.wtTable.holder.parentNode.style;this.trimmingContainer!==window&&(b.width=this.wot.wtViewport.getWorkspaceWidth()-a+"px");this.clone.wtTable.holder.style.width=b.width;a=d.outerHeight(this.clone.wtTable.TABLE);
b.height=(0===a?a:a+4)+"px"},adjustRootChildsSize:function(){var b=d.getScrollbarWidth();this.clone.wtTable.hider.style.width=this.hider.style.width;this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width;0===b&&(b=30);this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+b+"px"},applyToDOM:function(){var b=this.wot.getSetting("totalRows");this.isElementSizesAdjusted||this.adjustElementsSize();if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=
this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else if(0===b)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="";this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){this.clone.wtTable.spreader.style.left="number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":""},scrollTo:function(b,a){var c=this.getTableParentOffset(),
g=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,t=0;a&&g.offsetHeight!==g.clientHeight&&(t=d.getScrollbarWidth());a?(c+=this.sumCellSizes(0,b+1),c-=this.wot.wtViewport.getViewportHeight(),c+=1):c+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),b);this.setScrollPosition(c+t)},getTableParentOffset:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0},getScrollPosition:function(){return d.getScrollTop(this.mainTableScrollableElement)},
adjustHeaderBordersPosition:function(b){if(0===this.wot.getSetting("fixedRowsTop")&&0<this.wot.getSetting("columnHeaders").length){var a=this.wot.wtTable.holder.parentNode,c=d.hasClass(a,"innerBorderTop");b?d.addClass(a,"innerBorderTop"):d.removeClass(a,"innerBorderTop");(!c&&b||c&&!b)&&this.wot.wtOverlays.adjustElementsSize()}0===this.wot.getSetting("rowHeaders").length&&(b=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)"))&&(b.style["border-left-width"]=0)}},{},k);window.WalkontableTopOverlay=
m},{"./../../../../dom.js":27,"./_base.js":11}],16:[function(h,q,r){Object.defineProperties(r,{WalkontableOverlays:{get:function(){return f}},__esModule:{value:!0}});var a,e,d,k,m,c,b=(a=h("./../../../dom.js"),a&&a.__esModule&&a||{default:a}),p=(e=h("./../../../eventManager.js"),e&&e.__esModule&&e||{default:e}).EventManager,l=(d=h("./overlay/corner.js"),d&&d.__esModule&&d||{default:d}).WalkontableCornerOverlay,g=(k=h("./overlay/debug.js"),k&&k.__esModule&&k||{default:k}).WalkontableDebugOverlay,t=
(m=h("./overlay/left.js"),m&&m.__esModule&&m||{default:m}).WalkontableLeftOverlay,v=(c=h("./overlay/top.js"),c&&c.__esModule&&c||{default:c}).WalkontableTopOverlay,f=function(a){this.instance=this.wot=a;this.eventManager=new p(this.wot);this.wot.update("scrollbarWidth",b.getScrollbarWidth());this.wot.update("scrollbarHeight",b.getScrollbarWidth());this.mainTableScrollableElement=b.getScrollableElement(this.wot.wtTable.TABLE);this.topOverlay=new v(this.wot);this.leftOverlay=new t(this.wot);this.topOverlay.needFullRender&&
this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay=new l(this.wot));this.wot.getSetting("debug")&&(this.debug=new g(this.wot));this.keyPressed=this.destroyed=!1;this.spreaderLastSize={width:null,height:null};this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},left:{top:0,left:null}};this.registerListeners()};$traceurRuntime.createClass(f,{refreshAll:function(){this.wot.drawn&&(this.wot.wtTable.holder.parentNode?(this.wot.draw(!0),this.topOverlay.onScroll(),this.leftOverlay.onScroll()):
this.destroy())},registerListeners:function(){var b=this;this.eventManager.addEventListener(document.documentElement,"keydown",function(){return b.onKeyDown()});this.eventManager.addEventListener(document.documentElement,"keyup",function(){return b.onKeyUp()});this.eventManager.addEventListener(this.mainTableScrollableElement,"scroll",function(a){return b.onTableScroll(a)});this.topOverlay.needFullRender&&(this.eventManager.addEventListener(this.topOverlay.clone.wtTable.holder,"scroll",function(a){return b.onTableScroll(a)}),
this.eventManager.addEventListener(this.topOverlay.clone.wtTable.holder,"wheel",function(a){return b.onTableScroll(a)}));this.leftOverlay.needFullRender&&(this.eventManager.addEventListener(this.leftOverlay.clone.wtTable.holder,"scroll",function(a){return b.onTableScroll(a)}),this.eventManager.addEventListener(this.leftOverlay.clone.wtTable.holder,"wheel",function(a){return b.onTableScroll(a)}));this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window&&this.eventManager.addEventListener(window,
"wheel",function(a){var g,f=a.wheelDeltaY||a.deltaY,c=a.wheelDeltaX||a.deltaX;b.topOverlay.clone.wtTable.holder.contains(a.target)?g="top":b.leftOverlay.clone.wtTable.holder.contains(a.target)&&(g="left");"top"==g&&0!==f?a.preventDefault():"left"==g&&0!==c&&a.preventDefault()})},onTableScroll:function(b){Handsontable.mobileBrowser||this.keyPressed&&this.mainTableScrollableElement!==window&&!b.target.contains(this.mainTableScrollableElement)||("scroll"===b.type?this.syncScrollPositions(b):this.translateMouseWheelToScroll(b))},
onKeyDown:function(){this.keyPressed=!0},onKeyUp:function(){this.keyPressed=!1},translateMouseWheelToScroll:function(b){var a=this.topOverlay.clone.wtTable.holder,g=this.leftOverlay.clone.wtTable.holder,f={type:"wheel"},c=b.target,t=b.wheelDeltaY||-1*b.deltaY;b=b.wheelDeltaX||-1*b.deltaX;for(var l;c!=document&&null!=c;){if(-1<c.className.indexOf("wtHolder")){l=c;break}c=c.parentNode}f.target=l;l==a?this.syncScrollPositions(f,-.2*t):l==g&&this.syncScrollPositions(f,-.2*b);return!1},syncScrollPositions:function(a){var g=
void 0!==arguments[1]?arguments[1]:null;if(!this.destroyed)if(0===arguments.length)this.syncScrollWithMaster();else{var f=this.mainTableScrollableElement,c=a.target,t=0,l=!1,v,p;this.topOverlay.needFullRender&&(v=this.topOverlay.clone.wtTable.holder);this.leftOverlay.needFullRender&&(p=this.leftOverlay.clone.wtTable.holder);c===document&&(c=window);c===f?(t=b.getScrollLeft(c),this.overlayScrollPositions.master.left!==t&&(this.overlayScrollPositions.master.left=t,l=!0,v&&(v.scrollLeft=t)),t=b.getScrollTop(c),
this.overlayScrollPositions.master.top!==t&&(this.overlayScrollPositions.master.top=t,l=!0,p&&(p.scrollTop=t))):c===v?(t=b.getScrollLeft(c),this.overlayScrollPositions.top.left!==t&&(this.overlayScrollPositions.top.left=t,l=!0,f.scrollLeft=t),null!==g&&(l=!0,f.scrollTop+=g)):c===p&&(t=b.getScrollTop(c),this.overlayScrollPositions.left.top!==t&&(this.overlayScrollPositions.left.top=t,l=!0,f.scrollTop=t),null!==g&&(l=!0,f.scrollLeft+=g));!this.keyPressed&&l&&"scroll"===a.type&&this.refreshAll()}},syncScrollWithMaster:function(){var b=
this.topOverlay.mainTableScrollableElement;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=b.scrollLeft);this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=b.scrollTop)},destroy:function(){this.eventManager.clear();this.topOverlay.destroy();this.leftOverlay.destroy();this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy();this.debug&&this.debug.destroy();this.destroyed=!0},refresh:function(b){b=void 0!==b?b:!1;if(this.topOverlay.isElementSizesAdjusted&&
this.leftOverlay.isElementSizesAdjusted){var a=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,g=a.clientWidth,a=a.clientHeight;if(g!==this.spreaderLastSize.width||a!==this.spreaderLastSize.height)this.spreaderLastSize.width=g,this.spreaderLastSize.height=a,this.adjustElementsSize()}this.leftOverlay.refresh(b);this.topOverlay.refresh(b);this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(b);this.debug&&this.debug.refresh(b)},adjustElementsSize:function(){var b=this.wot.getSetting("totalColumns"),
a=this.wot.getSetting("totalRows"),g=this.wot.wtViewport.getRowHeaderWidth(),f=this.wot.wtViewport.getColumnHeaderHeight(),c=this.wot.wtTable.hider.style;c.width=g+this.leftOverlay.sumCellSizes(0,b)+"px";c.height=f+this.topOverlay.sumCellSizes(0,a)+1+"px";this.topOverlay.adjustElementsSize();this.leftOverlay.adjustElementsSize()},applyToDOM:function(){this.topOverlay.isElementSizesAdjusted&&this.leftOverlay.isElementSizesAdjusted||this.adjustElementsSize();this.topOverlay.applyToDOM();this.leftOverlay.applyToDOM()}},
{});window.WalkontableOverlays=f},{"./../../../dom.js":27,"./../../../eventManager.js":41,"./overlay/corner.js":12,"./overlay/debug.js":13,"./overlay/left.js":14,"./overlay/top.js":15}],17:[function(h,q,r){Object.defineProperties(r,{WalkontableScroll:{get:function(){return a}},__esModule:{value:!0}});var a=function(a){this.instance=this.wot=a};$traceurRuntime.createClass(a,{scrollViewport:function(a){if(this.wot.drawn){var d=this.wot.getSetting("totalRows"),k=this.wot.getSetting("totalColumns");if(0>
a.row||a.row>d-1)throw Error("row "+a.row+" does not exist");if(0>a.col||a.col>k-1)throw Error("column "+a.col+" does not exist");a.row>this.instance.wtTable.getLastVisibleRow()?this.wot.wtOverlays.topOverlay.scrollTo(a.row,!0):a.row>=this.instance.getSetting("fixedRowsTop")&&a.row<this.instance.wtTable.getFirstVisibleRow()&&this.wot.wtOverlays.topOverlay.scrollTo(a.row);a.col>this.instance.wtTable.getLastVisibleColumn()?this.wot.wtOverlays.leftOverlay.scrollTo(a.col,!0):a.col>=this.instance.getSetting("fixedColumnsLeft")&&
a.col<this.instance.wtTable.getFirstVisibleColumn()&&this.wot.wtOverlays.leftOverlay.scrollTo(a.col)}}},{});window.WalkontableScroll=a},{}],18:[function(h,q,r){Object.defineProperties(r,{WalkontableSelection:{get:function(){return l}},__esModule:{value:!0}});var a,e,d,k,m=(a=h("./../../../dom.js"),a&&a.__esModule&&a||{default:a}),c=(e=h("./border.js"),e&&e.__esModule&&e||{default:e}).WalkontableBorder,b=(d=h("./cell/coords.js"),d&&d.__esModule&&d||{default:d}).WalkontableCellCoords,p=(k=h("./cell/range.js"),
k&&k.__esModule&&k||{default:k}).WalkontableCellRange,l=function(b,a){this.settings=b;this.cellRange=a||null;this.instanceBorders={}};$traceurRuntime.createClass(l,{getBorder:function(b){if(this.instanceBorders[b.guid])return this.instanceBorders[b.guid];this.instanceBorders[b.guid]=new c(b,this.settings)},isEmpty:function(){return null===this.cellRange},add:function(b){this.isEmpty()?this.cellRange=new p(b,b,b):this.cellRange.expand(b)},replace:function(b,a){if(!this.isEmpty()){if(this.cellRange.from.isEqual(b))return this.cellRange.from=
a,!0;if(this.cellRange.to.isEqual(b))return this.cellRange.to=a,!0}return!1},clear:function(){this.cellRange=null},getCorners:function(){var b=this.cellRange.getTopLeftCorner(),a=this.cellRange.getBottomRightCorner();return[b.row,b.col,a.row,a.col]},addClassAtCoords:function(a,c,l,f){a=a.wtTable.getCell(new b(c,l));"object"===typeof a&&m.addClass(a,f)},draw:function(b){if(this.isEmpty()){if(this.settings.border){var a=this.getBorder(b);a&&a.disappear()}}else{var c=b.wtTable.getRenderedRowsCount(),
f=b.wtTable.getRenderedColumnsCount(),a=this.getCorners(),n,w;for(n=0;n<f;n++)w=b.wtTable.columnFilter.renderedToSource(n),w>=a[1]&&w<=a[3]&&(w=b.wtTable.getColumnHeader(w))&&this.settings.highlightColumnClassName&&m.addClass(w,this.settings.highlightColumnClassName);for(var l=0;l<c;l++){n=b.wtTable.rowFilter.renderedToSource(l);n>=a[0]&&n<=a[2]&&(w=b.wtTable.getRowHeader(n))&&this.settings.highlightRowClassName&&m.addClass(w,this.settings.highlightRowClassName);for(var p=0;p<f;p++)w=b.wtTable.columnFilter.renderedToSource(p),
n>=a[0]&&n<=a[2]&&w>=a[1]&&w<=a[3]?this.settings.className&&this.addClassAtCoords(b,n,w,this.settings.className):n>=a[0]&&n<=a[2]?this.settings.highlightRowClassName&&this.addClassAtCoords(b,n,w,this.settings.highlightRowClassName):w>=a[1]&&w<=a[3]&&this.settings.highlightColumnClassName&&this.addClassAtCoords(b,n,w,this.settings.highlightColumnClassName)}b.getSetting("onBeforeDrawBorders",a,this.settings.className);this.settings.border&&(b=this.getBorder(b))&&b.appear(a)}}},{});window.WalkontableSelection=
l},{"./../../../dom.js":27,"./border.js":2,"./cell/coords.js":5,"./cell/range.js":6}],19:[function(h,q,r){Object.defineProperties(r,{WalkontableSettings:{get:function(){return d}},__esModule:{value:!0}});var a,e=(a=h("./../../../dom.js"),a&&a.__esModule&&a||{default:a}),d=function(a,m){var c=this;this.instance=this.wot=a;this.defaults={table:void 0,debug:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,data:void 0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},
columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(b,a,g){b=c.getSetting("data",b,a);e.fastInnerText(g,void 0===b||null===b?"":b)},columnWidth:function(b){},rowHeight:function(b){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,
onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1};this.settings={};for(var b in this.defaults)if(this.defaults.hasOwnProperty(b))if(void 0!==m[b])this.settings[b]=m[b];else{if(void 0===this.defaults[b])throw Error('A required setting "'+b+'" was not provided');this.settings[b]=this.defaults[b]}};$traceurRuntime.createClass(d,{update:function(a,m){if(void 0===
m)for(var c in a)a.hasOwnProperty(c)&&(this.settings[c]=a[c]);else this.settings[a]=m;return this.wot},getSetting:function(a,m,c,b,p){return"function"===typeof this.settings[a]?this.settings[a](m,c,b,p):void 0!==m&&Array.isArray(this.settings[a])?this.settings[a][m]:this.settings[a]},has:function(a){return!!this.settings[a]}},{});window.WalkontableSettings=d},{"./../../../dom.js":27}],20:[function(h,q,r){function a(b,a){this.instance=b;this.TABLE=a;t.removeTextNodes(this.TABLE);var f=this.TABLE.parentNode;
if(!f||1!==f.nodeType||!t.hasClass(f,"wtHolder")){var g=document.createElement("DIV");g.className="wtSpreader";f&&f.insertBefore(g,this.TABLE);g.appendChild(this.TABLE)}this.spreader=this.TABLE.parentNode;this.spreader.style.position="relative";f=this.spreader.parentNode;f&&1===f.nodeType&&t.hasClass(f,"wtHolder")||(g=document.createElement("DIV"),g.className="wtHider",f&&f.insertBefore(g,this.spreader),g.appendChild(this.spreader));this.hider=this.spreader.parentNode;f=this.hider.parentNode;f&&1===
f.nodeType&&t.hasClass(f,"wtHolder")||(g=document.createElement("DIV"),g.style.position="relative",g.className="wtHolder",f&&f.insertBefore(g,this.hider),b.cloneSource||(g.parentNode.className+="ht_master handsontable"),g.appendChild(this.hider));this.holder=this.hider.parentNode;this.wtRootElement=this.holder.parentNode;this.alignOverlaysWithTrimmingContainer();this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0];this.TBODY||(this.TBODY=document.createElement("TBODY"),this.TABLE.appendChild(this.TBODY));
this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0];this.THEAD||(this.THEAD=document.createElement("THEAD"),this.TABLE.insertBefore(this.THEAD,this.TBODY));this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0];this.COLGROUP||(this.COLGROUP=document.createElement("COLGROUP"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD));this.instance.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&(f=document.createElement("TR"),this.THEAD.appendChild(f));this.colgroupChildrenLength=
this.COLGROUP.childNodes.length;this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0;this.tbodyChildrenLength=this.TBODY.childNodes.length;this.columnFilter=this.rowFilter=null}Object.defineProperties(r,{WalkontableTable:{get:function(){return a}},__esModule:{value:!0}});var e,d,k,m,c,b,p,l,g,t=(e=h("./../../../dom.js"),e&&e.__esModule&&e||{default:e}),v=(d=h("./cell/coords.js"),d&&d.__esModule&&d||{default:d}).WalkontableCellCoords;h("./cell/range.js");var f=(k=
h("./filter/column.js"),k&&k.__esModule&&k||{default:k}).WalkontableColumnFilter,n=(m=h("./overlay/corner.js"),m&&m.__esModule&&m||{default:m}).WalkontableCornerOverlay,w=(c=h("./overlay/debug.js"),c&&c.__esModule&&c||{default:c}).WalkontableDebugOverlay,I=(b=h("./overlay/left.js"),b&&b.__esModule&&b||{default:b}).WalkontableLeftOverlay,N=(p=h("./filter/row.js"),p&&p.__esModule&&p||{default:p}).WalkontableRowFilter,W=(l=h("./tableRenderer.js"),l&&l.__esModule&&l||{default:l}).WalkontableTableRenderer,
y=(g=h("./overlay/top.js"),g&&g.__esModule&&g||{default:g}).WalkontableTopOverlay;a.prototype.alignOverlaysWithTrimmingContainer=function(){var b=t.getTrimmingContainer(this.wtRootElement);this.isWorkingOnClone()||(this.holder.parentNode.style.position="relative",b!==window?(this.holder.style.width=t.getStyle(b,"width"),this.holder.style.height=t.getStyle(b,"height"),this.holder.style.overflow=""):(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible"))};a.prototype.isWorkingOnClone=
function(){return!!this.instance.cloneSource};a.prototype.draw=function(b){this.isWorkingOnClone()||(this.holderOffset=t.offset(this.holder),b=this.instance.wtViewport.createRenderCalculators(b));if(b)this.isWorkingOnClone()||this.instance.wtViewport.createVisibleCalculators(),this.instance.wtOverlays&&this.instance.wtOverlays.refresh(!0);else{this.isWorkingOnClone()?this.tableOffset=this.instance.cloneSource.wtTable.tableOffset:this.tableOffset=t.offset(this.TABLE);var a;a=this.instance.cloneOverlay instanceof
w||this.instance.cloneOverlay instanceof y||this.instance.cloneOverlay instanceof n?0:this.instance.wtViewport.rowsRenderCalculator.startRow;var g;g=this.instance.cloneOverlay instanceof w||this.instance.cloneOverlay instanceof I||this.instance.cloneOverlay instanceof n?0:this.instance.wtViewport.columnsRenderCalculator.startColumn;this.rowFilter=new N(a,this.instance.getSetting("totalRows"),this.instance.getSetting("columnHeaders").length);this.columnFilter=new f(g,this.instance.getSetting("totalColumns"),
this.instance.getSetting("rowHeaders").length);this._doDraw();this.alignOverlaysWithTrimmingContainer()}this.refreshSelections(b);this.isWorkingOnClone()||(this.instance.wtOverlays.topOverlay.resetFixedPosition(),this.instance.wtOverlays.leftOverlay.resetFixedPosition(),this.instance.wtOverlays.topLeftCornerOverlay&&this.instance.wtOverlays.topLeftCornerOverlay.resetFixedPosition());this.instance.drawn=!0;return this};a.prototype._doDraw=function(){(new W(this)).render()};a.prototype.removeClassFromCells=
function(b){for(var a=this.TABLE.querySelectorAll("."+b),f=0,g=a.length;f<g;f++)t.removeClass(a[f],b)};a.prototype.refreshSelections=function(b){var a,f;if(this.instance.selections){f=this.instance.selections.length;if(b)for(a=0;a<f;a++)this.instance.selections[a].settings.className&&this.removeClassFromCells(this.instance.selections[a].settings.className),this.instance.selections[a].settings.highlightRowClassName&&this.removeClassFromCells(this.instance.selections[a].settings.highlightRowClassName),
this.instance.selections[a].settings.highlightColumnClassName&&this.removeClassFromCells(this.instance.selections[a].settings.highlightColumnClassName);for(a=0;a<f;a++)this.instance.selections[a].draw(this.instance,b)}};a.prototype.getCell=function(b){if(this.isRowBeforeRenderedRows(b.row))return-1;if(this.isRowAfterRenderedRows(b.row))return-2;var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(b.row)];if(a)return a.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(b.col)]};
a.prototype.getColumnHeader=function(b,a){a||(a=0);var f=this.THEAD.childNodes[a];if(f)return f.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(b)]};a.prototype.getRowHeader=function(b){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;if(b=this.TBODY.childNodes[this.rowFilter.sourceToRendered(b)])return b.childNodes[0]};a.prototype.getCoords=function(b){var a=b.parentNode,f=t.index(a),f=a.parentNode===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(f):
this.rowFilter.renderedToSource(f);return new v(f,this.columnFilter.visibleRowHeadedColumnToSourceColumn(b.cellIndex))};a.prototype.getTrForRow=function(b){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(b)]};a.prototype.getFirstRenderedRow=function(){return this.instance.wtViewport.rowsRenderCalculator.startRow};a.prototype.getFirstVisibleRow=function(){return this.instance.wtViewport.rowsVisibleCalculator.startRow};a.prototype.getFirstRenderedColumn=function(){return this.instance.wtViewport.columnsRenderCalculator.startColumn};
a.prototype.getFirstVisibleColumn=function(){return this.instance.wtViewport.columnsVisibleCalculator.startColumn};a.prototype.getLastRenderedRow=function(){return this.instance.wtViewport.rowsRenderCalculator.endRow};a.prototype.getLastVisibleRow=function(){return this.instance.wtViewport.rowsVisibleCalculator.endRow};a.prototype.getLastRenderedColumn=function(){return this.instance.wtViewport.columnsRenderCalculator.endColumn};a.prototype.getLastVisibleColumn=function(){return this.instance.wtViewport.columnsVisibleCalculator.endColumn};
a.prototype.isRowBeforeRenderedRows=function(b){return 0>this.rowFilter.sourceToRendered(b)&&0<=b};a.prototype.isRowAfterViewport=function(b){return b>this.getLastVisibleRow()};a.prototype.isRowAfterRenderedRows=function(b){return b>this.getLastRenderedRow()};a.prototype.isColumnBeforeViewport=function(b){return 0>this.columnFilter.sourceToRendered(b)&&0<=b};a.prototype.isColumnAfterViewport=function(b){return b>this.getLastVisibleColumn()};a.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===
this.getLastRenderedRow()};a.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn};a.prototype.getRenderedColumnsCount=function(){return this.instance.cloneOverlay instanceof w?this.instance.getSetting("totalColumns"):this.instance.cloneOverlay instanceof I||this.instance.cloneOverlay instanceof n?this.instance.getSetting("fixedColumnsLeft"):this.instance.wtViewport.columnsRenderCalculator.count};a.prototype.getRenderedRowsCount=function(){return this.instance.cloneOverlay instanceof
w?this.instance.getSetting("totalRows"):this.instance.cloneOverlay instanceof y||this.instance.cloneOverlay instanceof n?this.instance.getSetting("fixedRowsTop"):this.instance.wtViewport.rowsRenderCalculator.count};a.prototype.getVisibleRowsCount=function(){return this.instance.wtViewport.rowsVisibleCalculator.count};a.prototype.allRowsInViewport=function(){return this.instance.getSetting("totalRows")==this.getVisibleRowsCount()};a.prototype.getRowHeight=function(b){var a=this.instance.wtSettings.settings.rowHeight(b);
b=this.instance.wtViewport.oversizedRows[b];void 0!==b&&(a=a?Math.max(a,b):b);return a};a.prototype.getColumnHeaderHeight=function(b){var a=this.instance.wtSettings.settings.defaultRowHeight;b=this.instance.wtViewport.oversizedColumnHeaders[b];void 0!==b&&(a=a?Math.max(a,b):b);return a};a.prototype.getVisibleColumnsCount=function(){return this.instance.wtViewport.columnsVisibleCalculator.count};a.prototype.allColumnsInViewport=function(){return this.instance.getSetting("totalColumns")==this.getVisibleColumnsCount()};
a.prototype.getColumnWidth=function(b){var a=this.instance.wtSettings.settings.columnWidth;"function"===typeof a?a=a(b):"object"===typeof a&&(a=a[b]);b=this.instance.wtViewport.oversizedCols[b];void 0!==b&&(a=a?Math.max(a,b):b);return a};a.prototype.getStretchedColumnWidth=function(b){var a=this.getColumnWidth(b)||this.instance.wtSettings.settings.defaultColumnWidth,f=this.instance.wtViewport.columnsRenderCalculator;f&&(b=f.getStretchedColumnWidth(b,a))&&(a=b);return a};window.WalkontableTable=a},
{"./../../../dom.js":27,"./cell/coords.js":5,"./cell/range.js":6,"./filter/column.js":9,"./filter/row.js":10,"./overlay/corner.js":12,"./overlay/debug.js":13,"./overlay/left.js":14,"./overlay/top.js":15,"./tableRenderer.js":21}],21:[function(h,q,r){Object.defineProperties(r,{WalkontableTableRenderer:{get:function(){return k}},__esModule:{value:!0}});var a,e=(a=h("./../../../dom.js"),a&&a.__esModule&&a||{default:a}),d={},k=function(a){this.wtTable=a;this.instance=this.wot=a.instance;this.rowFilter=
a.rowFilter;this.columnFilter=a.columnFilter;this.TABLE=a.TABLE;this.THEAD=a.THEAD;this.TBODY=a.TBODY;this.COLGROUP=a.COLGROUP;this.rowHeaders=[];this.rowHeaderCount=0;this.columnHeaders=[];this.fixedRowsTop=this.columnHeaderCount=0};$traceurRuntime.createClass(k,{render:function(){this.wtTable.isWorkingOnClone()||this.wot.getSetting("beforeDraw",!0);this.rowHeaders=this.wot.getSetting("rowHeaders");this.rowHeaderCount=this.rowHeaders.length;this.fixedRowsTop=this.wot.getSetting("fixedRowsTop");this.columnHeaders=
this.wot.getSetting("columnHeaders");this.columnHeaderCount=this.columnHeaders.length;var a=this.wtTable.getRenderedColumnsCount(),c=this.wtTable.getRenderedRowsCount(),b=this.wot.getSetting("totalColumns"),p=this.wot.getSetting("totalRows"),l,g=!1;0<b&&(this.adjustAvailableNodes(),g=!0,this.renderColGroups(),this.renderColumnHeaders(),this.renderRows(p,c,a),this.wtTable.isWorkingOnClone()?this.adjustColumnHeaderHeights():(l=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=
null),this.adjustColumnWidths(a));g||this.adjustAvailableNodes();this.removeRedundantRows(c);if(!this.wtTable.isWorkingOnClone()){this.markOversizedRows();this.wot.wtViewport.createVisibleCalculators();this.wot.wtOverlays.refresh(!1);this.wot.wtOverlays.applyToDOM();if(l!==this.wot.wtViewport.getWorkspaceWidth())for(this.wot.wtViewport.containerWidth=null,c=this.wtTable.getFirstRenderedColumn(),a=this.wtTable.getLastRenderedColumn();c<a;c++)b=this.wtTable.getStretchedColumnWidth(c),p=this.columnFilter.sourceToRendered(c),
this.COLGROUP.childNodes[p+this.rowHeaderCount].style.width=b+"px";this.wot.getSetting("onDraw",!0)}},removeRedundantRows:function(a){for(;this.wtTable.tbodyChildrenLength>a;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},renderRows:function(a,c,b){for(var p,l=0,g=this.rowFilter.renderedToSource(l),t=this.wtTable.isWorkingOnClone();g<a&&0<=g;){if(1E3<l)throw Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.");
if(void 0!==c&&l===c)break;p=this.getOrCreateTrForRow(l,p);this.renderRowHeaders(g,p);this.adjustColumns(p,b+this.rowHeaderCount);this.renderCells(g,p,b);t||this.resetOversizedRow(g);p.firstChild&&(g=this.wot.wtTable.getRowHeight(g),p.firstChild.style.height=g?g+"px":"");l++;g=this.rowFilter.renderedToSource(l)}},resetOversizedRow:function(a){this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[a]&&(this.wot.wtViewport.oversizedRows[a]=void 0)},markOversizedRows:function(){var a=this.instance.wtTable.TBODY.childNodes.length,
c=a*this.instance.wtSettings.settings.defaultRowHeight,b=e.innerHeight(this.instance.wtTable.TBODY)-1,p,l;if(c!==b)for(;a;)if(a--,b=this.instance.wtTable.rowFilter.renderedToSource(a),c=this.instance.wtTable.getRowHeight(b),p=this.instance.wtTable.getTrForRow(b),p=(l=p.querySelector("th"))?e.innerHeight(l):e.innerHeight(p)-1,!c&&this.instance.wtSettings.settings.defaultRowHeight<p||c<p)this.instance.wtViewport.oversizedRows[b]=p},adjustColumnHeaderHeights:function(){for(var a=this.wot.getSetting("columnHeaders"),
c=this.wot.wtTable.THEAD.childNodes,b=this.wot.wtViewport.oversizedColumnHeaders,p=0,a=a.length;p<a;p++)if(b[p]){if(0===c[p].childNodes.length)break;c[p].childNodes[0].style.height=b[p]+"px"}},markIfOversizedColumnHeader:function(a){var c=this.wot.getSetting("columnHeaders").length,b=this.wot.wtSettings.settings.defaultRowHeight,p,l;for(a=this.wot.wtTable.columnFilter.renderedToSource(a);c;)if(c--,p=this.wot.wtTable.getColumnHeaderHeight(c),l=this.wot.wtTable.getColumnHeader(a,c))if(l=e.innerHeight(l),
!p&&b<l||p<l)this.wot.wtViewport.oversizedColumnHeaders[c]=l},renderCells:function(a,c,b){for(var p,l,g=0;g<b;g++){l=this.columnFilter.renderedToSource(g);p=0===g?c.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(l)]:p.nextSibling;if("TH"==p.nodeName){var t=c,v=document.createElement("TD");t.insertBefore(v,p);t.removeChild(p);p=v}e.hasClass(p,"hide")||(p.className="");p.removeAttribute("style");this.wot.wtSettings.settings.cellRenderer(a,l,p)}return p},adjustColumnWidths:function(a){var c=
0,b=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;b.offsetHeight<b.scrollHeight&&(c=e.getScrollbarWidth());this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-c);for(c=0;c<a;c++)b=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(c)),this.COLGROUP.childNodes[c+this.rowHeaderCount].style.width=b+"px"},appendToTbody:function(a){this.TBODY.appendChild(a);this.wtTable.tbodyChildrenLength++},getOrCreateTrForRow:function(a,
c){var b;a>=this.wtTable.tbodyChildrenLength?(b=this.createRow(),this.appendToTbody(b)):b=0===a?this.TBODY.firstChild:c.nextSibling;return b},createRow:function(){for(var a=document.createElement("TR"),c=0;c<this.rowHeaderCount;c++)a.appendChild(document.createElement("TH"));return a},renderRowHeader:function(a,c,b){b.className="";b.removeAttribute("style");this.rowHeaders[c](a,b,c)},renderRowHeaders:function(a,c){for(var b=c.firstChild,p=0;p<this.rowHeaderCount;p++){if(!b)b=document.createElement("TH"),
c.appendChild(b);else if("TD"==b.nodeName){var l=c,g=document.createElement("TH");l.insertBefore(g,b);l.removeChild(b);b=g}this.renderRowHeader(a,p,b);b=b.nextSibling}},adjustAvailableNodes:function(){this.adjustColGroups();this.adjustThead()},renderColumnHeaders:function(){var a=this.wot.getOverlayName();if(this.columnHeaderCount){for(var c=this.wtTable.getRenderedColumnsCount(),b=0;b<this.columnHeaderCount;b++)for(var p=this.getTrForColumnHeaders(b),l=-1*this.rowHeaderCount;l<c;l++){var g=this.columnFilter.renderedToSource(l);
this.renderColumnHeader(b,g,p.childNodes[l+this.rowHeaderCount]);d[a]||this.wtTable.isWorkingOnClone()||this.markIfOversizedColumnHeader(l)}d[a]=!0}},adjustColGroups:function(){for(var a=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<a+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;for(;this.wtTable.colgroupChildrenLength>a+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--},
adjustThead:function(){var a=this.wtTable.getRenderedColumnsCount(),c=this.THEAD.firstChild;if(this.columnHeaders.length){for(var b=0,p=this.columnHeaders.length;b<p;b++){c=this.THEAD.childNodes[b];c||(c=document.createElement("TR"),this.THEAD.appendChild(c));for(this.theadChildrenLength=c.childNodes.length;this.theadChildrenLength<a+this.rowHeaderCount;)c.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>a+this.rowHeaderCount;)c.removeChild(c.lastChild),
this.theadChildrenLength--}a=this.THEAD.childNodes.length;if(a>this.columnHeaders.length)for(c=this.columnHeaders.length;c<a;c++)this.THEAD.removeChild(this.THEAD.lastChild)}else c&&e.empty(c)},getTrForColumnHeaders:function(a){return this.THEAD.childNodes[a]},renderColumnHeader:function(a,c,b){b.className="";b.removeAttribute("style");return this.columnHeaders[a](c,b,a)},renderColGroups:function(){for(var a=0;a<this.wtTable.colgroupChildrenLength;a++)a<this.rowHeaderCount?e.addClass(this.COLGROUP.childNodes[a],
"rowHeader"):e.removeClass(this.COLGROUP.childNodes[a],"rowHeader")},adjustColumns:function(a,c){for(var b=a.childNodes.length;b<c;){var p=document.createElement("TD");a.appendChild(p);b++}for(;b>c;)a.removeChild(a.lastChild),b--},removeRedundantColumns:function(a){for(;this.wtTable.tbodyChildrenLength>a;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}},{});window.WalkontableTableRenderer=k},{"./../../../dom.js":27}],22:[function(h,q,r){Object.defineProperties(r,{WalkontableViewport:{get:function(){return l}},
__esModule:{value:!0}});var a,e,d,k,m=(a=h("./../../../dom.js"),a&&a.__esModule&&a||{default:a}),c=(e=h("./../../../eventManager.js"),e&&e.__esModule&&e||{default:e}).eventManager,b=(d=h("./calculator/viewportColumns.js"),d&&d.__esModule&&d||{default:d}).WalkontableViewportColumnsCalculator,p=(k=h("./calculator/viewportRows.js"),k&&k.__esModule&&k||{default:k}).WalkontableViewportRowsCalculator,l=function(a){var b=this;this.instance=this.wot=a;this.oversizedRows=[];this.oversizedCols=[];this.oversizedColumnHeaders=
[];this.clientHeight=0;this.rowHeaderWidth=this.containerWidth=NaN;this.columnsVisibleCalculator=this.rowsVisibleCalculator=null;c(a).addEventListener(window,"resize",function(){b.clientHeight=b.getWorkspaceHeight()})};$traceurRuntime.createClass(l,{getWorkspaceHeight:function(){var a=this.instance.wtOverlays.topOverlay.trimmingContainer,b;b=0;a===window?b=document.documentElement.clientHeight:(b=m.outerHeight(a),b=0<b&&0<a.clientHeight?a.clientHeight:Infinity);return b},getWorkspaceWidth:function(){var a,
b=this.instance.getSetting("totalColumns"),c=this.instance.wtOverlays.leftOverlay.trimmingContainer,f=this.instance.getSetting("stretchH");a=document.documentElement.offsetWidth;a=Handsontable.freezeOverlays?Math.min(a-this.getWorkspaceOffset().left,a):Math.min(this.getContainerFillWidth(),a-this.getWorkspaceOffset().left,a);return c===window&&0<b&&this.sumColumnWidths(0,b-1)>a?document.documentElement.clientWidth:c!==window&&(b=m.getStyle(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow"),
"scroll"==b||"hidden"==b||"auto"==b)?Math.max(a,c.clientWidth):"none"!==f&&f?a:Math.max(a,m.outerWidth(this.instance.wtTable.TABLE))},hasVerticalScroll:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()},hasHorizontalScroll:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()},sumColumnWidths:function(a,b){for(var c=0,f=this.instance.wtSettings.defaultColumnWidth;a<b;)c+=this.wot.wtTable.getColumnWidth(a)||f,a++;return c},getContainerFillWidth:function(){if(this.containerWidth)return this.containerWidth;
var a=this.instance.wtTable.holder,b,c;c=document.createElement("DIV");c.style.width="100%";c.style.height="1px";a.appendChild(c);this.containerWidth=b=c.offsetWidth;a.removeChild(c);return b},getWorkspaceOffset:function(){return m.offset(this.wot.wtTable.TABLE)},getWorkspaceActualHeight:function(){return m.outerHeight(this.wot.wtTable.TABLE)},getWorkspaceActualWidth:function(){return m.outerWidth(this.wot.wtTable.TABLE)||m.outerWidth(this.wot.wtTable.TBODY)||m.outerWidth(this.wot.wtTable.THEAD)},
getColumnHeaderHeight:function(){isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=m.outerHeight(this.wot.wtTable.THEAD));return this.columnHeaderHeight},getViewportHeight:function(){var a=this.getWorkspaceHeight(),b;if(Infinity===a)return a;b=this.getColumnHeaderHeight();0<b&&(a-=b);return a},getRowHeaderWidth:function(){if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth)){var a=this.instance.getSetting("rowHeaders");if(a.length)for(var b=
this.instance.wtTable.TABLE.querySelector("TH"),c=this.rowHeaderWidth=0,a=a.length;c<a;c++)b?(this.rowHeaderWidth+=m.outerWidth(b),b=b.nextSibling):this.rowHeaderWidth+=50;else this.rowHeaderWidth=0}return this.rowHeaderWidth},getViewportWidth:function(){var a=this.getWorkspaceWidth(),b;if(Infinity===a)return a;b=this.getRowHeaderWidth();return 0<b?a-b:a},createRowsCalculator:function(a){a=void 0!==a?a:!1;var b=this,c,f,n;this.rowHeaderWidth=NaN;c=this.wot.wtSettings.settings.renderAllRows?Infinity:
this.getViewportHeight();f=m.getScrollTop(this.wot.wtOverlays.mainTableScrollableElement)-this.wot.wtOverlays.topOverlay.getTableParentOffset();0>f&&(f=0);if(n=this.wot.getSetting("fixedRowsTop"))n=this.wot.wtOverlays.topOverlay.sumCellSizes(0,n),f+=n,c-=n;return new p(c,f,this.wot.getSetting("totalRows"),function(a){return b.wot.wtTable.getRowHeight(a)},a?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,a)},createColumnsCalculator:function(a){a=void 0!==a?a:!1;var c=this,l=this.getViewportWidth(),
f,n;this.columnHeaderHeight=NaN;f=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset();0>f&&(f=0);if(n=this.wot.getSetting("fixedColumnsLeft"))n=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,n),f+=n,l-=n;this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth&&(l-=m.getScrollbarWidth());return new b(l,f,this.wot.getSetting("totalColumns"),function(a){return c.wot.wtTable.getColumnWidth(a)},a?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,
a,this.wot.getSetting("stretchH"))},createRenderCalculators:function(a){if(a=void 0!==a?a:!1){var b=this.createRowsCalculator(!0),c=this.createColumnsCalculator(!0);this.areAllProposedVisibleRowsAlreadyRendered(b)&&this.areAllProposedVisibleColumnsAlreadyRendered(c)||(a=!1)}a||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator());this.columnsVisibleCalculator=this.rowsVisibleCalculator=null;return a},createVisibleCalculators:function(){this.rowsVisibleCalculator=
this.createRowsCalculator(!0);this.columnsVisibleCalculator=this.createColumnsCalculator(!0)},areAllProposedVisibleRowsAlreadyRendered:function(a){return!this.rowsVisibleCalculator||a.startRow<this.rowsRenderCalculator.startRow||a.startRow===this.rowsRenderCalculator.startRow&&0<a.startRow||a.endRow>this.rowsRenderCalculator.endRow||a.endRow===this.rowsRenderCalculator.endRow&&a.endRow<this.wot.getSetting("totalRows")-1?!1:!0},areAllProposedVisibleColumnsAlreadyRendered:function(a){return!this.columnsVisibleCalculator||
a.startColumn<this.columnsRenderCalculator.startColumn||a.startColumn===this.columnsRenderCalculator.startColumn&&0<a.startColumn||a.endColumn>this.columnsRenderCalculator.endColumn||a.endColumn===this.columnsRenderCalculator.endColumn&&a.endColumn<this.wot.getSetting("totalColumns")-1?!1:!0}},{});window.WalkontableViewport=l},{"./../../../dom.js":27,"./../../../eventManager.js":41,"./calculator/viewportColumns.js":3,"./calculator/viewportRows.js":4}],23:[function(h,q,r){var a;q=Handsontable.version;
r=Handsontable.buildDate;window.Handsontable=function(a,d){var k=new Handsontable.Core(a,d||{});k.init();return k};Handsontable.version=q;Handsontable.buildDate=r;q=h("./shims/array.filter.js");q&&q.__esModule&&q||{default:q};q=h("./shims/array.indexOf.js");q&&q.__esModule&&q||{default:q};q=h("./shims/array.isArray.js");q&&q.__esModule&&q||{default:q};q=h("./shims/classes.js");q&&q.__esModule&&q||{default:q};q=h("./shims/object.keys.js");q&&q.__esModule&&q||{default:q};q=h("./shims/string.trim.js");
q&&q.__esModule&&q||{default:q};q=h("./shims/weakmap.js");q&&q.__esModule&&q||{default:q};Handsontable.plugins={};q=(a=h("./pluginHooks.js"),a&&a.__esModule&&a||{default:a}).Hooks;Handsontable.hooks||(Handsontable.hooks=new q);a=h("./core.js");a&&a.__esModule&&a||{default:a};a=h("./renderers/_cellDecorator.js");a&&a.__esModule&&a||{default:a};a=h("./cellTypes.js");a&&a.__esModule&&a||{default:a};h=h("./../plugins/jqueryHandsontable.js");h&&h.__esModule&&h||{default:h}},{"./../plugins/jqueryHandsontable.js":1,
"./cellTypes.js":24,"./core.js":25,"./pluginHooks.js":44,"./renderers/_cellDecorator.js":71,"./shims/array.filter.js":78,"./shims/array.indexOf.js":79,"./shims/array.isArray.js":80,"./shims/classes.js":81,"./shims/object.keys.js":82,"./shims/string.trim.js":83,"./shims/weakmap.js":84}],24:[function(h,q,r){var a,e,d;q=(a=h("./helpers.js"),a&&a.__esModule&&a||{default:a});a=(e=h("./editors.js"),e&&e.__esModule&&e||{default:e}).getEditorConstructor;e=(d=h("./renderers.js"),d&&d.__esModule&&d||{default:d}).getRenderer;
h("./editors/autocompleteEditor.js");h("./editors/checkboxEditor.js");h("./editors/dateEditor.js");h("./editors/dropdownEditor.js");h("./editors/handsontableEditor.js");h("./editors/mobileTextEditor.js");h("./editors/numericEditor.js");h("./editors/passwordEditor.js");h("./editors/selectEditor.js");h("./editors/textEditor.js");h("./renderers/autocompleteRenderer.js");h("./renderers/checkboxRenderer.js");h("./renderers/htmlRenderer.js");h("./renderers/numericRenderer.js");h("./renderers/passwordRenderer.js");
h("./renderers/textRenderer.js");h("./validators/autocompleteValidator.js");h("./validators/dateValidator.js");h("./validators/numericValidator.js");Handsontable.mobileBrowser=q.isMobileBrowser();Handsontable.AutocompleteCell={editor:a("autocomplete"),renderer:e("autocomplete"),validator:Handsontable.AutocompleteValidator};Handsontable.CheckboxCell={editor:a("checkbox"),renderer:e("checkbox")};Handsontable.TextCell={editor:Handsontable.mobileBrowser?a("mobile"):a("text"),renderer:e("text")};Handsontable.NumericCell=
{editor:a("numeric"),renderer:e("numeric"),validator:Handsontable.NumericValidator,dataType:"number"};Handsontable.DateCell={editor:a("date"),validator:Handsontable.DateValidator,renderer:e("autocomplete")};Handsontable.HandsontableCell={editor:a("handsontable"),renderer:e("autocomplete")};Handsontable.PasswordCell={editor:a("password"),renderer:e("password"),copyable:!1};Handsontable.DropdownCell={editor:a("dropdown"),renderer:e("autocomplete"),validator:Handsontable.AutocompleteValidator};Handsontable.cellTypes=
{text:Handsontable.TextCell,date:Handsontable.DateCell,numeric:Handsontable.NumericCell,checkbox:Handsontable.CheckboxCell,autocomplete:Handsontable.AutocompleteCell,handsontable:Handsontable.HandsontableCell,password:Handsontable.PasswordCell,dropdown:Handsontable.DropdownCell};Handsontable.cellLookup={validator:{numeric:Handsontable.NumericValidator,autocomplete:Handsontable.AutocompleteValidator}}},{"./editors.js":29,"./editors/autocompleteEditor.js":31,"./editors/checkboxEditor.js":32,"./editors/dateEditor.js":33,
"./editors/dropdownEditor.js":34,"./editors/handsontableEditor.js":35,"./editors/mobileTextEditor.js":36,"./editors/numericEditor.js":37,"./editors/passwordEditor.js":38,"./editors/selectEditor.js":39,"./editors/textEditor.js":40,"./helpers.js":42,"./renderers.js":70,"./renderers/autocompleteRenderer.js":72,"./renderers/checkboxRenderer.js":73,"./renderers/htmlRenderer.js":74,"./renderers/numericRenderer.js":75,"./renderers/passwordRenderer.js":76,"./renderers/textRenderer.js":77,"./validators/autocompleteValidator.js":86,
"./validators/dateValidator.js":87,"./validators/numericValidator.js":88}],25:[function(h,q,r){var a,e,d,k,m,c,b,p,l,g,t,v=(a=h("./dom.js"),a&&a.__esModule&&a||{default:a}),f=(e=h("./helpers.js"),e&&e.__esModule&&e||{default:e}),n=(d=h("numeral"),d&&d.__esModule&&d||{default:d}).default,w=(k=h("./dataMap.js"),k&&k.__esModule&&k||{default:k}).DataMap,I=(m=h("./editorManager.js"),m&&m.__esModule&&m||{default:m}).EditorManager,N=(c=h("./eventManager.js"),c&&c.__esModule&&c||{default:c}).eventManager,
W=(b=h("./plugins.js"),b&&b.__esModule&&b||{default:b}).getPlugin,y=(p=h("./renderers.js"),p&&p.__esModule&&p||{default:p}).getRenderer,F=(l=h("./tableView.js"),l&&l.__esModule&&l||{default:l}).TableView,B=(g=h("./3rdparty/walkontable/src/cell/coords.js"),g&&g.__esModule&&g||{default:g}).WalkontableCellCoords,z=(t=h("./3rdparty/walkontable/src/cell/range.js"),t&&t.__esModule&&t||{default:t}).WalkontableCellRange;h("./3rdparty/walkontable/src/selection.js");Handsontable.activeGuid=null;Handsontable.Core=
function(a,b){function c(){var a=!1;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++;a=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=0>this.validatorsInQueue-1?0:this.validatorsInQueue-1;this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==a&&(a=!0,this.onQueueEmpty())}}}function g(a,b,f){var d=new c;d.onQueueEmpty=function(){var c;a.length&&(c=Handsontable.hooks.run(u,"beforeChange",a,
b),"function"===typeof c?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):!1===c&&a.splice(0,a.length));f()};for(var l=a.length-1;0<=l;l--)if(null===a[l])a.splice(l,1);else{var t=a[l][0],w=e.propToCol(a[l][1]),w=u.runHooks("modifyCol",w),t=u.getCellMeta(t,w);"numeric"===t.type&&"string"===typeof a[l][3]&&0<a[l][3].length&&(/^-?[\d\s]*(\.|\,)?\d*$/.test(a[l][3])||t.format)&&(w=a[l][3].length,
"undefined"==typeof t.language?n.language("en"):a[l][3].indexOf(".")===w-3&&-1===a[l][3].indexOf(",")?n.language("en"):n.language(t.language),n.validate(a[l][3])&&(a[l][3]=n().unformat(a[l][3])));u.getCellValidator(t)&&(d.addValidatorToQueue(),u.validateCell(a[l][3],t,function(b,f){return function(c){if("boolean"!==typeof c)throw Error("Validation error: result is not boolean");!1===c&&!1===f.allowInvalid&&(a.splice(b,1),f.valid=!0,--b);d.removeValidatorFormQueue()}}(l,t),b))}d.checkIfQueueIsEmpty()}
function t(a,b){var f=a.length-1;if(!(0>f)){for(;0<=f;f--)if(null===a[f])a.splice(f,1);else if(null!=a[f][2]||null!=a[f][3]){if(d.settings.allowInsertRow)for(;a[f][0]>u.countRows()-1;)e.createRow();if("array"===u.dataType&&d.settings.allowInsertColumn)for(;e.propToCol(a[f][1])>u.countCols()-1;)e.createCol();e.set(a[f][0],a[f][1],a[f][3])}u.forceFullRender=!0;m.adjustRowsAndCols();Handsontable.hooks.run(u,"beforeChangeRender",a,b);k.refreshBorders(null,!0);Handsontable.hooks.run(u,"afterChange",a,
b||"edit")}}function l(a){if(a.hasOwnProperty("type")){var b,f={};if("object"===typeof a.type)b=a.type;else if("string"===typeof a.type&&(b=Handsontable.cellTypes[a.type],void 0===b))throw Error('You declared cell type "'+a.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(var c in b)b.hasOwnProperty(c)&&!a.hasOwnProperty(c)&&(f[c]=b[c]);return f}}function p(){throw Error("This method cannot be called because this Handsontable instance has been destroyed");
}var d,e,m,k,h,u=this,q=function(){},r=N(u);f.extend(q.prototype,A.prototype);f.extend(q.prototype,b);f.extend(q.prototype,l(b));this.rootElement=a;this.isHotTableEnv=v.isChildOfWebComponentTable(this.rootElement);Handsontable.eventManager.isHotTableEnv=this.isHotTableEnv;this.container=document.createElement("DIV");a.insertBefore(this.container,a.firstChild);this.guid="ht_"+f.randomString();this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);d={cellSettings:[],
columnSettings:[],columnsSettingConflicts:["data","width"],settings:new q,selRange:null,isPopulated:null,scrollable:null,firstRun:!0};m={alter:function(a,b,f,c,g){f=f||1;switch(a){case "insert_row":if(u.getSettings().maxRows===u.countRows())return;if(f=e.createRow(b,f))k.isSelected()&&d.selRange.from.row>=b?(d.selRange.from.row+=f,k.transformEnd(f,0)):k.refreshBorders();break;case "insert_col":if(f=e.createCol(b,f))Array.isArray(u.getSettings().colHeaders)&&(a=[b,0],a.length+=f,Array.prototype.splice.apply(u.getSettings().colHeaders,
a)),k.isSelected()&&d.selRange.from.col>=b?(d.selRange.from.col+=f,k.transformEnd(0,f)):k.refreshBorders();break;case "remove_row":b=u.runHooks("modifyCol",b);e.removeRow(b,f);d.cellSettings.splice(b,f);a=u.getSettings().fixedRowsTop;a>=b+1&&(u.getSettings().fixedRowsTop-=Math.min(f,a-b));m.adjustRowsAndCols();k.refreshBorders();break;case "remove_col":e.removeCol(b,f);a=0;for(c=e.getAll().length;a<c;a++)a in d.cellSettings&&d.cellSettings[a].splice(b,f);a=u.getSettings().fixedColumnsLeft;a>=b+1&&
(u.getSettings().fixedColumnsLeft-=Math.min(f,a-b));Array.isArray(u.getSettings().colHeaders)&&("undefined"==typeof b&&(b=-1),u.getSettings().colHeaders.splice(b,f));m.adjustRowsAndCols();k.refreshBorders();break;default:throw Error('There is no such action "'+a+'"');}g||m.adjustRowsAndCols()},adjustRowsAndCols:function(){var a,b;b=u.countRows();if(b<d.settings.minRows)for(a=0;a<d.settings.minRows-b;a++)e.createRow(u.countRows(),1,!0);a=u.countEmptyRows(!0);if(a<d.settings.minSpareRows)for(;a<d.settings.minSpareRows&&
u.countRows()<d.settings.maxRows;a++)e.createRow(u.countRows(),1,!0);a=u.countEmptyCols(!0);if(!d.settings.columns&&u.countCols()<d.settings.minCols)for(;u.countCols()<d.settings.minCols;a++)e.createCol(u.countCols(),1,!0);if(!d.settings.columns&&"array"===u.dataType&&a<d.settings.minSpareCols)for(;a<d.settings.minSpareCols&&u.countCols()<d.settings.maxCols;a++)e.createCol(u.countCols(),1,!0);a=u.countRows();b=u.countCols();0!==a&&0!==b||k.deselect();if(k.isSelected()){var f,c=d.selRange.from.row,
g=d.selRange.from.col,n=d.selRange.to.row,l=d.selRange.to.col;c>a-1?(c=a-1,f=!0,n>c&&(n=c)):n>a-1&&(n=a-1,f=!0,c>n&&(c=n));g>b-1?(g=b-1,f=!0,l>g&&(l=g)):l>b-1&&(l=b-1,f=!0,g>l&&(g=l));f&&u.selectCell(c,g,n,l)}u.view&&u.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(a,b,c,g,n,l,t){var w,v,p,e=[],k,m;w=b.length;if(0===w)return!1;switch(n){case "shift_down":g=c?c.col-a.col+1:0;c=c?c.row-a.row+1:0;b=f.translateRowsToColumns(b);v=0;p=b.length;for(g=Math.max(p,g);v<g;v++)if(v<p){n=
0;for(w=b[v].length;n<c-w;n++)b[v].push(b[v][n%w]);b[v].unshift(a.col+v,a.row,0);u.spliceCol.apply(u,b[v])}else b[v%p][0]=a.col+v,u.spliceCol.apply(u,b[v%p]);break;case "shift_right":g=c?c.col-a.col+1:0;c=c?c.row-a.row+1:0;n=0;w=b.length;for(c=Math.max(w,c);n<c;n++)if(n<w){v=0;for(p=b[n].length;v<g-p;v++)b[n].push(b[n][v%p]);b[n].unshift(a.row+n,a.col,0);u.spliceRow.apply(u,b[n])}else b[n%w][0]=a.row+n,u.spliceRow.apply(u,b[n%w]);break;default:k=a.row;var I={row:0,col:0},z={row:c&&a?c.row-a.row+1:
1,col:c&&a?c.col-a.col+1:1},y=!0;-1!==["up","left"].indexOf(l)?I={row:Math.ceil(z.row/w)||1,col:Math.ceil(z.col/b[0].length)||1}:-1!==["down","right"].indexOf(l)&&(I={row:1,col:1});for(n=0;n<w&&!(c&&k>c.row||!d.settings.allowInsertRow&&k>u.countRows()-1||k>=d.settings.maxRows);n++){m=a.col;p=b[n]?b[n].length:0;for(v=0;v<p&&!(c&&m>c.col||!d.settings.allowInsertColumn&&m>u.countCols()-1||m>=d.settings.maxCols);v++){if(!u.getCellMeta(k,m).readOnly){var h,N=b[n][v],x=u.getDataAtCell(k,m);h={row:n,col:v};
"autofill"===g&&(h=u.runHooks("beforeAutofillInsidePopulate",h,l,b,t,I,z))&&(I="undefined"!==typeof h.iterators?h.iterators:I,N="undefined"!==typeof h.value?h.value:N);null!==N&&"object"===typeof N?null===x||"object"!==typeof x?y=!1:(h=Handsontable.helper.duckSchema(x[0]||x),x=Handsontable.helper.duckSchema(N[0]||N),Handsontable.helper.isObjectEquals(h,x)?N=Handsontable.helper.deepClone(N):y=!1):null!==x&&"object"===typeof x&&(y=!1);y&&e.push([k,m,N]);y=!0}m++;c&&v===p-1&&(v=-1,-1!==["down","right"].indexOf(l)?
I.col++:-1!==["up","left"].indexOf(l)&&1<I.col&&I.col--)}k++;I.col=1;c&&n===w-1&&(n=-1,-1!==["down","right"].indexOf(l)?I.row++:-1!==["up","left"].indexOf(l)&&1<I.row&&I.row--)}u.setDataAtCell(e,null,null,g||"populateFromArray")}}};this.selection=k={inProgress:!1,selectedHeader:{cols:!1,rows:!1},setSelectedHeaders:function(a,b){u.selection.selectedHeader.rows=a;u.selection.selectedHeader.cols=b},begin:function(){u.selection.inProgress=!0},finish:function(){var a=u.getSelected();Handsontable.hooks.run(u,
"afterSelectionEnd",a[0],a[1],a[2],a[3]);Handsontable.hooks.run(u,"afterSelectionEndByProp",a[0],u.colToProp(a[1]),a[2],u.colToProp(a[3]));u.selection.inProgress=!1},isInProgress:function(){return u.selection.inProgress},setRangeStart:function(a,b){Handsontable.hooks.run(u,"beforeSetRangeStart",a);d.selRange=new z(a,a,a);k.setRangeEnd(a,null,b)},setRangeEnd:function(a,b,f){if(null!==d.selRange){var c;Handsontable.hooks.run(u,"beforeSetRangeEnd",a);u.selection.begin();d.selRange.to=new B(a.row,a.col);
d.settings.multiSelect||(d.selRange.from=a);u.view.wt.selections.current.clear();c=u.getCellMeta(d.selRange.highlight.row,d.selRange.highlight.col).disableVisualSelection;"string"===typeof c&&(c=[c]);(!1===c||Array.isArray(c)&&-1===c.indexOf("current"))&&u.view.wt.selections.current.add(d.selRange.highlight);u.view.wt.selections.area.clear();(!1===c||Array.isArray(c)&&-1===c.indexOf("area"))&&k.isMultiple()&&(u.view.wt.selections.area.add(d.selRange.from),u.view.wt.selections.area.add(d.selRange.to));
if(d.settings.currentRowClassName||d.settings.currentColClassName)u.view.wt.selections.highlight.clear(),u.view.wt.selections.highlight.add(d.selRange.from),u.view.wt.selections.highlight.add(d.selRange.to);Handsontable.hooks.run(u,"afterSelection",d.selRange.from.row,d.selRange.from.col,d.selRange.to.row,d.selRange.to.col);Handsontable.hooks.run(u,"afterSelectionByProp",d.selRange.from.row,e.colToProp(d.selRange.from.col),d.selRange.to.row,e.colToProp(d.selRange.to.col));!1!==b&&u.view.mainViewIsActive()&&
(d.selRange.from&&!k.isMultiple()?u.view.scrollViewport(d.selRange.from):u.view.scrollViewport(a));k.refreshBorders(null,f)}},refreshBorders:function(a,b){b||h.destroyEditor(a);u.view.render();k.isSelected()&&!b&&h.prepareEditor()},isMultiple:function(){var a=!(d.selRange.to.col===d.selRange.from.col&&d.selRange.to.row===d.selRange.from.row),b=Handsontable.hooks.run(u,"afterIsMultipleSelection",a);if(a)return b},transformStart:function(a,b,f,c){var g=new B(a,b),n=b=0,l,t;u.runHooks("modifyTransformStart",
g);l=u.countRows();t=u.countCols();d.selRange.highlight.row+a>l-1?f&&0<d.settings.minSpareRows?(u.alter("insert_row",l),l=u.countRows()):d.settings.autoWrapCol&&(g.row=1-l,g.col=d.selRange.highlight.col+g.col==t-1?1-t:1):d.settings.autoWrapCol&&0>d.selRange.highlight.row+g.row&&0<=d.selRange.highlight.col+g.col&&(g.row=l-1,g.col=0==d.selRange.highlight.col+g.col?t-1:-1);d.selRange.highlight.col+g.col>t-1?f&&0<d.settings.minSpareCols?(u.alter("insert_col",t),t=u.countCols()):d.settings.autoWrapRow&&
(g.row=d.selRange.highlight.row+g.row==l-1?1-l:1,g.col=1-t):d.settings.autoWrapRow&&0>d.selRange.highlight.col+g.col&&0<=d.selRange.highlight.row+g.row&&(g.row=0==d.selRange.highlight.row+g.row?l-1:-1,g.col=t-1);a=new B(d.selRange.highlight.row+g.row,d.selRange.highlight.col+g.col);0>a.row?(b=-1,a.row=0):0<a.row&&a.row>=l&&(b=1,a.row=l-1);0>a.col?(n=-1,a.col=0):0<a.col&&a.col>=t&&(n=1,a.col=t-1);u.runHooks("afterModifyTransformStart",a,b,n);k.setRangeStart(a,c)},transformEnd:function(a,b){var f=new B(a,
b),c=0,g=0,n,l;u.runHooks("modifyTransformEnd",f);n=u.countRows();l=u.countCols();f=new B(d.selRange.to.row+f.row,d.selRange.to.col+f.col);0>f.row?(c=-1,f.row=0):0<f.row&&f.row>=n&&(c=1,f.row=n-1);0>f.col?(g=-1,f.col=0):0<f.col&&f.col>=l&&(g=1,f.col=l-1);u.runHooks("afterModifyTransformEnd",f,c,g);k.setRangeEnd(f,!0)},isSelected:function(){return null!==d.selRange},inInSelection:function(a){return k.isSelected()?d.selRange.includes(a):!1},deselect:function(){k.isSelected()&&(u.selection.inProgress=
!1,d.selRange=null,u.view.wt.selections.current.clear(),u.view.wt.selections.area.clear(),(d.settings.currentRowClassName||d.settings.currentColClassName)&&u.view.wt.selections.highlight.clear(),h.destroyEditor(),k.refreshBorders(),Handsontable.hooks.run(u,"afterDeselect"))},selectAll:function(){d.settings.multiSelect&&(k.setRangeStart(new B(0,0)),k.setRangeEnd(new B(u.countRows()-1,u.countCols()-1),!1))},empty:function(){if(k.isSelected()){var a=d.selRange.getTopLeftCorner(),b=d.selRange.getBottomRightCorner(),
f,c,g=[];for(f=a.row;f<=b.row;f++)for(c=a.col;c<=b.col;c++)u.getCellMeta(f,c).readOnly||g.push([f,c,""]);u.setDataAtCell(g)}}};this.init=function(){Handsontable.hooks.run(u,"beforeInit");Handsontable.mobileBrowser&&v.addClass(u.rootElement,"mobile");this.updateSettings(d.settings,!0);this.view=new F(this);h=new I(u,d,k,e);this.forceFullRender=!0;this.view.render();"object"===typeof d.firstRun&&(Handsontable.hooks.run(u,"afterChange",d.firstRun[0],d.firstRun[1]),d.firstRun=!1);Handsontable.hooks.run(u,
"afterInit")};this.validateCell=function(a,b,f,c){function g(a){var c=b.col,n=b.row,l=u.getCell(n,c,!0);l&&u.view.wt.wtSettings.settings.cellRenderer(n,c,l);f(a)}var n=u.getCellValidator(b);"[object RegExp]"===Object.prototype.toString.call(n)&&(n=function(a){return function(b,f){f(a.test(b))}}(n));"function"==typeof n?(a=Handsontable.hooks.run(u,"beforeValidate",a,b.row,b.prop,c),u._registerTimeout(setTimeout(function(){n.call(b,a,function(f){f=Handsontable.hooks.run(u,"afterValidate",f,a,b.row,
b.prop,c);b.valid=f;g(f);Handsontable.hooks.run(u,"postAfterValidate",f,a,b.row,b.prop,c)})},0))):(b.valid=!0,g(b.valid))};this.setDataAtCell=function(a,b,f,c){f="object"===typeof a?a:[[a,b,f]];var n,l,d=[],w;n=0;for(l=f.length;n<l;n++){if("object"!==typeof f[n])throw Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!==typeof f[n][1])throw Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");
w=e.colToProp(f[n][1]);d.push([f[n][0],w,e.get(f[n][0],w),f[n][2]])}c||"object"!==typeof a||(c=b);g(d,c,function(){t(d,c)})};this.setDataAtRowProp=function(a,b,f,c){f="object"===typeof a?a:[[a,b,f]];var n,l,d=[];n=0;for(l=f.length;n<l;n++)d.push([f[n][0],f[n][1],e.get(f[n][0],f[n][1]),f[n][2]]);c||"object"!==typeof a||(c=b);g(d,c,function(){t(d,c)})};this.listen=function(){Handsontable.activeGuid=u.guid;document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||
document.body.focus()};this.unlisten=function(){Handsontable.activeGuid=null};this.isListening=function(){return Handsontable.activeGuid===u.guid};this.destroyEditor=function(a){k.refreshBorders(a)};this.populateFromArray=function(a,b,f,c,g,n,l,d,t){if("object"!==typeof f||"object"!==typeof f[0])throw Error("populateFromArray parameter `input` must be an array of arrays");c="number"===typeof c?new B(c,g):null;return m.populateFromArray(new B(a,b),f,c,n,l,d,t)};this.spliceCol=function(a,b,f){return e.spliceCol.apply(e,
arguments)};this.spliceRow=function(a,b,f){return e.spliceRow.apply(e,arguments)};this.getSelected=function(){if(k.isSelected())return[d.selRange.from.row,d.selRange.from.col,d.selRange.to.row,d.selRange.to.col]};this.getSelectedRange=function(){if(k.isSelected())return d.selRange};this.render=function(){u.view&&(u.forceFullRender=!0,k.refreshBorders(null,!0))};this.loadData=function(a){if("object"===typeof a&&null!==a)a.push&&a.splice||(a=[a]);else if(null===a){a=[];for(var b,f=0,c=d.settings.startRows;f<
c;f++){b=[];for(var g=0,n=d.settings.startCols;g<n;g++)b.push(null);a.push(b)}}else throw Error("loadData only accepts array of objects or array of arrays ("+typeof a+" given)");d.isPopulated=!1;q.prototype.data=a;Array.isArray(d.settings.dataSchema)||Array.isArray(a[0])?u.dataType="array":u.dataType="function"===typeof d.settings.dataSchema?"function":"object";e=new w(u,d,q);d.cellSettings.length=0;m.adjustRowsAndCols();Handsontable.hooks.run(u,"afterLoadData");d.firstRun?d.firstRun=[null,"loadData"]:
(Handsontable.hooks.run(u,"afterChange",null,"loadData"),u.render());d.isPopulated=!0};this.getData=function(a,b,f,c){return"undefined"===typeof a?e.getAll():e.getRange(new B(a,b),new B(f,c),e.DESTINATION_RENDERER)};this.getCopyableData=function(a,b,f,c){return e.getCopyableText(new B(a,b),new B(f,c))};this.getSchema=function(){return e.getSchema()};this.updateSettings=function(a,b){var c,g;if("undefined"!==typeof a.rows)throw Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?");
if("undefined"!==typeof a.cols)throw Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?");for(c in a)"data"!==c&&(-1<Handsontable.hooks.getRegistered().indexOf(c)?("function"===typeof a[c]||Array.isArray(a[c]))&&u.addHook(c,a[c]):!b&&a.hasOwnProperty(c)&&(q.prototype[c]=a[c]));void 0===a.data&&void 0===d.settings.data?u.loadData(null):void 0!==a.data?u.loadData(a.data):void 0!==a.columns&&e.createMap();g=u.countCols();d.cellSettings.length=0;if(0<g){var n,t;for(c=
0;c<g;c++)d.columnSettings[c]=f.columnFactory(q,d.columnsSettingConflicts),n=d.columnSettings[c].prototype,q.prototype.columns&&(t=q.prototype.columns[c],f.extend(n,t),f.extend(n,l(t)))}if("undefined"!==typeof a.cell)for(c in a.cell)a.cell.hasOwnProperty(c)&&(g=a.cell[c],u.setCellMetaObject(g.row,g.col,g));Handsontable.hooks.run(u,"afterCellMetaReset");"undefined"!==typeof a.className&&(q.prototype.className&&v.removeClass(u.rootElement,q.prototype.className),a.className&&v.addClass(u.rootElement,
a.className));if("undefined"!=typeof a.height){var w=a.height;"function"==typeof w&&(w=w());u.rootElement.style.height=w+"px"}"undefined"!=typeof a.width&&(c=a.width,"function"==typeof c&&(c=c()),u.rootElement.style.width=c+"px");w&&(u.rootElement.style.overflow="hidden");b||Handsontable.hooks.run(u,"afterUpdateSettings");m.adjustRowsAndCols();u.view&&!d.firstRun&&(u.forceFullRender=!0,k.refreshBorders(null,!0))};this.getValue=function(){var a=u.getSelected();if(q.prototype.getValue){if("function"===
typeof q.prototype.getValue)return q.prototype.getValue.call(u);if(a)return u.getData()[a[0]][q.prototype.getValue]}else if(a)return u.getDataAtCell(a[0],a[1])};this.getSettings=function(){return d.settings};this.clear=function(){k.selectAll();k.empty()};this.alter=function(a,b,f,c,g){m.alter(a,b,f,c,g)};this.getCell=function(a,b,f){return u.view.getCellAtCoords(new B(a,b),f)};this.getCoords=function(a){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,a)};this.colToProp=function(a){return e.colToProp(a)};
this.propToCol=function(a){return e.propToCol(a)};this.getDataAtCell=function(a,b){return e.get(a,e.colToProp(b))};this.getDataAtRowProp=function(a,b){return e.get(a,b)};this.getDataAtCol=function(a){var b=[];return b.concat.apply(b,e.getRange(new B(0,a),new B(d.settings.data.length-1,a),e.DESTINATION_RENDERER))};this.getDataAtProp=function(a){var b=[];a=e.getRange(new B(0,e.propToCol(a)),new B(d.settings.data.length-1,e.propToCol(a)),e.DESTINATION_RENDERER);return b.concat.apply(b,a)};this.getSourceDataAtCol=
function(a){for(var b=[],f=d.settings.data,c=0;c<f.length;c++)b.push(f[c][a]);return b};this.getSourceDataAtRow=function(a){return d.settings.data[a]};this.getDataAtRow=function(a){return e.getRange(new B(a,0),new B(a,this.countCols()-1),e.DESTINATION_RENDERER)[0]};this.removeCellMeta=function(a,b,f){void 0!=u.getCellMeta(a,b)[f]&&delete d.cellSettings[a][b][f]};this.setCellMetaObject=function(a,b,f){if("object"===typeof f)for(var c in f)f.hasOwnProperty(c)&&this.setCellMeta(a,b,c,f[c])};this.setCellMeta=
function(a,b,f,c){d.cellSettings[a]||(d.cellSettings[a]=[]);d.cellSettings[a][b]||(d.cellSettings[a][b]=new d.columnSettings[b]);d.cellSettings[a][b][f]=c;Handsontable.hooks.run(u,"afterSetCellMeta",a,b,f,c)};this.getCellMeta=function(a,b){var c=e.colToProp(b),g;a=Handsontable.hooks.run(u,"modifyRow",a);b=Handsontable.hooks.run(u,"modifyCol",b);d.columnSettings[b]||(d.columnSettings[b]=f.columnFactory(q,d.columnsSettingConflicts));d.cellSettings[a]||(d.cellSettings[a]=[]);d.cellSettings[a][b]||(d.cellSettings[a][b]=
new d.columnSettings[b]);g=d.cellSettings[a][b];g.row=a;g.col=b;g.prop=c;g.instance=u;Handsontable.hooks.run(u,"beforeGetCellMeta",a,b,g);f.extend(g,l(g));g.cells&&(c=g.cells.call(g,a,b,c))&&(f.extend(g,c),f.extend(g,l(c)));Handsontable.hooks.run(u,"afterGetCellMeta",a,b,g);return g};this.isColumnModificationAllowed=function(){return!("object"===u.dataType||u.getSettings().columns)};var ea=f.cellMethodLookupFactory("renderer");this.getCellRenderer=function(a,b){var f=ea.call(this,a,b);return y(f)};
this.getCellEditor=f.cellMethodLookupFactory("editor");this.getCellValidator=f.cellMethodLookupFactory("validator");this.validateCells=function(a){var b=new c;b.onQueueEmpty=a;for(a=u.countRows()-1;0<=a;){for(var f=u.countCols()-1;0<=f;)b.addValidatorToQueue(),u.validateCell(u.getDataAtCell(a,f),u.getCellMeta(a,f),function(){b.removeValidatorFormQueue()},"validateCells"),f--;a--}b.checkIfQueueIsEmpty()};this.getRowHeader=function(a){if(void 0===a){a=[];for(var b=0,f=u.countRows();b<f;b++)a.push(u.getRowHeader(b));
return a}return Array.isArray(d.settings.rowHeaders)&&void 0!==d.settings.rowHeaders[a]?d.settings.rowHeaders[a]:"function"===typeof d.settings.rowHeaders?d.settings.rowHeaders(a):d.settings.rowHeaders&&"string"!==typeof d.settings.rowHeaders&&"number"!==typeof d.settings.rowHeaders?a+1:d.settings.rowHeaders};this.hasRowHeaders=function(){return!!d.settings.rowHeaders};this.hasColHeaders=function(){if(void 0!==d.settings.colHeaders&&null!==d.settings.colHeaders)return!!d.settings.colHeaders;for(var a=
0,b=u.countCols();a<b;a++)if(u.getColHeader(a))return!0;return!1};this.getColHeader=function(a){if(void 0===a){a=[];for(var b=0,c=u.countCols();b<c;b++)a.push(u.getColHeader(b));return a}b=a;a=Handsontable.hooks.run(u,"modifyCol",a);return d.settings.columns&&d.settings.columns[a]&&d.settings.columns[a].title?d.settings.columns[a].title:Array.isArray(d.settings.colHeaders)&&void 0!==d.settings.colHeaders[a]?d.settings.colHeaders[a]:"function"===typeof d.settings.colHeaders?d.settings.colHeaders(a):
d.settings.colHeaders&&"string"!==typeof d.settings.colHeaders&&"number"!==typeof d.settings.colHeaders?f.spreadsheetColumnLabel(b):d.settings.colHeaders};this._getColWidthFromSettings=function(a){var b=u.getCellMeta(0,a),f=b.width;if(void 0===f||f===d.settings.width)f=b.colWidths;if(void 0!==f&&null!==f){switch(typeof f){case "object":f=f[a];break;case "function":f=f(a)}"string"===typeof f&&(f=parseInt(f,10))}return f};this.getColWidth=function(a){var b=u._getColWidthFromSettings(a);b||(b=50);return b=
Handsontable.hooks.run(u,"modifyColWidth",b,a)};this._getRowHeightFromSettings=function(a){var b=d.settings.rowHeights;if(void 0!==b&&null!==b){switch(typeof b){case "object":b=b[a];break;case "function":b=b(a)}"string"===typeof b&&(b=parseInt(b,10))}return b};this.getRowHeight=function(a){var b=u._getRowHeightFromSettings(a);return b=Handsontable.hooks.run(u,"modifyRowHeight",b,a)};this.countRows=function(){return d.settings.data.length};this.countCols=function(){if("object"===u.dataType||"function"===
u.dataType)return d.settings.columns&&d.settings.columns.length?d.settings.columns.length:e.colToPropCache.length;if("array"===u.dataType)return d.settings.columns&&d.settings.columns.length?d.settings.columns.length:d.settings.data&&d.settings.data[0]&&d.settings.data[0].length?d.settings.data[0].length:0};this.rowOffset=function(){return u.view.wt.wtTable.getFirstRenderedRow()};this.colOffset=function(){return u.view.wt.wtTable.getFirstRenderedColumn()};this.countRenderedRows=function(){return u.view.wt.drawn?
u.view.wt.wtTable.getRenderedRowsCount():-1};this.countVisibleRows=function(){return u.view.wt.drawn?u.view.wt.wtTable.getVisibleRowsCount():-1};this.countRenderedCols=function(){return u.view.wt.drawn?u.view.wt.wtTable.getRenderedColumnsCount():-1};this.countVisibleCols=function(){return u.view.wt.drawn?u.view.wt.wtTable.getVisibleColumnsCount():-1};this.countEmptyRows=function(a){for(var b=u.countRows()-1,f=0,c;0<=b;){c=Handsontable.hooks.run(this,"modifyRow",b);if(u.isEmptyRow(c))f++;else if(a)break;
b--}return f};this.countEmptyCols=function(a){if(1>u.countRows())return 0;for(var b=u.countCols()-1,f=0;0<=b;){if(u.isEmptyCol(b))f++;else if(a)break;b--}return f};this.isEmptyRow=function(a){return d.settings.isEmptyRow.call(u,a)};this.isEmptyCol=function(a){return d.settings.isEmptyCol.call(u,a)};this.selectCell=function(a,b,f,c,g,n){n="undefined"===typeof n||!0===n;if("number"!==typeof a||0>a||a>=u.countRows()||"number"!==typeof b||0>b||b>=u.countCols()||"undefined"!==typeof f&&("number"!==typeof f||
0>f||f>=u.countRows()||"number"!==typeof c||0>c||c>=u.countCols()))return!1;a=new B(a,b);d.selRange=new z(a,a,a);document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body&&document.activeElement.blur();n&&u.listen();"undefined"===typeof f?k.setRangeEnd(d.selRange.from,g):k.setRangeEnd(new B(f,c),g);u.selection.finish();return!0};this.selectCellByProp=function(a,b,f,c,g){arguments[1]=e.propToCol(arguments[1]);"undefined"!==typeof arguments[3]&&
(arguments[3]=e.propToCol(arguments[3]));return u.selectCell.apply(u,arguments)};this.deselectCell=function(){k.deselect()};this.destroy=function(){u._clearTimeouts();u.view&&u.view.destroy();v.empty(u.rootElement);r.clear();Handsontable.hooks.run(u,"afterDestroy");Handsontable.hooks.destroy(u);for(var a in u)u.hasOwnProperty(a)&&("function"===typeof u[a]?"runHooks"!==a&&(u[a]=p):"guid"!==a&&(u[a]=null));q=u=h=k=m=e=d=null};this.getActiveEditor=function(){return h.getActiveEditor()};this.getPlugin=
function(a){return W(this,a)};this.getInstance=function(){return u};this.addHook=function(a,b){Handsontable.hooks.add(a,b,u)};this.addHookOnce=function(a,b){Handsontable.hooks.once(a,b,u)};this.removeHook=function(a,b){Handsontable.hooks.remove(a,b,u)};this.runHooks=function(a,b,f,c,g,n,l){return Handsontable.hooks.run(u,a,b,f,c,g,n,l)};this.timeouts=[];this._registerTimeout=function(a){this.timeouts.push(a)};this._clearTimeouts=function(){for(var a=0,b=this.timeouts.length;a<b;a++)clearTimeout(this.timeouts[a])};
this.version=Handsontable.version};var A=function(){};A.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,colWidths:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:!0,
enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1E3,copyColsLimit:1E3,pasteMode:"overwrite",persistentState:!1,currentRowClassName:void 0,currentColClassName:void 0,stretchH:"none",isEmptyRow:function(a){var b,c,g;b=0;for(c=this.countCols();b<c;b++)if(g=this.getDataAtCell(a,b),""!==g&&null!==g&&"undefined"!==typeof g)return"object"===typeof g?(a=this.getCellMeta(a,b),f.isObjectEquals(this.getSchema()[a.prop],g)):!1;return!0},isEmptyCol:function(a){var b,
f,c;b=0;for(f=this.countRows();b<f;b++)if(c=this.getDataAtCell(b,a),""!==c&&null!==c&&"undefined"!==typeof c)return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,search:!1,type:"text",copyable:!0,editor:void 0,autoComplete:void 0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,
undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,viewportRowRenderingOffset:10,viewportColumnRenderingOffset:10,groups:void 0,validator:void 0,disableVisualSelection:!1,sortIndicator:!1,manualColumnFreeze:void 0,trimWhitespace:!0,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,format:void 0,className:void 0};Handsontable.DefaultSettings=A},{"./3rdparty/walkontable/src/cell/coords.js":5,
"./3rdparty/walkontable/src/cell/range.js":6,"./3rdparty/walkontable/src/selection.js":18,"./dataMap.js":26,"./dom.js":27,"./editorManager.js":28,"./eventManager.js":41,"./helpers.js":42,"./plugins.js":45,"./renderers.js":70,"./tableView.js":85,numeral:"numeral"}],26:[function(h,q,r){function a(a,b,c){this.instance=a;this.priv=b;this.GridSettings=c;this.dataSource=this.instance.getSettings().data;this.duckSchema=this.dataSource[0]?this.recursiveDuckSchema(this.dataSource[0]):{};this.createMap()}Object.defineProperties(r,
{DataMap:{get:function(){return a}},__esModule:{value:!0}});var e,d,k,m=(e=h("./helpers.js"),e&&e.__esModule&&e||{default:e}),c=(d=h("./multiMap.js"),d&&d.__esModule&&d||{default:d}).MultiMap,b=(k=h("SheetClip"),k&&k.__esModule&&k||{default:k}).default;Handsontable.DataMap=a;a.prototype.DESTINATION_RENDERER=1;a.prototype.DESTINATION_CLIPBOARD_GENERATOR=2;a.prototype.recursiveDuckSchema=function(a){return Handsontable.helper.duckSchema(a)};a.prototype.recursiveDuckColumns=function(a,b,c){var d,f;"undefined"===
typeof b&&(b=0,c="");if("object"===typeof a&&!Array.isArray(a))for(f in a)a.hasOwnProperty(f)&&(null===a[f]?(d=c+f,this.colToPropCache.push(d),this.propToColCache.set(d,b),b++):b=this.recursiveDuckColumns(a[f],b,f+"."));return b};a.prototype.createMap=function(){var a,b;a=this.getSchema();if("undefined"===typeof a)throw Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");this.colToPropCache=[];this.propToColCache=new c;var d=this.instance.getSettings().columns;
if(d)for(a=0,b=d.length;a<b;a++)"undefined"!=typeof d[a].data&&(this.colToPropCache[a]=d[a].data,this.propToColCache.set(d[a].data,a));else this.recursiveDuckColumns(a)};a.prototype.colToProp=function(a){a=Handsontable.hooks.run(this.instance,"modifyCol",a);return this.colToPropCache&&"undefined"!==typeof this.colToPropCache[a]?this.colToPropCache[a]:a};a.prototype.propToCol=function(a){a="undefined"!==typeof this.propToColCache.get(a)?this.propToColCache.get(a):a;return a=Handsontable.hooks.run(this.instance,
"modifyCol",a)};a.prototype.getSchema=function(){var a=this.instance.getSettings().dataSchema;return a?"function"===typeof a?a():a:this.duckSchema};a.prototype.createRow=function(a,b,c){var d,f=this.instance.countCols(),n=0,w;b||(b=1);if("number"!==typeof a||a>=this.instance.countRows())a=this.instance.countRows();w=a;for(var p=this.instance.getSettings().maxRows;n<b&&this.instance.countRows()<p;){if("array"===this.instance.dataType){d=[];for(var e=0;e<f;e++)d.push(null)}else"function"===this.instance.dataType?
d=this.instance.getSettings().dataSchema(a):(d={},m.deepExtend(d,this.getSchema()));a===this.instance.countRows()?this.dataSource.push(d):this.dataSource.splice(a,0,d);n++;w++}Handsontable.hooks.run(this.instance,"afterCreateRow",a,n,c);this.instance.forceFullRender=!0;return n};a.prototype.createCol=function(a,b,c){if(!this.instance.isColumnModificationAllowed())throw Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");
var d=this.instance.countRows(),f=this.dataSource,n,w=0,p;b||(b=1);p=a;for(var e=this.instance.getSettings().maxCols;w<b&&this.instance.countCols()<e;){n=m.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts);if("number"!==typeof a||a>=this.instance.countCols()){for(var k=0;k<d;k++)"undefined"===typeof f[k]&&(f[k]=[]),f[k].push(null);this.priv.columnSettings.push(n)}else{for(k=0;k<d;k++)f[k].splice(p,0,null);this.priv.columnSettings.splice(p,0,n)}w++;p++}Handsontable.hooks.run(this.instance,
"afterCreateCol",a,w,c);this.instance.forceFullRender=!0;return w};a.prototype.removeRow=function(a,b){b||(b=1);"number"!==typeof a&&(a=-b);a=(this.instance.countRows()+a)%this.instance.countRows();var c=this.physicalRowsToLogical(a,b);if(!1!==Handsontable.hooks.run(this.instance,"beforeRemoveRow",a,b)){var d=this.dataSource,f=d.filter(function(a,b){return-1==c.indexOf(b)});d.length=0;Array.prototype.push.apply(d,f);Handsontable.hooks.run(this.instance,"afterRemoveRow",a,b);this.instance.forceFullRender=
!0}};a.prototype.removeCol=function(a,b){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw Error("cannot remove column with object data source or columns option specified");b||(b=1);"number"!==typeof a&&(a=-b);a=(this.instance.countCols()+a)%this.instance.countCols();if(!1!==Handsontable.hooks.run(this.instance,"beforeRemoveCol",a,b)){for(var c=this.dataSource,d=0,f=this.instance.countRows();d<f;d++)c[d].splice(a,b);this.priv.columnSettings.splice(a,b);Handsontable.hooks.run(this.instance,
"afterRemoveCol",a,b);this.instance.forceFullRender=!0}};a.prototype.spliceCol=function(a,b,c){var d=4<=arguments.length?[].slice.call(arguments,3):[],f=this.instance.getDataAtCol(a),n=f.slice(b,b+c),f=f.slice(b+c);m.extendArray(d,f);for(f=0;f<c;)d.push(null),f++;m.to2dArray(d);this.instance.populateFromArray(b,a,d,null,null,"spliceCol");return n};a.prototype.spliceRow=function(a,b,c){var d=4<=arguments.length?[].slice.call(arguments,3):[],f=this.instance.getSourceDataAtRow(a),n=f.slice(b,b+c),f=
f.slice(b+c);m.extendArray(d,f);for(f=0;f<c;)d.push(null),f++;this.instance.populateFromArray(a,b,[d],null,null,"spliceRow");return n};a.prototype.get=function(a,b){a=Handsontable.hooks.run(this.instance,"modifyRow",a);if("string"===typeof b&&-1<b.indexOf(".")){var c=b.split("."),d=this.dataSource[a];if(!d)return null;for(var f=0,n=c.length;f<n;f++)if(d=d[c[f]],"undefined"===typeof d)return null;return d}return"function"===typeof b?b(this.dataSource.slice(a,a+1)[0]):this.dataSource[a]?this.dataSource[a][b]:
null};var p=m.cellMethodLookupFactory("copyable",!1);a.prototype.getCopyable=function(a,b){return p.call(this.instance,a,this.propToCol(b))?this.get(a,b):""};a.prototype.set=function(a,b,c,d){a=Handsontable.hooks.run(this.instance,"modifyRow",a,d||"datamapGet");if("string"===typeof b&&-1<b.indexOf(".")){b=b.split(".");a=this.dataSource[a];d=0;for(var f=b.length-1;d<f;d++)"undefined"===typeof a[b[d]]&&(a[b[d]]={}),a=a[b[d]];a[b[d]]=c}else"function"===typeof b?b(this.dataSource.slice(a,a+1)[0],c):this.dataSource[a][b]=
c};a.prototype.physicalRowsToLogical=function(a,b){for(var c=this.instance.countRows(),d=(c+a)%c,f=[],n=b,w;d<c&&n;)w=Handsontable.hooks.run(this.instance,"modifyRow",d),f.push(w),n--,d++;return f};a.prototype.clear=function(){for(var a=0;a<this.instance.countRows();a++)for(var b=0;b<this.instance.countCols();b++)this.set(a,this.colToProp(b),"")};a.prototype.getAll=function(){return this.dataSource};a.prototype.getRange=function(a,b,c){var d,f,n,w=[],p,e=c===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:
this.get;d=Math.max(a.row,b.row);n=Math.max(a.col,b.col);for(c=Math.min(a.row,b.row);c<=d;c++){p=[];for(f=Math.min(a.col,b.col);f<=n;f++)p.push(e.call(this,c,this.colToProp(f)));w.push(p)}return w};a.prototype.getText=function(a,c){return b.stringify(this.getRange(a,c,this.DESTINATION_RENDERER))};a.prototype.getCopyableText=function(a,c){return b.stringify(this.getRange(a,c,this.DESTINATION_CLIPBOARD_GENERATOR))}},{"./helpers.js":42,"./multiMap.js":43,SheetClip:"SheetClip"}],27:[function(h,q,r){function a(a){null!=
a&&null==a.isImmediatePropagationEnabled&&(a.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1;this.cancelBubble=!0},a.isImmediatePropagationEnabled=!0,a.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled})}function e(a,b,f){for(;null!=a&&a!==f;){if(a.nodeType===Node.ELEMENT_NODE&&(-1<b.indexOf(a.nodeName)||-1<b.indexOf(a)))return a;a=a.host&&a.nodeType===Node.DOCUMENT_FRAGMENT_NODE?a.host:a.parentNode}return null}function d(a,b){var f=a.parentNode,
c=[];for("string"===typeof b?c=Array.prototype.slice.call(document.querySelectorAll(b),0):c.push(b);null!=f;){if(-1<c.indexOf(f))return!0;f=f.parentNode}return!1}function k(a){function b(a){return a.nodeType===Node.ELEMENT_NODE&&"HOT-TABLE"===a.nodeName}var f=!1;for(a=m(a);null!=a;){if(b(a)){f=!0;break}else if(a.host&&a.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(f=b(a.host))break;a=a.host}a=a.parentNode}return f}function m(a){return"undefined"!==typeof Polymer&&"function"===typeof wrap?wrap(a):a}
function c(a){return"undefined"!==typeof Polymer&&"function"===typeof unwrap?unwrap(a):a}function b(){var a=document.createElement("div");return a.createShadowRoot&&a.createShadowRoot.toString().match(/\[native code\]/)?!0:!1}function p(a){var b=0;if(a.previousSibling)for(;a=a.previousSibling;)++b;return b}function l(a){var b=0,f=[];if(!a||!a.length)return f;for(;a[b];)f.push(a[b]),b++;return f}function g(a,b){return ba(a,b)}function t(a,b){return oa(a,b)}function v(a,b){return sa(a,b)}function f(a,
b){if(3===a.nodeType)b.removeChild(a);else if(-1<["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(a.nodeName))for(var c=a.childNodes,n=c.length-1;0<=n;n--)f(c[n],a)}function n(a){for(var b;b=a.lastChild;)a.removeChild(b)}function w(a,b){ia.test(b)?a.innerHTML=b:I(a,b)}function I(a,b){var f=a.firstChild;f&&3===f.nodeType&&null===f.nextSibling?ja?f.textContent=b:f.data=b:(n(a),a.appendChild(document.createTextNode(b)))}function N(a){for(;c(a)!==document.documentElement;){if(null===a)return!1;if(a.nodeType===
Node.DOCUMENT_FRAGMENT_NODE){if(a.host){if(a.host.impl)return N(a.host.impl);if(a.host)return N(a.host);throw Error("Lost in Web Components world");}return!1}if("none"===a.style.display)return!1;a=a.parentNode}return!0}function W(a){var b,f,c,n;n=document.documentElement;if(ca()&&a.firstChild&&"CAPTION"===a.firstChild.nodeName)return a=a.getBoundingClientRect(),{top:a.top+(window.pageYOffset||n.scrollTop)-(n.clientTop||0),left:a.left+(window.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};b=a.offsetLeft;
f=a.offsetTop;for(c=a;(a=a.offsetParent)&&a!==document.body;)b+=a.offsetLeft,f+=a.offsetTop,c=a;c&&"fixed"===c.style.position&&(b+=window.pageXOffset||n.scrollLeft,f+=window.pageYOffset||n.scrollTop);return{left:b,top:f}}function y(){var a=window.scrollY;void 0==a&&(a=document.documentElement.scrollTop);return a}function F(){var a=window.scrollX;void 0==a&&(a=document.documentElement.scrollLeft);return a}function B(a){return a===window?y(a):a.scrollTop}function z(a){return a===window?F(a):a.scrollLeft}
function A(a){a=a.parentNode;for(var b=["auto","scroll"],f,c,n,d="",g="",w="",d="";a&&a.style&&document.body!==a;){f=a.style.overflow;c=a.style.overflowX;n=a.style.overflowY;if("scroll"==f||"scroll"==c||"scroll"==n||window.getComputedStyle&&(d=window.getComputedStyle(a),g=d.getPropertyValue("overflow"),w=d.getPropertyValue("overflow-y"),d=d.getPropertyValue("overflow-x"),"scroll"===g||"scroll"===d||"scroll"===w)||a.clientHeight<=a.scrollHeight&&(-1!==b.indexOf(n)||-1!==b.indexOf(f)||-1!==b.indexOf(g)||
-1!==b.indexOf(w))||a.clientWidth<=a.scrollWidth&&(-1!==b.indexOf(c)||-1!==b.indexOf(f)||-1!==b.indexOf(g)||-1!==b.indexOf(d)))return a;a=a.parentNode}return window}function H(a){for(a=a.parentNode;a&&a.style&&document.body!==a;){if("visible"!==a.style.overflow&&""!==a.style.overflow)return a;if(window.getComputedStyle){var b=window.getComputedStyle(a);if("visible"!==b.getPropertyValue("overflow")&&""!==b.getPropertyValue("overflow"))return a}a=a.parentNode}return window}function M(a,b){if(a)if(a===
window){if("width"===b)return window.innerWidth+"px";if("height"===b)return window.innerHeight+"px"}else{var f=a.style[b];if(""!==f&&void 0!==f)return f;f=O(a);if(""!==f[b]&&void 0!==f[b])return f[b]}}function O(a){return a.currentStyle||document.defaultView.getComputedStyle(a)}function U(a){return a.offsetWidth}function D(a){return ca()&&a.firstChild&&"CAPTION"===a.firstChild.nodeName?a.offsetHeight+a.firstChild.offsetHeight:a.offsetHeight}function x(a){return a.clientHeight||a.innerHeight}function Z(a){return a.clientWidth||
a.innerWidth}function S(a,b,f){window.addEventListener?a.addEventListener(b,f,!1):a.attachEvent("on"+b,f)}function L(a,b,f){window.removeEventListener?a.removeEventListener(b,f,!1):a.detachEvent("on"+b,f)}function ca(){if(void 0===X){var a=document.createElement("TABLE");a.style.borderSpacing=0;a.style.borderWidth=0;a.style.padding=0;var b=document.createElement("TBODY");a.appendChild(b);b.appendChild(document.createElement("TR"));b.firstChild.appendChild(document.createElement("TD"));b.firstChild.firstChild.innerHTML=
"<tr><td>t<br>t</td></tr>";var f=document.createElement("CAPTION");f.innerHTML="c<br>c<br>c<br>c";f.style.padding=0;f.style.margin=0;a.insertBefore(f,b);document.body.appendChild(a);X=a.offsetHeight<2*a.lastChild.offsetHeight;document.body.removeChild(a)}return X}function E(a){if(a.selectionStart)return a.selectionStart;if(document.selection){a.focus();var b=document.selection.createRange();if(null==b)return 0;a=a.createTextRange();var f=a.duplicate();a.moveToBookmark(b.getBookmark());f.setEndPoint("EndToStart",
a);return f.text.length}return 0}function da(a){if(a.selectionEnd)return a.selectionEnd;if(document.selection){var b=document.selection.createRange();return null==b?0:a.createTextRange().text.indexOf(b.text)+b.text.length}}function u(a,b,f){void 0===f&&(f=b);a.setSelectionRange?(a.focus(),a.setSelectionRange(b,f)):a.createTextRange&&(a=a.createTextRange(),a.collapse(!0),a.moveEnd("character",f),a.moveStart("character",b),a.select())}function R(){if(void 0===va){var a=document.createElement("p");a.style.width=
"100%";a.style.height="200px";var b=document.createElement("div");b.style.position="absolute";b.style.top="0px";b.style.left="0px";b.style.visibility="hidden";b.style.width="200px";b.style.height="150px";b.style.overflow="hidden";b.appendChild(a);(document.body||document.documentElement).appendChild(b);var f=a.offsetWidth;b.style.overflow="scroll";a=a.offsetWidth;f==a&&(a=b.clientWidth);(document.body||document.documentElement).removeChild(b);va=f-a}return va}function K(){return K}function ea(){return Ma}
function Y(){return Na}function fa(a,b,f){Fa||Ma?(a.style.top=f,a.style.left=b):Na?a.style["-webkit-transform"]="translate3d("+b+","+f+",0)":a.style.transform="translate3d("+b+","+f+",0)"}function ga(a){var b;return a.style.transform&&""!==(b=a.style.transform)?["transform",b]:a.style["-webkit-transform"]&&""!==(b=a.style["-webkit-transform"])?["-webkit-transform",b]:-1}function J(a){a.transform&&""!==a.transform?a.transform="":a["-webkit-transform"]&&""!==a["-webkit-transform"]&&(a["-webkit-transform"]=
"")}Object.defineProperties(r,{enableImmediatePropagation:{get:function(){return a}},closest:{get:function(){return e}},isChildOf:{get:function(){return d}},isChildOfWebComponentTable:{get:function(){return k}},polymerWrap:{get:function(){return m}},polymerUnwrap:{get:function(){return c}},isWebComponentSupportedNatively:{get:function(){return b}},index:{get:function(){return p}},hasClass:{get:function(){return g}},addClass:{get:function(){return t}},removeClass:{get:function(){return v}},removeTextNodes:{get:function(){return f}},
empty:{get:function(){return n}},HTML_CHARACTERS:{get:function(){return ia}},fastInnerHTML:{get:function(){return w}},fastInnerText:{get:function(){return I}},isVisible:{get:function(){return N}},offset:{get:function(){return W}},getWindowScrollTop:{get:function(){return y}},getWindowScrollLeft:{get:function(){return F}},getScrollTop:{get:function(){return B}},getScrollLeft:{get:function(){return z}},getScrollableElement:{get:function(){return A}},getTrimmingContainer:{get:function(){return H}},getStyle:{get:function(){return M}},
getComputedStyle:{get:function(){return O}},outerWidth:{get:function(){return U}},outerHeight:{get:function(){return D}},innerHeight:{get:function(){return x}},innerWidth:{get:function(){return Z}},addEvent:{get:function(){return S}},removeEvent:{get:function(){return L}},hasCaptionProblem:{get:function(){return ca}},getCaretPosition:{get:function(){return E}},getSelectionEndPosition:{get:function(){return da}},setCaretPosition:{get:function(){return u}},getScrollbarWidth:{get:function(){return R}},
isIE8:{get:function(){return K}},isIE9:{get:function(){return ea}},isSafari:{get:function(){return Y}},setOverlayPosition:{get:function(){return fa}},getCssTransform:{get:function(){return ga}},resetCssTransform:{get:function(){return J}},__esModule:{value:!0}});var ba,oa,sa;if(document.documentElement.classList){var ra=function(){var a=document.createElement("div");a.classList.add("test","test2");return a.classList.contains("test2")}();ba=function(a,b){return""===b?!1:a.classList.contains(b)};oa=
function(a,b){var f=0;"string"===typeof b&&(b=b.split(" "));b=l(b);if(ra)a.classList.add.apply(a.classList,b);else for(;b&&b[f];)a.classList.add(b[f]),f++};sa=function(a,b){var f=0;"string"===typeof b&&(b=b.split(" "));b=l(b);if(ra)a.classList.remove.apply(a.classList,b);else for(;b&&b[f];)a.classList.remove(b[f]),f++}}else{var ha=function(a){return new RegExp("(\\s|^)"+a+"(\\s|$)")};ba=function(a,b){return a.className.match(ha(b))?!0:!1};oa=function(a,b){var f=0,c=a.className;"string"===typeof b&&
(b=b.split(" "));if(""===c)c=b.join(" ");else for(;b&&b[f];)ha(b[f]).test(c)||(c+=" "+b[f]),f++;a.className=c};sa=function(a,b){var f=0,c=a.className;for("string"===typeof b&&(b=b.split(" "));b&&b[f];)c=c.replace(ha(b[f])," ").trim(),f++;a.className!==c&&(a.className=c)}}var ia=/(<(.*)>|&(.*);)/,ja=document.createTextNode("test").textContent?!0:!1,X,va,Fa=!document.createTextNode("test").textContent,Ma=!!document.documentMode,Na=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);
window.Handsontable=window.Handsontable||{};Handsontable.Dom={addClass:t,addEvent:S,closest:e,empty:n,enableImmediatePropagation:a,fastInnerHTML:w,fastInnerText:I,getCaretPosition:E,getComputedStyle:O,getCssTransform:ga,getScrollableElement:A,getScrollbarWidth:R,getScrollLeft:z,getScrollTop:B,getStyle:M,getSelectionEndPosition:da,getTrimmingContainer:H,getWindowScrollLeft:F,getWindowScrollTop:y,hasCaptionProblem:ca,hasClass:g,HTML_CHARACTERS:ia,index:p,innerHeight:x,innerWidth:Z,isChildOf:d,isChildOfWebComponentTable:k,
isIE8:K,isIE9:ea,isSafari:Y,isVisible:N,isWebComponentSupportedNatively:b,offset:W,outerHeight:D,outerWidth:U,polymerUnwrap:c,polymerWrap:m,removeClass:v,removeEvent:L,removeTextNodes:f,resetCssTransform:J,setCaretPosition:u,setOverlayPosition:fa}},{}],28:[function(h,q,r){function a(a,d,v){function f(a){var b="function"===typeof d.settings.enterMoves?d.settings.enterMoves(event):d.settings.enterMoves;a?v.transformStart(-b.row,-b.col):v.transformStart(b.row,b.col,!0)}function n(n){var l,m;if(a.isListening()&&
(Handsontable.hooks.run(a,"beforeKeyDown",n),!k&&(p.enableImmediatePropagation(n),!n.isImmediatePropagationStopped()&&(d.lastKeyCode=n.keyCode,v.isSelected()))))if(l=(n.ctrlKey||n.metaKey)&&!n.altKey,!y||y.isWaiting()||b.isMetaKey(n.keyCode)||l||w.isEditorOpened())switch(m=n.shiftKey?v.setRangeEnd:v.setRangeStart,n.keyCode){case e.A:l&&(v.selectAll(),n.preventDefault(),b.stopPropagation(n));break;case e.ARROW_UP:w.isEditorOpened()&&y&&!y.isWaiting()&&w.closeEditorAndSaveChanges(l);n.shiftKey?v.transformEnd(-1,
0):v.transformStart(-1,0);n.preventDefault();b.stopPropagation(n);break;case e.ARROW_DOWN:w.isEditorOpened()&&y&&!y.isWaiting()&&w.closeEditorAndSaveChanges(l);n.shiftKey?v.transformEnd(1,0):v.transformStart(1,0);n.preventDefault();b.stopPropagation(n);break;case e.ARROW_RIGHT:w.isEditorOpened()&&y&&!y.isWaiting()&&w.closeEditorAndSaveChanges(l);n.shiftKey?v.transformEnd(0,1):v.transformStart(0,1);n.preventDefault();b.stopPropagation(n);break;case e.ARROW_LEFT:w.isEditorOpened()&&y&&!y.isWaiting()&&
w.closeEditorAndSaveChanges(l);n.shiftKey?v.transformEnd(0,-1):v.transformStart(0,-1);n.preventDefault();b.stopPropagation(n);break;case e.TAB:l="function"===typeof d.settings.tabMoves?d.settings.tabMoves(n):d.settings.tabMoves;n.shiftKey?v.transformStart(-l.row,-l.col):v.transformStart(l.row,l.col,!0);n.preventDefault();b.stopPropagation(n);break;case e.BACKSPACE:case e.DELETE:v.empty(n);w.prepareEditor();n.preventDefault();break;case e.F2:w.openEditor(null,n);n.preventDefault();break;case e.ENTER:w.isEditorOpened()?
(y&&y.state!==Handsontable.EditorState.WAITING&&w.closeEditorAndSaveChanges(l),f(n.shiftKey)):a.getSettings().enterBeginsEditing?w.openEditor(null,n):f(n.shiftKey);n.preventDefault();n.stopImmediatePropagation();break;case e.ESCAPE:w.isEditorOpened()&&w.closeEditorAndRestoreOriginalValue(l);n.preventDefault();break;case e.HOME:n.ctrlKey||n.metaKey?m(new c(0,d.selRange.from.col)):m(new c(d.selRange.from.row,0));n.preventDefault();b.stopPropagation(n);break;case e.END:n.ctrlKey||n.metaKey?m(new c(a.countRows()-
1,d.selRange.from.col)):m(new c(d.selRange.from.row,a.countCols()-1));n.preventDefault();b.stopPropagation(n);break;case e.PAGE_UP:v.transformStart(-a.countVisibleRows(),0);n.preventDefault();b.stopPropagation(n);break;case e.PAGE_DOWN:v.transformStart(a.countVisibleRows(),0),n.preventDefault(),b.stopPropagation(n)}else w.openEditor("",n)}var w=this,e=b.keyCode,k=!1,m,y;m=l(a);this.destroyEditor=function(a){this.closeEditor(a)};this.getActiveEditor=function(){return y};this.prepareEditor=function(){var b,
f,c,n,l,p,e;y&&y.isWaiting()?this.closeEditor(!1,!1,function(a){a&&w.prepareEditor()}):(b=d.selRange.highlight.row,f=d.selRange.highlight.col,c=a.colToProp(f),n=a.getCell(b,f),l=a.getDataAtCell(b,f),p=a.getCellMeta(b,f),(e=a.getCellEditor(p))?(y=Handsontable.editors.getEditor(e,a),y.prepare(b,f,c,n,l,p)):y=void 0)};this.isEditorOpened=function(){return y&&y.isOpened()};this.openEditor=function(a,c){y&&!y.cellProperties.readOnly?y.beginEditing(a,c):y&&y.cellProperties.readOnly&&c&&c.keyCode===b.keyCode.ENTER&&
f()};this.closeEditor=function(a,b,f){y?y.finishEditing(a,b,f):f&&f(!1)};this.closeEditorAndSaveChanges=function(a){return this.closeEditor(!1,a)};this.closeEditorAndRestoreOriginalValue=function(a){return this.closeEditor(!0,a)};(function(){a.addHook("afterDocumentKeyDown",n);m.addEventListener(document.documentElement,"keydown",function(b){a.runHooks("afterDocumentKeyDown",b)});a.view.wt.update("onCellDblClick",function(a,b,f){"TD"==f.nodeName&&w.openEditor()});a.addHook("afterDestroy",function(){k=
!0})})()}Object.defineProperties(r,{EditorManager:{get:function(){return a}},__esModule:{value:!0}});var e,d,k,m,c=(e=h("./3rdparty/walkontable/src/cell/coords.js"),e&&e.__esModule&&e||{default:e}).WalkontableCellCoords,b=(d=h("./helpers.js"),d&&d.__esModule&&d||{default:d}),p=(k=h("./dom.js"),k&&k.__esModule&&k||{default:k});h("./editors.js");var l=(m=h("./eventManager.js"),m&&m.__esModule&&m||{default:m}).eventManager;Handsontable.EditorManager=a},{"./3rdparty/walkontable/src/cell/coords.js":5,
"./dom.js":27,"./editors.js":29,"./eventManager.js":41,"./helpers.js":42}],29:[function(h,q,r){function a(a){var b;b={};this.getConstructor=function(){return a};this.getInstance=function(c){c.guid in b||(b[c.guid]=new a(c));return b[c.guid]}}function e(d,l){var g=new a(l);"string"===typeof d&&(c[d]=g);b.set(l,g)}function d(a,d){var g;if("function"==typeof a)b.get(a)||e(null,a),g=b.get(a);else if("string"==typeof a)g=c[a];else throw Error('Only strings and functions can be passed as "editor" parameter ');
if(!g)throw Error('No editor registered under name "'+a+'"');return g.getInstance(d)}function k(a){var b;if("string"==typeof a)b=c[a];else throw Error('Only strings and functions can be passed as "editor" parameter ');if(!b)throw Error('No editor registered under name "'+a+'"');return b.getConstructor()}function m(a){return c[a]?!0:!1}Object.defineProperties(r,{registerEditor:{get:function(){return e}},getEditor:{get:function(){return d}},hasEditor:{get:function(){return m}},getEditorConstructor:{get:function(){return k}},
__esModule:{value:!0}});h("./helpers.js");var c={},b=new WeakMap;Handsontable.editors=Handsontable.editors||{};Handsontable.editors.registerEditor=e;Handsontable.editors.getEditor=d},{"./helpers.js":42}],30:[function(h,q,r){function a(a){this.instance=a;this.state=Handsontable.EditorState.VIRGIN;this._opened=!1;this._closeCallback=null;this.init()}Object.defineProperties(r,{BaseEditor:{get:function(){return a}},__esModule:{value:!0}});var e,d,k=(e=h("./../helpers.js"),e&&e.__esModule&&e||{default:e}),
m=(d=h("./../3rdparty/walkontable/src/cell/coords.js"),d&&d.__esModule&&d||{default:d}).WalkontableCellCoords;Handsontable.editors=Handsontable.editors||{};Handsontable.editors.BaseEditor=a;Handsontable.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};a.prototype._fireCallbacks=function(a){this._closeCallback&&(this._closeCallback(a),this._closeCallback=null)};a.prototype.init=function(){};a.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented");
};a.prototype.setValue=function(a){throw Error("Editor setValue() method unimplemented");};a.prototype.open=function(){throw Error("Editor open() method unimplemented");};a.prototype.close=function(){throw Error("Editor close() method unimplemented");};a.prototype.prepare=function(a,b,d,l,g,t){this.TD=l;this.row=a;this.col=b;this.prop=d;this.originalValue=g;this.cellProperties=t;this.state=Handsontable.EditorState.VIRGIN};a.prototype.extend=function(){var a=this.constructor;return function(a,c){function d(){}
d.prototype=c.prototype;a.prototype=new d;return a.prototype.constructor=a}(function(){a.apply(this,arguments)},a)};a.prototype.saveValue=function(a,b){var d,l;b?(d=this.instance.getSelected(),d[0]>d[2]&&(l=d[0],d[0]=d[2],d[2]=l),d[1]>d[3]&&(l=d[1],d[1]=d[3],d[3]=l),this.instance.populateFromArray(d[0],d[1],a,d[2],d[3],"edit")):this.instance.populateFromArray(this.row,this.col,a,null,null,"edit")};a.prototype.beginEditing=function(a,b){this.state==Handsontable.EditorState.VIRGIN&&(this.instance.view.scrollViewport(new m(this.row,
this.col)),this.instance.view.render(),this.state=Handsontable.EditorState.EDITING,a="string"==typeof a?a:this.originalValue,this.setValue(k.stringify(a)),this.open(b),this._opened=!0,this.focus(),this.instance.view.render())};a.prototype.finishEditing=function(a,b,d){var l=this;if(d){var g=this._closeCallback;this._closeCallback=function(a){g&&g(a);d(a)}}this.isWaiting()||(this.state==Handsontable.EditorState.VIRGIN?this.instance._registerTimeout(setTimeout(function(){l._fireCallbacks(!0)},0)):this.state==
Handsontable.EditorState.EDITING&&(a?(this.cancelChanges(),this.instance.view.render()):(a=this.instance.getSettings().trimWhitespace?[["string"===typeof this.getValue()?String.prototype.trim.call(this.getValue()||""):this.getValue()]]:[[this.getValue()]],this.state=Handsontable.EditorState.WAITING,this.saveValue(a,b),this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(a){l.state=Handsontable.EditorState.FINISHED;l.discardEditor(a)}):(this.state=
Handsontable.EditorState.FINISHED,this.discardEditor(!0)))))};a.prototype.cancelChanges=function(){this.state=Handsontable.EditorState.FINISHED;this.discardEditor()};a.prototype.discardEditor=function(a){this.state===Handsontable.EditorState.FINISHED&&(!1===a&&!0!==this.cellProperties.allowInvalid?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=Handsontable.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this.state=Handsontable.EditorState.VIRGIN,this._fireCallbacks(!0)))};
a.prototype.isOpened=function(){return this._opened};a.prototype.isWaiting=function(){return this.state===Handsontable.EditorState.WAITING}},{"./../3rdparty/walkontable/src/cell/coords.js":5,"./../helpers.js":42}],31:[function(h,q,r){function a(a){g=!1;var b=this.getActiveEditor(),f=c.keyCode;if(c.isPrintableChar(a.keyCode)||a.keyCode===f.BACKSPACE||a.keyCode===f.DELETE||a.keyCode===f.INSERT){var n=0;if(a.keyCode!==f.C||!a.ctrlKey&&!a.metaKey)b.isOpened()||(n+=10),b.instance._registerTimeout(setTimeout(function(){b.queryChoices(b.TEXTAREA.value);
g=!0},n))}}Object.defineProperties(r,{AutocompleteEditor:{get:function(){return l}},__esModule:{value:!0}});var e,d,k,m,c=(e=h("./../helpers.js"),e&&e.__esModule&&e||{default:e}),b=(d=h("./../dom.js"),d&&d.__esModule&&d||{default:d});q=(k=h("./../editors.js"),k&&k.__esModule&&k||{default:k}).registerEditor;var p=(m=h("./handsontableEditor.js"),m&&m.__esModule&&m||{default:m}).HandsontableEditor,l=p.prototype.extend();Handsontable.editors=Handsontable.editors||{};Handsontable.editors.AutocompleteEditor=
l;l.prototype.init=function(){p.prototype.init.apply(this,arguments);this.query=null;this.choices=[]};l.prototype.createElements=function(){p.prototype.createElements.apply(this,arguments);b.addClass(this.htContainer,"autocompleteEditor");b.addClass(this.htContainer,-1!==window.navigator.platform.indexOf("Mac")?"htMacScroll":"")};var g=!1;l.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",a);p.prototype.prepare.apply(this,arguments)};l.prototype.open=function(){p.prototype.open.apply(this,
arguments);var a=this.htEditor.getInstance(),c=this;this.TEXTAREA.style.visibility="visible";this.focus();a.updateSettings({colWidths:[b.outerWidth(this.TEXTAREA)-2],width:b.outerWidth(this.TEXTAREA)+b.getScrollbarWidth()+2,afterRenderer:function(a,b,d,g,t){b=!0===this.getCellMeta(b,d).filteringCaseSensitive;if(t=Handsontable.helper.stringify(t))b=b?t.indexOf(this.query):t.toLowerCase().indexOf(c.query.toLowerCase()),-1!=b&&(b=t.substr(b,c.query.length),a.innerHTML=t.replace(b,"<strong>"+b+"</strong>"))}});
this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]=b.getScrollbarWidth()+2+"px";g&&(g=!1);c.instance._registerTimeout(setTimeout(function(){c.queryChoices(c.TEXTAREA.value)},0))};l.prototype.close=function(){p.prototype.close.apply(this,arguments)};l.prototype.queryChoices=function(a){this.query=a;if("function"==typeof this.cellProperties.source){var b=this;this.cellProperties.source(a,function(a){b.updateChoicesList(a)})}else if(Array.isArray(this.cellProperties.source)){var f;
if(a&&!1!==this.cellProperties.filter){var c=!0===this.cellProperties.filteringCaseSensitive,d=a.toLowerCase();f=this.cellProperties.source.filter(function(b){return c?-1!=b.indexOf(a):-1!=b.toLowerCase().indexOf(d)})}else f=this.cellProperties.source;this.updateChoicesList(f)}else this.updateChoicesList([])};l.prototype.updateChoicesList=function(a){var d=b.getCaretPosition(this.TEXTAREA),f=b.getSelectionEndPosition(this.TEXTAREA),n=l.sortByRelevance(this.getValue(),a,this.cellProperties.filteringCaseSensitive);
if(0!=this.cellProperties.filter){for(var g=[],e=0,p=n.length;e<p;e++)g.push(a[n[e]]);n=0;a=g}else n=n[0];this.choices=a;this.htEditor.loadData(c.pivot([a]));this.updateDropdownHeight();!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(n);this.instance.listen();this.TEXTAREA.focus();b.setCaretPosition(this.TEXTAREA,d,d!=f?f:void 0)};l.prototype.updateDropdownHeight=function(){this.htEditor.updateSettings({height:this.getDropdownHeight()});this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()};
l.prototype.finishEditing=function(b){b||this.instance.removeHook("beforeKeyDown",a);p.prototype.finishEditing.apply(this,arguments)};l.prototype.highlightBestMatchingChoice=function(a){"number"===typeof a?this.htEditor.selectCell(a,0):this.htEditor.deselectCell()};l.sortByRelevance=function(a,b,f){var c=[],d,g=a.length,l,e,p=[],k,m;if(0===g){k=0;for(m=b.length;k<m;k++)p.push(k);return p}k=0;for(m=b.length;k<m;k++)d=Handsontable.helper.stringify(b[k]),l=f?d.indexOf(a):d.toLowerCase().indexOf(a.toLowerCase()),
-1!=l&&(e=d.length-l-g,c.push({baseIndex:k,index:l,charsLeft:e,value:d}));c.sort(function(a,b){if(-1===b.index)return-1;if(-1===a.index)return 1;if(a.index<b.index)return-1;if(b.index<a.index)return 1;if(a.index===b.index)return a.charsLeft<b.charsLeft?-1:a.charsLeft>b.charsLeft?1:0});k=0;for(m=c.length;k<m;k++)p.push(c[k].baseIndex);return p};l.prototype.getDropdownHeight=function(){var a=this.htEditor.getInstance().getRowHeight(0)||23;return 10<=this.choices.length?10*a:this.choices.length*a+8};
q("autocomplete",l)},{"./../dom.js":27,"./../editors.js":29,"./../helpers.js":42,"./handsontableEditor.js":35}],32:[function(h,q,r){Object.defineProperties(r,{CheckboxEditor:{get:function(){return d}},__esModule:{value:!0}});var a,e;q=(a=h("./../editors.js"),a&&a.__esModule&&a||{default:a}).registerEditor;var d=(e=h("./_baseEditor.js"),e&&e.__esModule&&e||{default:e}).BaseEditor.prototype.extend();Handsontable.editors=Handsontable.editors||{};Handsontable.editors.CheckboxEditor=d;d.prototype.beginEditing=
function(){var a=this.TD.querySelector('input[type="checkbox"]');a&&a.click()};d.prototype.finishEditing=function(){};d.prototype.init=function(){};d.prototype.open=function(){};d.prototype.close=function(){};d.prototype.getValue=function(){};d.prototype.setValue=function(){};d.prototype.focus=function(){};q("checkbox",d)},{"./../editors.js":29,"./_baseEditor.js":30}],33:[function(h,q,r){Object.defineProperties(r,{DateEditor:{get:function(){return n}},__esModule:{value:!0}});var a,e,d,k,m,c,b,p=(a=
h("./../helpers.js"),a&&a.__esModule&&a||{default:a}),l=(e=h("./../dom.js"),e&&e.__esModule&&e||{default:e});q=(d=h("./../editors.js"),d&&d.__esModule&&d||{default:d}).registerEditor;var g=(k=h("./textEditor.js"),k&&k.__esModule&&k||{default:k}).TextEditor,t=(m=h("./../eventManager.js"),m&&m.__esModule&&m||{default:m}).eventManager,v=(c=h("moment"),c&&c.__esModule&&c||{default:c}).default,f=(b=h("pikaday"),b&&b.__esModule&&b||{default:b}).default,n=g.prototype.extend();Handsontable.editors=Handsontable.editors||
{};Handsontable.editors.DateEditor=n;n.prototype.init=function(){if("function"!==typeof v)throw Error("You need to include moment.js to your project.");if("function"!==typeof f)throw Error("You need to include Pikaday to your project.");g.prototype.init.apply(this,arguments);this.isCellEdited=!1;var a=this;this.instance.addHook("afterDestroy",function(){a.parentDestroyed=!0;a.destroyElements()})};n.prototype.createElements=function(){var a=this;g.prototype.createElements.apply(this,arguments);this.defaultDateFormat=
"DD/MM/YYYY";this.datePicker=document.createElement("DIV");this.datePickerStyle=this.datePicker.style;this.datePickerStyle.position="absolute";this.datePickerStyle.top=0;this.datePickerStyle.left=0;this.datePickerStyle.zIndex=9999;l.addClass(this.datePicker,"htDatepickerHolder");document.body.appendChild(this.datePicker);var b=this.TEXTAREA;this.$datePicker=new f({format:a.defaultDateFormat,field:b,trigger:b,container:a.datePicker,reposition:!1,bound:!1,onSelect:function(b){isNaN(b.getTime())||(b=
v(b).format(a.cellProperties.dateFormat||a.defaultDateFormat));a.setValue(b);a.hideDatepicker()},onClose:function(){a.parentDestroyed||a.finishEditing(!1)}});t(this).addEventListener(this.datePicker,"mousedown",function(a){p.stopPropagation(a)});this.hideDatepicker()};n.prototype.destroyElements=function(){this.$datePicker.destroy()};n.prototype.prepare=function(){this._opened=!1;g.prototype.prepare.apply(this,arguments)};n.prototype.open=function(a){g.prototype.open.call(this);this.showDatepicker(a)};
n.prototype.close=function(){var a=this;this._opened=!1;this.instance._registerTimeout(setTimeout(function(){a.instance.selection.refreshBorders()},0));g.prototype.close.apply(this,arguments)};n.prototype.finishEditing=function(a,b){if(a){var f=this.originalValue;void 0!==f&&this.setValue(f)}this.hideDatepicker();g.prototype.finishEditing.apply(this,arguments)};n.prototype.showDatepicker=function(a){var b=this.TD.getBoundingClientRect(),f=this.cellProperties.dateFormat||this.defaultDateFormat,c=this.$datePicker.config(),
n=this.instance.view.isMouseDown();a=a?p.isMetaKey(a.keyCode):!1;this.datePickerStyle.top=window.pageYOffset+b.top+l.outerHeight(this.TD)+"px";this.datePickerStyle.left=window.pageXOffset+b.left+"px";this.$datePicker._onInputFocus=function(){};c.format=f;this.originalValue?(b=this.originalValue,v(b,f,!0).isValid()&&this.$datePicker.setMoment(v(b,f),!0),a||n||this.setValue("")):this.cellProperties.defaultDate?(b=this.cellProperties.defaultDate,c.defaultDate=b,v(b,f,!0).isValid()&&this.$datePicker.setMoment(v(b,
f),!0),a||n||this.setValue("")):this.$datePicker.gotoToday();this.datePickerStyle.display="block";this.$datePicker.show()};n.prototype.hideDatepicker=function(){this.datePickerStyle.display="none";this.$datePicker.hide()};q("date",n)},{"./../dom.js":27,"./../editors.js":29,"./../eventManager.js":41,"./../helpers.js":42,"./textEditor.js":40,moment:"moment",pikaday:"pikaday"}],34:[function(h,q,r){Object.defineProperties(r,{DropdownEditor:{get:function(){return k}},__esModule:{value:!0}});var a,e;q=
(a=h("./../editors.js"),a&&a.__esModule&&a||{default:a}).registerEditor;var d=(e=h("./autocompleteEditor.js"),e&&e.__esModule&&e||{default:e}).AutocompleteEditor,k=d.prototype.extend();Handsontable.editors=Handsontable.editors||{};Handsontable.editors.DropdownEditor=k;k.prototype.prepare=function(){d.prototype.prepare.apply(this,arguments);this.cellProperties.filter=!1;this.cellProperties.strict=!0};q("dropdown",k)},{"./../editors.js":29,"./autocompleteEditor.js":31}],35:[function(h,q,r){Object.defineProperties(r,
{HandsontableEditor:{get:function(){return p}},__esModule:{value:!0}});var a,e,d,k,m=(a=h("./../helpers.js"),a&&a.__esModule&&a||{default:a}),c=(e=h("./../dom.js"),e&&e.__esModule&&e||{default:e});q=(d=h("./../editors.js"),d&&d.__esModule&&d||{default:d}).registerEditor;var b=(k=h("./textEditor.js"),k&&k.__esModule&&k||{default:k}).TextEditor,p=b.prototype.extend();Handsontable.editors=Handsontable.editors||{};Handsontable.editors.HandsontableEditor=p;p.prototype.createElements=function(){b.prototype.createElements.apply(this,
arguments);var a=document.createElement("DIV");a.className="handsontableEditor";this.TEXTAREA_PARENT.appendChild(a);this.htContainer=a;this.htEditor=new Handsontable(a);this.assignHooks()};p.prototype.prepare=function(a,c,d,f,n,w){b.prototype.prepare.apply(this,arguments);var l=this,e={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,cells:function(){return{readOnly:!0}},fillHandle:!1,afterOnCellMouseDown:function(){var a=this.getValue();void 0!==a&&l.setValue(a);l.instance.destroyEditor()}};
this.cellProperties.handsontable&&m.extend(e,w.handsontable);this.htEditor&&this.htEditor.destroy();this.htEditor=new Handsontable(this.htContainer,e)};var l=function(a){null!=a&&null==a.isImmediatePropagationEnabled&&(a.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1;this.cancelBubble=!0},a.isImmediatePropagationEnabled=!0,a.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled});if(!a.isImmediatePropagationStopped()){var b=this.getActiveEditor(),
c=b.htEditor.getInstance(),f;if(a.keyCode==m.keyCode.ARROW_DOWN)if(c.getSelected()){f=c.getSelected()[0];var n=c.countRows()-1;f=Math.min(n,f+1)}else f=0;else a.keyCode==m.keyCode.ARROW_UP&&c.getSelected()&&(f=c.getSelected()[0],--f);void 0!==f&&(0>f?c.deselectCell():c.selectCell(f,0),a.preventDefault(),a.stopImmediatePropagation(),b.instance.listen(),b.TEXTAREA.focus())}};p.prototype.open=function(){this.instance.addHook("beforeKeyDown",l);b.prototype.open.apply(this,arguments);this.htEditor.render();
this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible");c.setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length)};p.prototype.close=function(){this.instance.removeHook("beforeKeyDown",l);this.instance.listen();b.prototype.close.apply(this,arguments)};p.prototype.focus=function(){this.instance.listen();b.prototype.focus.apply(this,arguments)};p.prototype.beginEditing=function(a){var c=
this.instance.getSettings().onBeginEditing;c&&!1===c()||b.prototype.beginEditing.apply(this,arguments)};p.prototype.finishEditing=function(a,c){this.htEditor.isListening()&&this.instance.listen();if(this.htEditor.getSelected()){var d=this.htEditor.getInstance().getValue();void 0!==d&&this.setValue(d)}return b.prototype.finishEditing.apply(this,arguments)};p.prototype.assignHooks=function(){var a=this;this.instance.addHook("afterDestroy",function(){a.htEditor&&a.htEditor.destroy()})};q("handsontable",
p)},{"./../dom.js":27,"./../editors.js":29,"./../helpers.js":42,"./textEditor.js":40}],36:[function(h,q,r){Object.defineProperties(r,{MobileTextEditor:{get:function(){return l}},__esModule:{value:!0}});var a,e,d,k,m,c=(a=h("./../helpers.js"),a&&a.__esModule&&a||{default:a}),b=(e=h("./../dom.js"),e&&e.__esModule&&e||{default:e});q=(d=h("./../editors.js"),d&&d.__esModule&&d||{default:d}).registerEditor;d=(k=h("./_baseEditor.js"),k&&k.__esModule&&k||{default:k}).BaseEditor;var p=(m=h("./../eventManager.js"),
m&&m.__esModule&&m||{default:m}).eventManager,l=d.prototype.extend(),g={};Handsontable.editors=Handsontable.editors||{};Handsontable.editors.MobileTextEditor=l;l.prototype.valueChanged=function(){return this.initValue!=this.getValue()};l.prototype.init=function(){var a=this;this.eventManager=p(this.instance);this.createElements();this.bindEvents();this.instance.addHook("afterDestroy",function(){a.destroy()})};l.prototype.getValue=function(){return this.TEXTAREA.value};l.prototype.setValue=function(a){this.initValue=
a;this.TEXTAREA.value=a};l.prototype.createElements=function(){this.editorContainer=document.createElement("DIV");this.editorContainer.className="htMobileEditorContainer";this.cellPointer=document.createElement("DIV");this.cellPointer.className="cellPointer";this.moveHandle=document.createElement("DIV");this.moveHandle.className="moveHandle";this.inputPane=document.createElement("DIV");this.inputPane.className="inputs";this.positionControls=document.createElement("DIV");this.positionControls.className=
"positionControls";this.TEXTAREA=document.createElement("TEXTAREA");b.addClass(this.TEXTAREA,"handsontableInput");this.inputPane.appendChild(this.TEXTAREA);this.editorContainer.appendChild(this.cellPointer);this.editorContainer.appendChild(this.moveHandle);this.editorContainer.appendChild(this.inputPane);this.editorContainer.appendChild(this.positionControls);this.controls={};this.controls.leftButton=document.createElement("DIV");this.controls.leftButton.className="leftButton";this.controls.rightButton=
document.createElement("DIV");this.controls.rightButton.className="rightButton";this.controls.upButton=document.createElement("DIV");this.controls.upButton.className="upButton";this.controls.downButton=document.createElement("DIV");this.controls.downButton.className="downButton";for(var a in this.controls)this.controls.hasOwnProperty(a)&&this.positionControls.appendChild(this.controls[a]);document.body.appendChild(this.editorContainer)};l.prototype.onBeforeKeyDown=function(a){var d=this.getActiveEditor();
b.enableImmediatePropagation(a);if(a.target===d.TEXTAREA&&!a.isImmediatePropagationStopped()){var f=c.keyCode;switch(a.keyCode){case f.ENTER:d.close();a.preventDefault();break;case f.BACKSPACE:a.stopImmediatePropagation()}}};l.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown);b.addClass(this.editorContainer,"active");b.removeClass(this.cellPointer,"hidden");this.updateEditorPosition()};l.prototype.focus=function(){this.TEXTAREA.focus();b.setCaretPosition(this.TEXTAREA,
this.TEXTAREA.value.length)};l.prototype.close=function(){this.TEXTAREA.blur();this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown);b.removeClass(this.editorContainer,"active")};l.prototype.scrollToView=function(){var a=this.instance.getSelectedRange().highlight;this.instance.view.scrollViewport(a)};l.prototype.hideCellPointer=function(){b.hasClass(this.cellPointer,"hidden")||b.addClass(this.cellPointer,"hidden")};l.prototype.updateEditorPosition=function(a,c){if(a&&c)a=parseInt(a,10),c=
parseInt(c,10),this.editorContainer.style.top=c+"px",this.editorContainer.style.left=a+"px";else{var f=this.instance.getSelected(),f=this.instance.getCell(f[0],f[1]);g.cellPointer||(g.cellPointer={height:b.outerHeight(this.cellPointer),width:b.outerWidth(this.cellPointer)});g.editorContainer||(g.editorContainer={width:b.outerWidth(this.editorContainer)});if(void 0!==f){var n=this.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer==window?0:b.getScrollLeft(this.instance.view.wt.wtOverlays.leftOverlay.holder),
d=this.instance.view.wt.wtOverlays.topOverlay.trimmingContainer==window?0:b.getScrollTop(this.instance.view.wt.wtOverlays.topOverlay.holder),l=b.offset(f),e=b.outerWidth(f);this.editorContainer.style.top=parseInt(l.top+b.outerHeight(f)-d+g.cellPointer.height,10)+"px";this.editorContainer.style.left=parseInt(window.innerWidth/2-g.editorContainer.width/2,10)+"px";l.left+e/2>parseInt(this.editorContainer.style.left,10)+g.editorContainer.width?this.editorContainer.style.left=window.innerWidth-g.editorContainer.width+
"px":l.left+e/2<parseInt(this.editorContainer.style.left,10)+20&&(this.editorContainer.style.left="0px");this.cellPointer.style.left=parseInt(l.left-g.cellPointer.width/2-b.offset(this.editorContainer).left+e/2-n,10)+"px"}}};l.prototype.updateEditorData=function(){var a=this.instance.getSelected(),b=this.instance.getDataAtCell(a[0],a[1]);this.row=a[0];this.col=a[1];this.setValue(b);this.updateEditorPosition()};l.prototype.prepareAndSave=function(){var a;if(!this.valueChanged())return!0;a=this.instance.getSettings().trimWhitespace?
[[String.prototype.trim.call(this.getValue())]]:[[this.getValue()]];this.saveValue(a)};l.prototype.bindEvents=function(){var a=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(b){a.prepareAndSave();a.instance.selection.transformStart(0,-1,null,!0);a.updateEditorData();b.preventDefault()});this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(b){a.prepareAndSave();a.instance.selection.transformStart(0,1,null,!0);a.updateEditorData();b.preventDefault()});
this.eventManager.addEventListener(this.controls.upButton,"touchend",function(b){a.prepareAndSave();a.instance.selection.transformStart(-1,0,null,!0);a.updateEditorData();b.preventDefault()});this.eventManager.addEventListener(this.controls.downButton,"touchend",function(b){a.prepareAndSave();a.instance.selection.transformStart(1,0,null,!0);a.updateEditorData();b.preventDefault()});this.eventManager.addEventListener(this.moveHandle,"touchstart",function(b){if(1==b.touches.length){b=b.touches[0];var f=
b.pageX-a.editorContainer.offsetLeft,c=b.pageY-a.editorContainer.offsetTop;a.eventManager.addEventListener(this,"touchmove",function(b){var d=b.touches[0];a.updateEditorPosition(d.pageX-f,d.pageY-c);a.hideCellPointer();b.preventDefault()})}});this.eventManager.addEventListener(document.body,"touchend",function(c){b.isChildOf(c.target,a.editorContainer)||b.isChildOf(c.target,a.instance.rootElement)||a.close()});this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.leftOverlay.holder,
"scroll",function(b){a.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer!=window&&a.hideCellPointer()});this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.topOverlay.holder,"scroll",function(b){a.instance.view.wt.wtOverlays.topOverlay.trimmingContainer!=window&&a.hideCellPointer()})};l.prototype.destroy=function(){this.eventManager.clear();this.editorContainer.parentNode.removeChild(this.editorContainer)};q("mobile",l)},{"./../dom.js":27,"./../editors.js":29,"./../eventManager.js":41,
"./../helpers.js":42,"./_baseEditor.js":30}],37:[function(h,q,r){Object.defineProperties(r,{NumericEditor:{get:function(){return c}},__esModule:{value:!0}});var a,e,d,k=(a=h("numeral"),a&&a.__esModule&&a||{default:a}).default;q=(e=h("./../editors.js"),e&&e.__esModule&&e||{default:e}).registerEditor;var m=(d=h("./textEditor.js"),d&&d.__esModule&&d||{default:d}).TextEditor,c=m.prototype.extend();Handsontable.editors=Handsontable.editors||{};Handsontable.editors.NumericEditor=c;c.prototype.beginEditing=
function(a){var c=m.prototype;if("undefined"===typeof a&&this.originalValue){var d=""+this.originalValue;"undefined"!==typeof this.cellProperties.language&&k.language(this.cellProperties.language);var g=k.languageData().delimiters.decimal,d=d.replace(".",g);c.beginEditing.apply(this,[d])}else c.beginEditing.apply(this,arguments)};q("numeric",c)},{"./../editors.js":29,"./textEditor.js":40,numeral:"numeral"}],38:[function(h,q,r){Object.defineProperties(r,{PasswordEditor:{get:function(){return c}},__esModule:{value:!0}});
var a,e,d,k=(a=h("./../dom.js"),a&&a.__esModule&&a||{default:a});q=(e=h("./../editors.js"),e&&e.__esModule&&e||{default:e}).registerEditor;var m=(d=h("./textEditor.js"),d&&d.__esModule&&d||{default:d}).TextEditor,c=m.prototype.extend();Handsontable.editors=Handsontable.editors||{};Handsontable.editors.PasswordEditor=c;c.prototype.createElements=function(){m.prototype.createElements.apply(this,arguments);this.TEXTAREA=document.createElement("input");this.TEXTAREA.setAttribute("type","password");this.TEXTAREA.className=
"handsontableInput";this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;k.empty(this.TEXTAREA_PARENT);this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)};q("password",c)},{"./../dom.js":27,"./../editors.js":29,"./textEditor.js":40}],39:[function(h,q,r){Object.defineProperties(r,{SelectEditor:{get:function(){return p}},__esModule:{value:!0}});var a,e,d,k,m=(a=h("./../dom.js"),a&&a.__esModule&&a||{default:a}),c=(e=h("./../helpers.js"),e&&e.__esModule&&e||{default:e});
q=(d=h("./../editors.js"),d&&d.__esModule&&d||{default:d}).registerEditor;var b=(k=h("./_baseEditor.js"),k&&k.__esModule&&k||{default:k}).BaseEditor,p=b.prototype.extend();Handsontable.editors=Handsontable.editors||{};Handsontable.editors.SelectEditor=p;p.prototype.init=function(){this.select=document.createElement("SELECT");m.addClass(this.select,"htSelectEditor");this.select.style.display="none";this.instance.rootElement.appendChild(this.select)};p.prototype.prepare=function(){b.prototype.prepare.apply(this,
arguments);var a=this.cellProperties.selectOptions,a="function"==typeof a?this.prepareOptions(a(this.row,this.col,this.prop)):this.prepareOptions(a);m.empty(this.select);for(var c in a)if(a.hasOwnProperty(c)){var d=document.createElement("OPTION");d.value=c;m.fastInnerHTML(d,a[c]);this.select.appendChild(d)}};p.prototype.prepareOptions=function(a){var b={};if(Array.isArray(a))for(var c=0,f=a.length;c<f;c++)b[a[c]]=a[c];else"object"==typeof a&&(b=a);return b};p.prototype.getValue=function(){return this.select.value};
p.prototype.setValue=function(a){this.select.value=a};var l=function(a){var b=this.getActiveEditor();null!=a&&null==a.isImmediatePropagationEnabled&&(a.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1},a.isImmediatePropagationEnabled=!0,a.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled});switch(a.keyCode){case c.keyCode.ARROW_UP:var d=b.select.selectedIndex-1;0<=d&&(b.select[d].selected=!0);a.stopImmediatePropagation();a.preventDefault();
break;case c.keyCode.ARROW_DOWN:d=b.select.selectedIndex+1,d<=b.select.length-1&&(b.select[d].selected=!0),a.stopImmediatePropagation(),a.preventDefault()}};p.prototype.checkEditorSection=function(){if(this.row<this.instance.getSettings().fixedRowsTop)return this.col<this.instance.getSettings().fixedColumnsLeft?"corner":"top";if(this.col<this.instance.getSettings().fixedColumnsLeft)return"left"};p.prototype.open=function(){var a=m.outerWidth(this.TD),b=m.outerHeight(this.TD),c=m.offset(this.instance.rootElement),
f=m.offset(this.TD),d;switch(this.checkEditorSection()){case "top":d=m.getCssTransform(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case "left":d=m.getCssTransform(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case "corner":d=m.getCssTransform(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode)}var w=this.select.style;d&&-1!=d?w[d[0]]=d[1]:m.resetCssTransform(this.select);w.height=b+"px";
w.minWidth=a+"px";w.top=f.top-c.top+"px";w.left=f.left-c.left+"px";w.margin="0px";w.display="";this.instance.addHook("beforeKeyDown",l)};p.prototype.close=function(){this.select.style.display="none";this.instance.removeHook("beforeKeyDown",l)};p.prototype.focus=function(){this.select.focus()};q("select",p)},{"./../dom.js":27,"./../editors.js":29,"./../helpers.js":42,"./_baseEditor.js":30}],40:[function(h,q,r){Object.defineProperties(r,{TextEditor:{get:function(){return t}},__esModule:{value:!0}});
var a,e,d,k,m,c,b=(a=h("./../dom.js"),a&&a.__esModule&&a||{default:a}),p=(e=h("./../helpers.js"),e&&e.__esModule&&e||{default:e}),l=(d=h("autoResize"),d&&d.__esModule&&d||{default:d}).default;q=(k=h("./_baseEditor.js"),k&&k.__esModule&&k||{default:k}).BaseEditor;var g=(m=h("./../eventManager.js"),m&&m.__esModule&&m||{default:m}).eventManager;h=(c=h("./../editors.js"),c&&c.__esModule&&c||{default:c}).registerEditor;var t=q.prototype.extend();Handsontable.editors=Handsontable.editors||{};Handsontable.editors.TextEditor=
t;t.prototype.init=function(){var a=this;this.createElements();this.eventManager=g(this);this.bindEvents();this.autoResize=l();this.instance.addHook("afterDestroy",function(){a.destroy()})};t.prototype.getValue=function(){return this.TEXTAREA.value};t.prototype.setValue=function(a){this.TEXTAREA.value=a};var v=function(a){var c=this.getActiveEditor(),d,g;d=p.keyCode;g=(a.ctrlKey||a.metaKey)&&!a.altKey;b.enableImmediatePropagation(a);if(a.target===c.TEXTAREA&&!a.isImmediatePropagationStopped())if(17===
a.keyCode||224===a.keyCode||91===a.keyCode||93===a.keyCode)a.stopImmediatePropagation();else{switch(a.keyCode){case d.ARROW_RIGHT:b.getCaretPosition(c.TEXTAREA)!==c.TEXTAREA.value.length&&a.stopImmediatePropagation();break;case d.ARROW_LEFT:0!==b.getCaretPosition(c.TEXTAREA)&&a.stopImmediatePropagation();break;case d.ENTER:d=c.instance.getSelected();d=!(d[0]===d[2]&&d[1]===d[3]);if(g&&!d||a.altKey)c.isOpened()?(g=b.getCaretPosition(c.TEXTAREA),d=c.getValue(),d=d.slice(0,g)+"\n"+d.slice(g),c.setValue(d),
b.setCaretPosition(c.TEXTAREA,g+1)):c.beginEditing(c.originalValue+"\n"),a.stopImmediatePropagation();a.preventDefault();break;case d.A:case d.X:case d.C:case d.V:g&&a.stopImmediatePropagation();break;case d.BACKSPACE:case d.DELETE:case d.HOME:case d.END:a.stopImmediatePropagation()}c.autoResize.resize(String.fromCharCode(a.keyCode))}};t.prototype.open=function(){this.refreshDimensions();this.instance.addHook("beforeKeyDown",v)};t.prototype.close=function(){this.textareaParentStyle.display="none";
this.autoResize.unObserve();document.activeElement===this.TEXTAREA&&this.instance.listen();this.instance.removeHook("beforeKeyDown",v)};t.prototype.focus=function(){this.TEXTAREA.focus();b.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)};t.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA");b.addClass(this.TEXTAREA,"handsontableInput");this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.TEXTAREA_PARENT=document.createElement("DIV");
b.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder");this.textareaParentStyle=this.TEXTAREA_PARENT.style;this.textareaParentStyle.top=0;this.textareaParentStyle.left=0;this.textareaParentStyle.display="none";this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var a=this;this.instance._registerTimeout(setTimeout(function(){a.refreshDimensions()},0))};t.prototype.checkEditorSection=function(){if(this.row<this.instance.getSettings().fixedRowsTop)return this.col<
this.instance.getSettings().fixedColumnsLeft?"corner":"top";if(this.col<this.instance.getSettings().fixedColumnsLeft)return"left"};t.prototype.getEditedCell=function(){var a;switch(this.checkEditorSection()){case "top":a=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=101;break;case "corner":a=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=
103;break;case "left":a=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=102;break;default:a=this.instance.getCell(this.row,this.col),this.textareaParentStyle.zIndex=""}return-1!=a&&-2!=a?a:void 0};t.prototype.refreshDimensions=function(){if(this.state===Handsontable.EditorState.EDITING&&(this.TD=this.getEditedCell())){var a=b.offset(this.TD),c=b.offset(this.instance.rootElement),d=b.getScrollableElement(this.TD),g=a.top-
c.top-1-(d.scrollTop||0),d=a.left-c.left-1-(d.scrollLeft||0),c=this.instance.getSettings(),a=c.rowHeaders?1:0,l=c.colHeaders?1:0,e=this.checkEditorSection(),c=this.TD.style.backgroundColor,p;switch(e){case "top":p=b.getCssTransform(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case "left":p=b.getCssTransform(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case "corner":p=b.getCssTransform(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode)}0>
g&&(g=0);0>d&&(d=0);l&&0===this.instance.getSelected()[0]&&(g+=1);a&&0===this.instance.getSelected()[1]&&(d+=1);p&&-1!=p?this.textareaParentStyle[p[0]]=p[1]:b.resetCssTransform(this.textareaParentStyle);this.textareaParentStyle.top=g+"px";this.textareaParentStyle.left=d+"px";p=this.TD.offsetTop-this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition();d=this.TD.offsetLeft-this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition();g=b.innerWidth(this.TD)-8;d=this.instance.view.maximumVisibleElementWidth(d)-
10;l=this.TD.scrollHeight+1;p=this.instance.view.maximumVisibleElementHeight(p)-2;0<parseInt(this.TD.style.borderTopWidth,10)&&--l;0<parseInt(this.TD.style.borderLeftWidth,10)&&0<a&&--g;this.TEXTAREA.style.fontSize=b.getComputedStyle(this.TD).fontSize;this.TEXTAREA.style.fontFamily=b.getComputedStyle(this.TD).fontFamily;this.TEXTAREA.style.backgroundColor="";this.TEXTAREA.style.backgroundColor=c?c:b.getComputedStyle(this.TEXTAREA).backgroundColor;this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(l,
p),maxHeight:p,minWidth:Math.min(g,d),maxWidth:d},!0);this.textareaParentStyle.display="block"}};t.prototype.bindEvents=function(){var a=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(a){p.stopPropagation(a)});this.eventManager.addEventListener(this.TEXTAREA,"paste",function(a){p.stopPropagation(a)});this.instance.addHook("afterScrollVertically",function(){a.refreshDimensions()});this.instance.addHook("afterColumnResize",function(){a.refreshDimensions();a.focus()});this.instance.addHook("afterRowResize",
function(){a.refreshDimensions();a.focus()});this.instance.addHook("afterDestroy",function(){a.eventManager.clear()})};t.prototype.destroy=function(){this.eventManager.clear()};h("text",t)},{"./../dom.js":27,"./../editors.js":29,"./../eventManager.js":41,"./../helpers.js":42,"./_baseEditor.js":30,autoResize:"autoResize"}],41:[function(h,q,r){function a(a,b){var d,l,g,e;b.isTargetWebComponent=!1;b.realTarget=b.target;if(!Handsontable.eventManager.isHotTableEnv)return b;b=k.polymerWrap(b);for(e=b.path?
b.path.length:0;e--;){if("HOT-TABLE"===b.path[e].nodeName)d=!0;else if(d&&b.path[e].shadowRoot){g=b.path[e];break}0!==e||g||(g=b.path[e])}g||(g=b.target);b.isTargetWebComponent=!0;if(k.isWebComponentSupportedNatively())b.realTarget=b.srcElement||b.toElement;else if(a instanceof Handsontable.Core||a instanceof Walkontable)a instanceof Handsontable.Core?l=a.view.wt.wtTable.TABLE:a instanceof Walkontable&&(l=a.wtTable.TABLE.parentNode.parentNode),d=k.closest(b.target,["HOT-TABLE"],l),b.realTarget=d?
l.querySelector("HOT-TABLE")||b.target:b.target;Object.defineProperty(b,"target",{get:function(){return k.polymerWrap(g)},enumerable:!0,configurable:!0});return b}function e(a){return new m(a)}Object.defineProperties(r,{EventManager:{get:function(){return m}},eventManager:{get:function(){return e}},__esModule:{value:!0}});var d,k=(d=h("./dom.js"),d&&d.__esModule&&d||{default:d}),m=function(a){this.context=(void 0!==a?a:null)||this;this.context.eventListeners||(this.context.eventListeners=[])};$traceurRuntime.createClass(m,
{addEventListener:function(c,b,d){function l(b){void 0==b.target&&void 0!=b.srcElement&&(b.definePoperty?b.definePoperty("target",{value:b.srcElement}):b.target=b.srcElement);void 0==b.preventDefault&&(b.definePoperty?b.definePoperty("preventDefault",{value:function(){this.returnValue=!1}}):b.preventDefault=function(){this.returnValue=!1});b=a(e,b);d.call(this,b)}var g=this,e=this.context;this.context.eventListeners.push({element:c,event:b,callback:d,callbackProxy:l});window.addEventListener?c.addEventListener(b,
l,!1):c.attachEvent("on"+b,l);Handsontable.countEventManagerListeners++;return function(){g.removeEventListener(c,b,d)}},removeEventListener:function(a,b,d){for(var l=this.context.eventListeners.length,g;l--;)g=this.context.eventListeners[l],g.event!=b||g.element!=a||d&&d!=g.callback||(this.context.eventListeners.splice(l,1),g.element.removeEventListener?g.element.removeEventListener(g.event,g.callbackProxy,!1):g.element.detachEvent("on"+g.event,g.callbackProxy),Handsontable.countEventManagerListeners--)},
clearEvents:function(){for(var a=this.context.eventListeners.length;a--;){var b=this.context.eventListeners[a];b&&this.removeEventListener(b.element,b.event,b.callback)}},clear:function(){this.clearEvents()},fireEvent:function(a,b){var d="mousemove"!==b,l=window,g;document.createEvent?(g=document.createEvent("MouseEvents"),g.initMouseEvent(b,!0,d,l,0,0,0,1,1,!1,!1,!1,!1,0,document.body.parentNode)):g=document.createEventObject();a.dispatchEvent?a.dispatchEvent(g):a.fireEvent("on"+b,g)}},{});window.Handsontable=
window.Handsontable||{};Handsontable.countEventManagerListeners=0;Handsontable.eventManager=e},{"./dom.js":27}],42:[function(h,q,r){function a(a){return 32==a||48<=a&&57>=a||96<=a&&111>=a||186<=a&&192>=a||219<=a&&222>=a||226<=a||65<=a&&90>=a}function e(a){return-1!=[K.ARROW_DOWN,K.ARROW_UP,K.ARROW_LEFT,K.ARROW_RIGHT,K.HOME,K.END,K.DELETE,K.BACKSPACE,K.F1,K.F2,K.F3,K.F4,K.F5,K.F6,K.F7,K.F8,K.F9,K.F10,K.F11,K.F12,K.TAB,K.PAGE_DOWN,K.PAGE_UP,K.ENTER,K.ESCAPE,K.SHIFT,K.CAPS_LOCK,K.ALT].indexOf(a)}function d(a){return-1!=
[K.CONTROL_LEFT,224,K.COMMAND_LEFT,K.COMMAND_RIGHT].indexOf(a)}function k(a){switch(typeof a){case "string":case "number":return a+"";case "object":return null===a?"":a.toString();case "undefined":return"";default:return a.toString()}}function m(a){return a[0].toUpperCase()+a.substr(1)}function c(a){var b;if(Array.isArray(a))b=[];else{b={};for(var f in a)a.hasOwnProperty(f)&&(a[f]&&"object"===typeof a[f]&&!Array.isArray(a[f])?b[f]=c(a[f]):Array.isArray(a[f])?a[f].length&&"object"===typeof a[f][0]&&
!Array.isArray(a[f][0])?b[f]=[c(a[f][0])]:b[f]=[]:b[f]=null)}return b}function b(a){a+=1;for(var b="",f;0<a;)f=(a-1)%26,b=String.fromCharCode(65+f)+b,a=parseInt((a-f)/26,10);return b}function p(a,f){a="number"===typeof a?a:100;f="number"===typeof f?f:4;var c=[],d,n;for(d=0;d<a;d++){var g=[];for(n=0;n<f;n++)g.push(b(n)+(d+1));c.push(g)}return c}function l(a,f){a="number"===typeof a?a:100;f="number"===typeof f?f:4;var c=[],d,n;for(d=0;d<a;d++){var g={};for(n=0;n<f;n++)g["prop"+n]=b(n)+(d+1);c.push(g)}return c}
function g(a){var b=typeof a;return"number"==b?!isNaN(a)&&isFinite(a):"string"==b?a.length?1==a.length?/\d/.test(a):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(a):!1:"object"==b?!!a&&"number"==typeof a.valueOf()&&!(a instanceof Date):!1}function t(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+a()+a()}function v(a,b){b.prototype.constructor=b;a.prototype=new b;return a.prototype.constructor=a}function f(a,b){for(var f in b)b.hasOwnProperty(f)&&
(a[f]=b[f])}function n(a,b){for(var f in b)b.hasOwnProperty(f)&&(b[f]&&"object"===typeof b[f]?(a[f]||(Array.isArray(b[f])?a[f]=[]:a[f]={}),n(a[f],b[f])):a[f]=b[f])}function w(a){return"object"===typeof a?JSON.parse(JSON.stringify(a)):a}function I(a,b){return JSON.stringify(a)===JSON.stringify(b)}function N(a){if("object"==typeof a.__proto__)a=a.__proto__;else{var b,f=a.constructor;"function"==typeof a.constructor&&(b=f,delete a.constructor&&(f=a.constructor,a.constructor=b));a=f?f.prototype:null}return a}
function W(a,b){function f(){}v(f,a);for(var c=0,d=b.length;c<d;c++)f.prototype[b[c]]=void 0;return f}function y(a){var b,f,c,d,n=[],g=0;b=0;for(f=a.length;b<f;b++)for(c=0,d=a[b].length;c<d;c++)c==g&&(n.push([]),g++),n[c].push(a[b][c]);return n}function F(a){for(var b=0,f=a.length;b<f;)a[b]=[a[b]],b++}function B(a,b){for(var f=0,c=b.length;f<c;)a.push(b[f]),f++}function z(a){return-1<["INPUT","SELECT","TEXTAREA"].indexOf(a.nodeName)||"true"===a.contentEditable}function A(a){return z(a)&&-1==a.className.indexOf("handsontableInput")}
function H(a){return"[object Object]"==Object.prototype.toString.call(a)}function M(a){var b=[];if(!a||0===a.length||!a[0]||0===a[0].length)return b;for(var f=a.length,c=a[0].length,d=0;d<f;d++)for(var n=0;n<c;n++)b[n]||(b[n]=[]),b[n][d]=a[d][n];return b}function O(a,b){return function(){return a.apply(b,arguments)}}function U(a,b){b="undefined"==typeof b?!0:b;return function(f,c){return function ra(f){if(f){if(f.hasOwnProperty(a)&&void 0!==f[a])return f[a];if(f.hasOwnProperty("type")&&f.type){if("string"!=
typeof f.type)throw Error("Cell type must be a string ");var c=f.type,d=Handsontable.cellTypes[c];if("undefined"==typeof d)throw Error('You declared cell type "'+c+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');if(d.hasOwnProperty(a))return d[a];if(b)return}return ra(N(f))}}("number"==typeof f?this.getCellMeta(f,c):f)}}function D(a){a||(a=navigator.userAgent);return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(a)}
function x(){return"ontouchstart"in window}function Z(a){"function"===typeof a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function S(a){if(a.pageX)return a.pageX;var b=R.getWindowScrollLeft();return a.clientX+b}function L(a){if(a.pageY)return a.pageY;var b=R.getWindowScrollTop();return a.clientY+b}function ca(a,b,f,c){c.value=f;c.writable=!1===c.writable?!1:!0;c.enumerable=!1===c.enumerable?!1:!0;c.configurable=!1===c.configurable?!1:!0;Object.defineProperty(a,b,c)}function E(a){return Y.call(window,
a)}function da(a){fa.call(window,a)}Object.defineProperties(r,{isPrintableChar:{get:function(){return a}},isMetaKey:{get:function(){return e}},isCtrlKey:{get:function(){return d}},stringify:{get:function(){return k}},toUpperCaseFirst:{get:function(){return m}},duckSchema:{get:function(){return c}},spreadsheetColumnLabel:{get:function(){return b}},createSpreadsheetData:{get:function(){return p}},createSpreadsheetObjectData:{get:function(){return l}},isNumeric:{get:function(){return g}},randomString:{get:function(){return t}},
inherit:{get:function(){return v}},extend:{get:function(){return f}},deepExtend:{get:function(){return n}},deepClone:{get:function(){return w}},isObjectEquals:{get:function(){return I}},getPrototypeOf:{get:function(){return N}},columnFactory:{get:function(){return W}},translateRowsToColumns:{get:function(){return y}},to2dArray:{get:function(){return F}},extendArray:{get:function(){return B}},isInput:{get:function(){return z}},isOutsideInput:{get:function(){return A}},keyCode:{get:function(){return K}},
isObject:{get:function(){return H}},pivot:{get:function(){return M}},proxy:{get:function(){return O}},cellMethodLookupFactory:{get:function(){return U}},isMobileBrowser:{get:function(){return D}},isTouchSupported:{get:function(){return x}},stopPropagation:{get:function(){return Z}},pageX:{get:function(){return S}},pageY:{get:function(){return L}},defineGetter:{get:function(){return ca}},requestAnimationFrame:{get:function(){return E}},cancelAnimationFrame:{get:function(){return da}},__esModule:{value:!0}});
var u,R=(u=h("./dom.js"),u&&u.__esModule&&u||{default:u}),K={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86},ea=0;h=["ms","moz","webkit","o"];
var Y=window.requestAnimationFrame,fa=window.cancelAnimationFrame;for(q=0;q<h.length&&!Y;++q)Y=window[h[q]+"RequestAnimationFrame"],fa=window[h[q]+"CancelAnimationFrame"]||window[h[q]+"CancelRequestAnimationFrame"];Y||(Y=function(a){var b=(new Date).getTime(),f=Math.max(0,16-(b-ea)),c=window.setTimeout(function(){a(b+f)},f);ea=b+f;return c});fa||(fa=function(a){clearTimeout(a)});window.Handsontable=window.Handsontable||{};Handsontable.helper={cancelAnimationFrame:da,cellMethodLookupFactory:U,columnFactory:W,
createSpreadsheetData:p,createSpreadsheetObjectData:l,duckSchema:c,deepClone:w,deepExtend:n,defineGetter:ca,extend:f,extendArray:B,getPrototypeOf:N,inherit:v,isCtrlKey:d,isInput:z,isMetaKey:e,isMobileBrowser:D,isNumeric:g,isObject:H,isObjectEquals:I,isOutsideInput:A,isPrintableChar:a,isTouchSupported:x,keyCode:K,pageX:S,pageY:L,pivot:M,proxy:O,randomString:t,requestAnimationFrame:E,spreadsheetColumnLabel:b,stopPropagation:Z,stringify:k,to2dArray:F,toUpperCaseFirst:m,translateRowsToColumns:y}},{"./dom.js":27}],
43:[function(h,q,r){function a(){function a(c){return null!==c&&c===c&&("string"==typeof c||"number"==typeof c)}function d(a){return null!==a&&("object"==typeof a||"function"==typeof a)}var k=[],m=new WeakMap;return{get:function(c){if(a(c))return k[c];if(d(c))return m.get(c)},set:function(c,b){if(a(c))k[c]=b;else if(d(c))m.set(c,b);else throw Error("Invalid key type");},"delete":function(c){if(a(c))delete k[c];else if(d(c))m["delete"](c)}}}Object.defineProperties(r,{MultiMap:{get:function(){return a}},
__esModule:{value:!0}});window.MultiMap=a},{}],44:[function(h,q,r){Object.defineProperties(r,{Hooks:{get:function(){return e}},__esModule:{value:!0}});var a="afterCellMetaReset afterChange afterChangesObserved afterColumnMove afterColumnResize afterContextMenuDefaultOptions afterContextMenuHide afterContextMenuShow afterCopyLimit afterCreateCol afterCreateRow afterDeselect afterDestroy afterDocumentKeyDown afterGetCellMeta afterGetColHeader afterGetRowHeader afterInit afterIsMultipleSelectionCheck afterLoadData afterMomentumScroll afterOnCellCornerMouseDown afterOnCellMouseDown afterOnCellMouseOver afterRemoveCol afterRemoveRow afterRender afterRenderer afterRowMove afterRowResize afterScrollHorizontally afterScrollVertically afterSelection afterSelectionByProp afterSelectionEnd afterSelectionEndByProp afterSetCellMeta afterUpdateSettings afterValidate beforeAutofill beforeCellAlignment beforeChange beforeChangeRender beforeDrawBorders beforeGetCellMeta beforeInit beforeInitWalkontable beforeKeyDown beforeOnCellMouseDown beforeRemoveCol beforeRemoveRow beforeRender beforeSetRangeEnd beforeTouchScroll beforeValidate modifyCol modifyColWidth modifyRow modifyRowHeight persistentStateLoad persistentStateReset persistentStateSave".split(" ");
h("./eventManager.js");var e=function(){this.globalBucket=this.createEmptyBucket()};$traceurRuntime.createClass(e,{createEmptyBucket:function(){for(var d=Object.create(null),e=0,m=a.length;e<m;e++)d[a[e]]=[];return d},getBucket:function(a){return(a=void 0!==a?a:null)?(a.pluginHookBucket||(a.pluginHookBucket=this.createEmptyBucket()),a.pluginHookBucket):this.globalBucket},add:function(a,e,m){m=void 0!==m?m:null;if(Array.isArray(e)){m=0;for(var c=e.length;m<c;m++)this.add(a,e[m])}else m=this.getBucket(m),
"undefined"===typeof m[a]&&(this.register(a),m[a]=[]),e.skip=!1,-1===m[a].indexOf(e)&&m[a].push(e);return this},once:function(a,e,m){m=void 0!==m?m:null;if(Array.isArray(e))for(var c=0,b=e.length;c<b;c++)e[c].runOnce=!0,this.add(a,e[c],m);else e.runOnce=!0,this.add(a,e,m)},remove:function(a,e,m){m=this.getBucket(void 0!==m?m:null);return"undefined"!==typeof m[a]&&0<=m[a].indexOf(e)?e.skip=!0:!1},run:function(a,e,m,c,b,p,l,g){for(var t=this.globalBucket[e],v=t?t.length:0,f=0;f<v;f++)if(!t[f].skip){var n=
t[f].call(a,m,c,b,p,l,g);void 0!==n&&(m=n);t[f].runOnce&&this.remove(e,t[f])}v=(t=this.getBucket(a)[e])?t.length:0;for(f=0;f<v;f++)t[f].skip||(n=t[f].call(a,m,c,b,p,l,g),void 0!==n&&(m=n),t[f].runOnce&&this.remove(e,t[f],a));return m},destroy:function(a){a=void 0!==a?a:null;var e=this.getBucket(a),m;for(m in e)for(var c=0,b=e[m].length;c<b;c++)this.remove(m,e[m],a)},register:function(d){this.isRegistered(d)||a.push(d)},deregister:function(d){this.isRegistered(d)&&a.splice(a.indexOf(d),1)},isRegistered:function(d){return 0<=
a.indexOf(d)},getRegistered:function(){return a}},{})},{"./eventManager.js":41}],45:[function(h,q,r){function a(a,e){Handsontable.hooks.add("beforeInit",function(){var c;a=a.toLowerCase();d.has(this)||d.set(this,{});c=d.get(this);c[a]||(c[a]=new e(this))});Handsontable.hooks.add("afterDestroy",function(){var a,b;if(d.has(this)){b=d.get(this);for(a in b)b.hasOwnProperty(a)&&b[a].destroy();d.delete(this)}})}function e(a,e){if("string"!=typeof e)throw Error('Only strings can be passed as "plugin" parameter');
var c=e.toLowerCase();if(!d.has(a)||!d.get(a)[c])throw Error('No plugin registered under name "'+e+'"');return d.get(a)[c]}Object.defineProperties(r,{registerPlugin:{get:function(){return a}},getPlugin:{get:function(){return e}},__esModule:{value:!0}});var d=new WeakMap},{}],46:[function(h,q,r){Object.defineProperties(r,{default:{get:function(){return d}},__esModule:{value:!0}});var a,e=(a=h("./../helpers.js"),a&&a.__esModule&&a||{default:a}).defineGetter;h=function(a){e(this,"hot",a,{writable:!1})};
$traceurRuntime.createClass(h,{destroy:function(){delete this.hot}},{});var d=h},{"./../helpers.js":42}],47:[function(h,q,r){function a(){function a(b){var c=document;this.table=c.createElement("table");this.theadTh=c.createElement("th");this.table.appendChild(c.createElement("thead")).appendChild(c.createElement("tr")).appendChild(this.theadTh);this.tableStyle=this.table.style;this.tableStyle.tableLayout="auto";this.tableStyle.width="auto";this.tbody=c.createElement("tbody");this.table.appendChild(this.tbody);
this.container=c.createElement("div");this.container.className=b.rootElement.className+" hidden";this.containerStyle=this.container.style;this.container.appendChild(this.table)}var d=this;this.beforeInit=function(){this.autoColumnWidths=[];!1!==this.getSettings().autoColumnSize?this.autoColumnSizeTmp||(this.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:!0},this.addHook("beforeRender",c.determineIfChanged),this.addHook("modifyColWidth",
c.modifyColWidth),this.addHook("afterDestroy",c.afterDestroy),this.determineColumnWidth=d.determineColumnWidth):this.autoColumnSizeTmp&&(this.removeHook("beforeRender",c.determineIfChanged),this.removeHook("modifyColWidth",c.modifyColWidth),this.removeHook("afterDestroy",c.afterDestroy),delete this.determineColumnWidth,d.afterDestroy.call(this))};this.determineIfChanged=function(a){a&&c.determineColumnsWidth.apply(this,arguments)};this.determineColumnWidth=function(c){var d=this.autoColumnSizeTmp;
d.container||a.call(d,this);d.container.className=this.rootElement.className+" htAutoColumnSize";d.table.className=this.table.className;for(var e=this.countRows(),p={},f=0;f<e;f++){var n=this.getDataAtCell(f,c);Array.isArray(n)||(n=k.stringify(n));var w=n.length;p[w]||(p[w]={needed:5,strings:[]});p[w].needed&&(p[w].strings.push({value:n,row:f}),p[w].needed--)}this.getSettings().colHeaders&&this.view.appendColHeader(c,d.theadTh);m.empty(d.tbody);for(var I in p)if(p.hasOwnProperty(I))for(e=0,n=p[I].strings.length;e<
n;e++){var w=p[I].strings[e].row,h=this.getCellMeta(w,c);h.col=c;h.row=w;var W=this.getCellRenderer(h),y=document.createElement("tr"),F=document.createElement("td");W(this,F,w,c,this.colToProp(c),p[I].strings[e].value,h);f++;y.appendChild(F);d.tbody.appendChild(y)}c=this.rootElement.parentNode;c.appendChild(d.container);p=m.outerWidth(d.table);c.removeChild(d.container);return p};this.determineColumnsWidth=function(){var a=this.getSettings();if(a.autoColumnSize||!a.colWidths)for(var a=this.countCols(),
b=0;b<a;b++)this._getColWidthFromSettings(b)||(this.autoColumnWidths[b]=d.determineColumnWidth.call(this,b))};this.modifyColWidth=function(a,b){return this.autoColumnWidths[b]&&this.autoColumnWidths[b]>a?this.autoColumnWidths[b]:a};this.afterDestroy=function(){this.autoColumnSizeTmp&&this.autoColumnSizeTmp.container&&this.autoColumnSizeTmp.container.parentNode&&this.autoColumnSizeTmp.container.parentNode.removeChild(this.autoColumnSizeTmp.container);this.autoColumnSizeTmp=null}}Object.defineProperties(r,
{AutoColumnSize:{get:function(){return a}},__esModule:{value:!0}});var e,d,k=(e=h("./../../helpers.js"),e&&e.__esModule&&e||{default:e}),m=(d=h("./../../dom.js"),d&&d.__esModule&&d||{default:d});h("./../../plugins.js");var c=new a;Handsontable.hooks.add("beforeInit",c.beforeInit);Handsontable.hooks.add("afterUpdateSettings",c.beforeInit)},{"./../../dom.js":27,"./../../helpers.js":42,"./../../plugins.js":45}],48:[function(h,q,r){function a(a){var b=this,d=!1,e,v,f;this.instance=a;this.addingStarted=
!1;f=c(a);f.addEventListener(document,"mouseup",function(b){if(!a.autofill)return!0;a.autofill.handle&&a.autofill.handle.isDragged&&(1<a.autofill.handle.isDragged&&a.autofill.apply(),a.autofill.handle.isDragged=0,d=!1)});f.addEventListener(document,"mousemove",function(a){var f,c;if(!b.instance.autofill)return!1;f=m.offset(b.instance.table).top-(window.pageYOffset||document.documentElement.scrollTop)+m.outerHeight(b.instance.table);c=m.offset(b.instance.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+
m.outerWidth(b.instance.table);!1===b.addingStarted&&0<b.instance.autofill.handle.isDragged&&a.clientY>f&&a.clientX<=c?(b.instance.mouseDragOutside=!0,b.addingStarted=!0):b.instance.mouseDragOutside=!1;b.instance.mouseDragOutside&&setTimeout(function(){b.addingStarted=!1;b.instance.alter("insert_row")},200)});e=this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown;this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown=function(b){a.autofill.handle.isDragged=1;d=!0;e(b)};v=this.instance.view.wt.wtSettings.settings.onCellMouseOver;
this.instance.view.wt.wtSettings.settings.onCellMouseOver=function(b,f,c,e){a.autofill&&d&&!a.view.isMouseDown()&&a.autofill.handle&&a.autofill.handle.isDragged&&(a.autofill.handle.isDragged++,a.autofill.showBorder(f),a.autofill.checkIfNewRowNeeded());v(b,f,c,e)};this.instance.view.wt.wtSettings.settings.onCellCornerDblClick=function(){a.autofill.selectAdjacent()}}Object.defineProperties(r,{Autofill:{get:function(){return a}},__esModule:{value:!0}});var e,d,k,m=(e=h("./../../dom.js"),e&&e.__esModule&&
e||{default:e}),c=(d=h("./../../eventManager.js"),d&&d.__esModule&&d||{default:d}).eventManager;h("./../../plugins.js");var b=(k=h("./../../3rdparty/walkontable/src/cell/coords.js"),k&&k.__esModule&&k||{default:k}).WalkontableCellCoords;a.prototype.init=function(){this.handle={}};a.prototype.disable=function(){this.handle.disabled=!0};a.prototype.selectAdjacent=function(){var a,c,d,e,m;a=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners();
c=this.instance.getData();d=a[2]+1;a:for(;d<this.instance.countRows();d++){for(m=a[1];m<=a[3];m++)if(c[d][m])break a;if(c[d][a[1]-1]||c[d][a[3]+1])e=d}e&&(this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(new b(a[0],a[1])),this.instance.view.wt.selections.fill.add(new b(e,a[3])),this.apply())};a.prototype.apply=function(){var a,c,d,e,m,f;this.handle.isDragged=0;if(d=this.instance.view.wt.selections.fill.getCorners())if(this.instance.view.wt.selections.fill.clear(),
a=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),Handsontable.hooks.run(this.instance,"afterAutofillApplyValues",a,d),d[0]===a[0]&&d[1]<a[1]?(f="left",e=new b(d[0],d[1]),m=new b(d[2],a[1]-1)):d[0]===a[0]&&d[3]>a[3]?(f="right",e=new b(d[0],a[3]+1),m=new b(d[2],d[3])):d[0]<a[0]&&d[1]===a[1]?(f="up",e=new b(d[0],d[1]),m=new b(a[0]-1,d[3])):d[2]>a[2]&&d[1]===a[1]&&(f="down",e=new b(a[2]+1,d[1]),m=new b(d[2],
d[3])),e&&-1<e.row&&-1<e.col){a=this.instance.getSelectedRange().from;c=this.instance.getSelectedRange().to;a=this.instance.getData(a.row,a.col,c.row,c.col);c=f;var n=a.length,w=a?a[0].length:0,k=[],h=[],W,y,F,B;W=m.row-e.row;y=m.col-e.col;if(-1!==["down","up"].indexOf(c)){for(var z=0;z<=y;z++)F=parseInt(a[0][z],10),B=parseInt(a[n-1][z],10),F=("down"===c?B-F:F-B)/(n-1)||0,h.push(F);k.push(h)}if(-1!==["right","left"].indexOf(c))for(n=0;n<=W;n++)F=parseInt(a[n][0],10),B=parseInt(a[n][w-1],10),F=("right"===
c?B-F:F-B)/(w-1)||0,h=[],h.push(F),k.push(h);Handsontable.hooks.run(this.instance,"beforeAutofill",e,m,a);this.instance.populateFromArray(e.row,e.col,a,m.row,m.col,"autofill",null,f,k);this.instance.selection.setRangeStart(new b(d[0],d[1]));this.instance.selection.setRangeEnd(new b(d[2],d[3]))}else this.instance.selection.refreshBorders()};a.prototype.showBorder=function(a){var c=this.instance.getSelectedRange().getTopLeftCorner(),d=this.instance.getSelectedRange().getBottomRightCorner();if("horizontal"!==
this.instance.getSettings().fillHandle&&(d.row<a.row||c.row>a.row))a=new b(a.row,d.col);else if("vertical"!==this.instance.getSettings().fillHandle)a=new b(d.row,a.col);else return;this.instance.view.wt.selections.fill.clear();this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().from);this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().to);this.instance.view.wt.selections.fill.add(a);this.instance.view.render()};a.prototype.checkIfNewRowNeeded=function(){var a,
b,c=this.instance.countRows(),d=this;this.instance.view.wt.selections.fill.cellRange&&!1===this.addingStarted&&(b=this.instance.getSelected(),a=this.instance.view.wt.selections.fill.getCorners(),b[2]<c-1&&a[2]===c-1&&(this.addingStarted=!0,this.instance._registerTimeout(setTimeout(function(){d.instance.alter("insert_row");d.addingStarted=!1},200))))};Handsontable.hooks.add("afterInit",function(){var b=new a(this);"undefined"!==typeof this.getSettings().fillHandle&&(b.handle&&!1===this.getSettings().fillHandle?
b.disable():b.handle||!1===this.getSettings().fillHandle||(this.autofill=b,this.autofill.init()))});Handsontable.Autofill=a},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45}],49:[function(h,q,r){Object.defineProperties(r,{default:{get:function(){return p}},__esModule:{value:!0}});var a,e,d,k,m=(a=h("./../../dom.js"),a&&a.__esModule&&a||{default:a}),c=(e=h("./../../eventManager.js"),e&&e.__esModule&&e||{default:e}).eventManager;
q=(d=h("./../_base.js"),d&&d.__esModule&&d||{default:d}).default;h=(k=h("./../../plugins.js"),k&&k.__esModule&&k||{default:k}).registerPlugin;var b=k=function(a){var c=this;$traceurRuntime.superConstructor(b).call(this,a);var d=this;this.sortIndicators=[];this.hot.addHook("afterInit",function(){return c.init.call(c,"afterInit")});this.hot.addHook("afterUpdateSettings",function(){return c.init.call(c,"afterUpdateSettings")});this.hot.addHook("modifyRow",function(){return d.translateRow.apply(d,arguments)});
this.hot.addHook("afterGetColHeader",function(){return d.getColHeader.apply(d,arguments)});Handsontable.hooks.register("beforeColumnSort");Handsontable.hooks.register("afterColumnSort")};$traceurRuntime.createClass(k,{init:function(a){var b=this.hot.getSettings().columnSorting,c=this;this.hot.sortingEnabled=!!b;if(this.hot.sortingEnabled){this.hot.sortIndex=[];var d=this.loadSortingState(),f;"undefined"!=typeof d?(f=d.sortColumn,b=d.sortOrder):(f=b.column,b=b.sortOrder);this.sortByColumn(f,b);this.hot.sort=
function(){var a=Array.prototype.slice.call(arguments);return c.sortByColumn.apply(c,a)};"undefined"==typeof this.hot.getSettings().observeChanges&&this.enableObserveChangesPlugin();"afterInit"==a&&(this.bindColumnSortingAfterClick(),this.hot.addHook("afterCreateRow",function(){c.afterCreateRow.apply(c,arguments)}),this.hot.addHook("afterRemoveRow",function(){c.afterRemoveRow.apply(c,arguments)}),this.hot.addHook("afterLoadData",function(){c.init.apply(c,arguments)}))}else this.hot.sort=void 0,this.hot.removeHook("afterCreateRow",
this.afterCreateRow),this.hot.removeHook("afterRemoveRow",this.afterRemoveRow),this.hot.removeHook("afterLoadData",this.init)},setSortingColumn:function(a,b){"undefined"==typeof a?(this.hot.sortColumn=void 0,this.hot.sortOrder=void 0):(this.hot.sortOrder=this.hot.sortColumn===a&&"undefined"==typeof b?!1===this.hot.sortOrder?void 0:!this.hot.sortOrder:"undefined"!=typeof b?b:!0,this.hot.sortColumn=a)},sortByColumn:function(a,b){this.setSortingColumn(a,b);"undefined"!=typeof this.hot.sortColumn&&(Handsontable.hooks.run(this.hot,
"beforeColumnSort",this.hot.sortColumn,this.hot.sortOrder),this.sort(),this.hot.render(),this.saveSortingState(),Handsontable.hooks.run(this.hot,"afterColumnSort",this.hot.sortColumn,this.hot.sortOrder))},saveSortingState:function(){var a={};"undefined"!=typeof this.hot.sortColumn&&(a.sortColumn=this.hot.sortColumn);"undefined"!=typeof this.hot.sortOrder&&(a.sortOrder=this.hot.sortOrder);(a.hasOwnProperty("sortColumn")||a.hasOwnProperty("sortOrder"))&&Handsontable.hooks.run(this.hot,"persistentStateSave",
"columnSorting",a)},loadSortingState:function(){var a={};Handsontable.hooks.run(this.hot,"persistentStateLoad","columnSorting",a);return a.value},bindColumnSortingAfterClick:function(){var a=this;c(this.hot).addEventListener(this.hot.rootElement,"click",function(b){if(m.hasClass(b.target,"columnSorting")){b=m.closest(b.target,"TH");b=m.index(b)-a.hot.view.TBODY.querySelector("tr").querySelectorAll("th").length;if(b!==this.lastSortedColumn)a.sortOrderClass="ascending";else switch(a.hot.sortOrder){case void 0:a.sortOrderClass=
"ascending";break;case !0:a.sortOrderClass="descending";break;case !1:a.sortOrderClass=void 0}this.lastSortedColumn=b;a.sortByColumn(b)}})},enableObserveChangesPlugin:function(){var a=this;this.hot._registerTimeout(setTimeout(function(){a.hot.updateSettings({observeChanges:!0})},0))},defaultSort:function(a){return function(b,c){"string"==typeof b[1]&&(b[1]=b[1].toLowerCase());"string"==typeof c[1]&&(c[1]=c[1].toLowerCase());return b[1]===c[1]?0:null===b[1]||""===b[1]?1:null===c[1]||""===c[1]?-1:b[1]<
c[1]?a?-1:1:b[1]>c[1]?a?1:-1:0}},dateSort:function(a){return function(b,c){if(b[1]===c[1])return 0;if(null===b[1])return 1;if(null===c[1])return-1;var d=new Date(b[1]),f=new Date(c[1]);return d<f?a?-1:1:d>f?a?1:-1:0}},sort:function(){if("undefined"!=typeof this.hot.sortOrder){var a;this.hot.sortingEnabled=!1;this.hot.sortIndex.length=0;var b=this.hot.colOffset();a=0;for(var c=this.hot.countRows()-this.hot.getSettings().minSpareRows;a<c;a++)this.hot.sortIndex.push([a,this.hot.getDataAtCell(a,this.hot.sortColumn+
b)]);a=this.hot.getCellMeta(0,this.hot.sortColumn);this.sortIndicators[this.hot.sortColumn]=a.sortIndicator;switch(a.type){case "date":a=this.dateSort;break;default:a=this.defaultSort}this.hot.sortIndex.sort(a(this.hot.sortOrder));for(a=this.hot.sortIndex.length;a<this.hot.countRows();a++)this.hot.sortIndex.push([a,this.hot.getDataAtCell(a,this.hot.sortColumn+b)]);this.hot.sortingEnabled=!0}},translateRow:function(a){return this.hot.sortingEnabled&&"undefined"!==typeof this.hot.sortOrder&&this.hot.sortIndex&&
this.hot.sortIndex.length&&this.hot.sortIndex[a]?this.hot.sortIndex[a][0]:a},untranslateRow:function(a){if(this.hot.sortingEnabled&&this.hot.sortIndex&&this.hot.sortIndex.length)for(var b=0;b<this.hot.sortIndex.length;b++)if(this.hot.sortIndex[b][0]==a)return b},getColHeader:function(a,b){var c=b.querySelector(".colHeader");this.hot.getSettings().columnSorting&&0<=a&&m.addClass(c,"columnSorting");m.removeClass(c,"descending");m.removeClass(c,"ascending");this.sortIndicators[a]&&a===this.hot.sortColumn&&
("ascending"===this.sortOrderClass?m.addClass(c,"ascending"):"descending"===this.sortOrderClass&&m.addClass(c,"descending"))},isSorted:function(){return"undefined"!=typeof this.hot.sortColumn},afterCreateRow:function(a,b){if(this.isSorted()){for(var c=0;c<this.hot.sortIndex.length;c++)this.hot.sortIndex[c][0]>=a&&(this.hot.sortIndex[c][0]+=b);for(c=0;c<b;c++)this.hot.sortIndex.splice(a+c,0,[a+c,this.hot.getData()[a+c][this.hot.sortColumn+this.hot.colOffset()]]);this.saveSortingState()}},afterRemoveRow:function(a,
b){if(this.isSorted()){var c=this.translateRow(a);this.hot.sortIndex.splice(a,b);for(var d=0;d<this.hot.sortIndex.length;d++)this.hot.sortIndex[d][0]>c&&(this.hot.sortIndex[d][0]-=b);this.saveSortingState()}}},{},q);var p=k;h("columnSorting",k)},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46}],50:[function(h,q,r){Object.defineProperties(r,{CommentEditor:{get:function(){return d}},__esModule:{value:!0}});var a,e=(a=h("./../../dom.js"),a&&a.__esModule&&
a||{default:a}),d=function(){this.editor=this.createEditor();this.editorStyle=this.editor.style;this.editorStyle.position="absolute";this.editorStyle.zIndex=100;this.hide()},k=d;$traceurRuntime.createClass(d,{setPosition:function(a,c){this.editorStyle.left=a+"px";this.editorStyle.top=c+"px"},show:function(){this.editorStyle.display="block"},hide:function(){this.editorStyle.display="none"},isVisible:function(){return"block"===this.editorStyle.display},setValue:function(a){a=(void 0!==a?a:"")||"";this.getInputElement().value=
a},getValue:function(){return this.getInputElement().value},isFocused:function(){return document.activeElement===this.getInputElement()},focus:function(){this.getInputElement().focus()},createEditor:function(){var a=document.querySelector("."+k.CLASS_EDITOR_CONTAINER),c,b;a||(a=document.createElement("div"),e.addClass(a,k.CLASS_EDITOR_CONTAINER),document.body.appendChild(a));c=document.createElement("div");e.addClass(c,k.CLASS_EDITOR);b=document.createElement("textarea");e.addClass(b,k.CLASS_INPUT);
c.appendChild(b);a.appendChild(c);return c},getInputElement:function(){return this.editor.querySelector("."+k.CLASS_INPUT)},destroy:function(){this.editor.parentNode.removeChild(this.editor);this.editorStyle=this.editor=null}},{get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"},get CLASS_EDITOR(){return"htComments"},get CLASS_INPUT(){return"htCommentTextArea"},get CLASS_CELL(){return"htCommentCell"}})},{"./../../dom.js":27}],51:[function(h,q,r){Object.defineProperties(r,{Comments:{get:function(){return t}},
__esModule:{value:!0}});var a,e,d,k,m,c,b=(a=h("./../../dom.js"),a&&a.__esModule&&a||{default:a}),p=(e=h("./../../eventManager.js"),e&&e.__esModule&&e||{default:e}).EventManager,l=(d=h("./../../3rdparty/walkontable/src/cell/coords.js"),d&&d.__esModule&&d||{default:d}).WalkontableCellCoords;q=(k=h("./../../plugins.js"),k&&k.__esModule&&k||{default:k}).registerPlugin;k=(m=h("./../_base.js"),m&&m.__esModule&&m||{default:m}).default;var g=(c=h("./commentEditor.js"),c&&c.__esModule&&c||{default:c}).CommentEditor,
t=function(a){var b=this;$traceurRuntime.superConstructor(v).call(this,a);this.hot.getSettings().comments&&(this.editor=new g,this.eventManager=new p(this),this.range={},this.contextMenuEvent=this.mouseDown=!1,this.timer=null,this.hot.addHook("afterInit",function(){return b.registerListeners()}),this.hot.addHook("afterContextMenuDefaultOptions",function(a){return b.addToContextMenu(a)}),this.hot.addHook("afterRenderer",function(a,c,f,d,e,g){return b.onAfterRenderer(a,g)}),this.hot.addHook("afterScrollVertically",
function(){return b.refreshEditorPosition()}),this.hot.addHook("afterColumnResize",function(){return b.refreshEditorPosition()}),this.hot.addHook("afterRowResize",function(){return b.refreshEditorPosition()}))},v=t;$traceurRuntime.createClass(t,{registerListeners:function(){var a=this;this.eventManager.addEventListener(document,"mouseover",function(b){return a.onMouseOver(b)});this.eventManager.addEventListener(document,"mousedown",function(b){return a.onMouseDown(b)});this.eventManager.addEventListener(document,
"mousemove",function(b){return a.onMouseMove(b)});this.eventManager.addEventListener(document,"mouseup",function(b){return a.onMouseUp(b)});this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(b){return a.onEditorBlur(b)})},setRange:function(a){this.range=a},clearRange:function(){this.range={}},targetIsCellWithComment:function(a){return b.hasClass(a.target,"htCommentCell")&&b.closest(a.target,[this.hot.rootElement])?!0:!1},targetIsCommentTextArea:function(a){return this.editor.getInputElement()===
a.target},saveComment:function(){if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var a=this.editor.getValue();this.hot.setCellMeta(this.range.from.row,this.range.from.col,"comment",a);this.hot.render()},saveCommentAtCell:function(a,b){this.setRange({from:new l(a,b)});this.saveComment()},removeComment:function(){if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');
this.hot.removeCellMeta(this.range.from.row,this.range.from.col,"comment");this.hot.render();this.hide()},removeCommentAtCell:function(a,b){this.setRange({from:new l(a,b)});this.removeComment()},show:function(){if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var a=this.hot.getCellMeta(this.range.from.row,this.range.from.col);this.refreshEditorPosition(!0);this.editor.setValue(a.comment||"");this.editor.show();return!0},showAtCell:function(a,
b){this.setRange({from:new l(a,b)});return this.show()},hide:function(){this.editor.hide()},refreshEditorPosition:function(a){if(void 0!==a&&a||this.range.from&&this.editor.isVisible()){a=this.hot.view.wt.wtTable.getCell(this.range.from);a=b.offset(a);var c=this.hot.getColWidth(this.range.from.col),d=a.top,e=a.left,g=a=0;this.hot.view.wt.wtViewport.hasVerticalScroll()&&(d-=this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition(),a=20);this.hot.view.wt.wtViewport.hasHorizontalScroll()&&(e-=this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition(),
g=20);var c=e+c,e=this.hot.view.wt.wtTable.holder.getBoundingClientRect(),g=e.left+b.getWindowScrollLeft()+g,l=e.right+b.getWindowScrollLeft()-15;a=e.top+b.getWindowScrollTop()+a;e=e.bottom+b.getWindowScrollTop();c<=g||c>l||d<=a||d>e?this.hide():this.editor.setPosition(c,d)}},onMouseDown:function(a){this.mouseDown=!0;this.hot.view&&this.hot.view.wt&&(this.contextMenuEvent||this.targetIsCommentTextArea(a)||this.targetIsCellWithComment(a)||this.hide(),this.contextMenuEvent=!1)},onMouseOver:function(a){this.mouseDown||
this.editor.isFocused()||(this.targetIsCellWithComment(a)?(a=this.hot.view.wt.wtTable.getCoords(a.target),a={from:new l(a.row,a.col)},this.setRange(a),this.show()):this.targetIsCommentTextArea(a)||this.editor.isFocused()||this.hide())},onMouseMove:function(a){var b=this;this.targetIsCommentTextArea(a)&&(this.mouseDown=!0,clearTimeout(this.timer),this.timer=setTimeout(function(){b.mouseDown=!1},200))},onMouseUp:function(a){this.mouseDown=!1},onAfterRenderer:function(a,c){c.comment&&b.addClass(a,c.commentedCellClassName)},
onEditorBlur:function(a){this.saveComment()},checkSelectionCommentsConsistency:function(){var a=!1,b=this.hot.getSelectedRange().from;this.hot.getCellMeta(b.row,b.col).comment&&(a=!0);return a},onContextMenuAddComment:function(){var a=this,b=this.hot.getSelectedRange();this.contextMenuEvent=!0;this.setRange({from:b.from});this.show();setTimeout(function(){a.hot&&(a.hot.deselectCell(),a.editor.focus())},10)},onContextMenuRemoveComment:function(a,b){this.contextMenuEvent=!0;this.removeCommentAtCell(b.start.row,
b.start.col)},addToContextMenu:function(a){var b=this;a.items.push(Handsontable.ContextMenu.SEPARATOR,{key:"commentsAddEdit",name:function(){return b.checkSelectionCommentsConsistency()?"Edit Comment":"Add Comment"},callback:function(){return b.onContextMenuAddComment()},disabled:function(){return!1}},{key:"commentsRemove",name:function(){return"Delete Comment"},callback:function(a,c){return b.onContextMenuRemoveComment(a,c)},disabled:function(){return!b.checkSelectionCommentsConsistency()}})},destroy:function(){this.eventManager&&
this.eventManager.clear();this.editor&&this.editor.destroy();$traceurRuntime.superGet(this,v.prototype,"destroy").call(this)}},{},k);q("comments",t)},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46,"./commentEditor.js":50}],52:[function(h,q,r){function a(b,c){this.instance=b;var e=this;e.menus=[];e.htMenus={};e.triggerRows=[];e.eventManager=v(e);this.enabled=!0;this.instance.addHook("afterDestroy",function(){e.destroy()});
this.defaultOptions={items:[{key:"row_above",name:"Insert row above",callback:function(a,b){this.alter("insert_row",b.start.row)},disabled:function(){var a=this.getSelected(),b=[0,a[1],this.countRows()-1,a[1]].join()==a.join(",");return 0>a[0]||this.countRows()>=this.getSettings().maxRows||b}},{key:"row_below",name:"Insert row below",callback:function(a,b){this.alter("insert_row",b.end.row+1)},disabled:function(){var a=this.getSelected(),a=[0,a[1],this.countRows()-1,a[1]].join()==a.join(",");return 0>
this.getSelected()[0]||this.countRows()>=this.getSettings().maxRows||a}},a.SEPARATOR,{key:"col_left",name:"Insert column on the left",callback:function(a,b){this.alter("insert_col",b.start.col)},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var a=this.getSelected(),a=[a[0],0,a[0],this.countCols()-1].join()==a.join(",");return 0>this.getSelected()[1]||this.countCols()>=this.getSettings().maxCols||a}},{key:"col_right",name:"Insert column on the right",callback:function(a,b){this.alter("insert_col",
b.end.col+1)},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var a=this.getSelected(),b=[a[0],0,a[0],this.countCols()-1].join()==a.join(",");return 0>a[1]||this.countCols()>=this.getSettings().maxCols||b}},a.SEPARATOR,{key:"remove_row",name:"Remove row",callback:function(a,b){this.alter("remove_row",b.start.row,b.end.row-b.start.row+1)},disabled:function(){var a=this.getSelected(),b=[0,a[1],this.countRows()-1,a[1]].join()==a.join(",");return 0>a[0]||b}},{key:"remove_col",name:"Remove column",
callback:function(a,b){this.alter("remove_col",b.start.col,b.end.col-b.start.col+1)},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var a=this.getSelected(),b=[a[0],0,a[0],this.countCols()-1].join()==a.join(",");return 0>a[1]||b}},a.SEPARATOR,{key:"undo",name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},{key:"redo",name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}},
a.SEPARATOR,{key:"make_read_only",name:function(){var a="Read only";e.checkSelectionReadOnlyConsistency(this)&&(a=e.markSelected(a));return a},callback:function(){var a=e.checkSelectionReadOnlyConsistency(this),b=this;this.getSelectedRange().forAll(function(c,f){b.getCellMeta(c,f).readOnly=a?!1:!0});this.render()}},a.SEPARATOR,{key:"alignment",name:"Alignment",submenu:{items:[{name:function(){var a="Left";e.checkSelectionAlignment(this,"htLeft")&&(a=e.markSelected(a));return a},callback:function(){m.call(this,
this.getSelectedRange(),"horizontal","htLeft")},disabled:!1},{name:function(){var a="Center";e.checkSelectionAlignment(this,"htCenter")&&(a=e.markSelected(a));return a},callback:function(){m.call(this,this.getSelectedRange(),"horizontal","htCenter")},disabled:!1},{name:function(){var a="Right";e.checkSelectionAlignment(this,"htRight")&&(a=e.markSelected(a));return a},callback:function(){m.call(this,this.getSelectedRange(),"horizontal","htRight")},disabled:!1},{name:function(){var a="Justify";e.checkSelectionAlignment(this,
"htJustify")&&(a=e.markSelected(a));return a},callback:function(){m.call(this,this.getSelectedRange(),"horizontal","htJustify")},disabled:!1},a.SEPARATOR,{name:function(){var a="Top";e.checkSelectionAlignment(this,"htTop")&&(a=e.markSelected(a));return a},callback:function(){m.call(this,this.getSelectedRange(),"vertical","htTop")},disabled:!1},{name:function(){var a="Middle";e.checkSelectionAlignment(this,"htMiddle")&&(a=e.markSelected(a));return a},callback:function(){m.call(this,this.getSelectedRange(),
"vertical","htMiddle")},disabled:!1},{name:function(){var a="Bottom";e.checkSelectionAlignment(this,"htBottom")&&(a=e.markSelected(a));return a},callback:function(){m.call(this,this.getSelectedRange(),"vertical","htBottom")},disabled:!1}]}}]};e.options={};g.extend(e.options,this.options);this.bindMouseEvents();this.markSelected=function(a){return"<span class='selected'>"+String.fromCharCode(10003)+"</span>"+a};this.checkSelectionAlignment=function(a,b){var c=!1;a.getSelectedRange().forAll(function(f,
d){var n=a.getCellMeta(f,d).className;if(n&&-1!=n.indexOf(b))return c=!0,!1});return c};if(!this.instance.getSettings().allowInsertRow){var l=d(this.defaultOptions.items,"row_above");this.defaultOptions.items.splice(l,1);l=d(this.defaultOptions.items,"row_above");this.defaultOptions.items.splice(l,1);this.defaultOptions.items.splice(l,1)}this.instance.getSettings().allowInsertColumn||(l=d(this.defaultOptions.items,"col_left"),this.defaultOptions.items.splice(l,1),l=d(this.defaultOptions.items,"col_right"),
this.defaultOptions.items.splice(l,1),this.defaultOptions.items.splice(l,1));var p=!1,l=!1,k;this.instance.getSettings().allowRemoveRow||(p=d(this.defaultOptions.items,"remove_row"),this.defaultOptions.items.splice(p,1),p=!0);this.instance.getSettings().allowRemoveColumn||(k=d(this.defaultOptions.items,"remove_col"),this.defaultOptions.items.splice(k,1),l=!0);p&&l&&this.defaultOptions.items.splice(k,1);this.checkSelectionReadOnlyConsistency=function(a){var b=!1;a.getSelectedRange().forAll(function(c,
f){if(a.getCellMeta(c,f).readOnly)return b=!0,!1});return b};Handsontable.hooks.run(b,"afterContextMenuDefaultOptions",this.defaultOptions)}function e(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c].key===b)return a[c]}function d(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c].key===b)return c}function k(a,b,c,d){var e=this.getCellMeta(a,b),g=d;e.className&&("vertical"===c?(c=e.className,-1==c.indexOf(d)&&(c=c.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),c+=" "+d),g=
c):(c=e.className,-1==c.indexOf(d)&&(c=c.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),c+=" "+d),g=c));this.setCellMeta(a,b,"className",g)}function m(a,b,c){for(var d={},e=a.from.row;e<=a.to.row;e++)for(var g=a.from.col;g<=a.to.col;g++)d[e]||(d[e]=[]),d[e][g]=this.getCellMeta(e,g).className;this.runHooks("beforeCellAlignment",d,a,b,c);if(a.from.row==a.to.row&&a.from.col==a.to.col)k.call(this,a.from.row,a.from.col,b,c);else for(d=a.from.row;d<=
a.to.row;d++)for(e=a.from.col;e<=a.to.col;e++)k.call(this,d,e,b,c);this.render()}function c(){var b=this.getSettings().contextMenu,c=g.isObject(b)?b:{};b?(this.contextMenu||(this.contextMenu=new a(this,c)),this.contextMenu.enable()):this.contextMenu&&(this.contextMenu.destroy(),delete this.contextMenu)}Object.defineProperties(r,{ContextMenu:{get:function(){return a}},__esModule:{value:!0}});var b,p,l,g=(b=h("./../../helpers.js"),b&&b.__esModule&&b||{default:b}),t=(p=h("./../../dom.js"),p&&p.__esModule&&
p||{default:p}),v=(l=h("./../../eventManager.js"),l&&l.__esModule&&l||{default:l}).eventManager;h("./../../plugins.js");a.prototype.createMenu=function(a,b){a&&(a=a.replace(/ /g,"_"),a="htContextSubMenu_"+a);var c;c=a?document.querySelector(".htContextMenu."+a):document.querySelector(".htContextMenu");c||(c=document.createElement("DIV"),t.addClass(c,"htContextMenu"),a&&t.addClass(c,a),document.getElementsByTagName("body")[0].appendChild(c));0>this.menus.indexOf(c)&&(this.menus.push(c),this.triggerRows.push(b||
0));return c};a.prototype.bindMouseEvents=function(){v(this.instance).addEventListener(this.instance.rootElement,"contextmenu",g.proxy(function(b){var c=this.instance.getSettings(),d=this.instance.getSettings().rowHeaders,e=this.instance.getSettings().colHeaders,l;l=b.realTarget;this.closeAll();b.preventDefault();g.stopPropagation(b);if(!d&&!e){if(!("TD"===l.nodeName||"TD"===l.parentNode.nodeName||t.hasClass(l,"current")&&t.hasClass(l,"wtBorder")))return}else if(d&&e&&(d=0<l.parentNode.querySelectorAll(".cornerHeader").length))return;
d=this.createMenu();c=this.getItems(c.contextMenu);this.show(d,c);this.setMenuPosition(b,d);this.eventManager.addEventListener(document.documentElement,"mousedown",g.proxy(a.prototype.closeAll,this))},this))};a.prototype.bindTableEvents=function(){this._afterScrollCallback=function(){};this.instance.addHook("afterScrollVertically",this._afterScrollCallback);this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)};a.prototype.unbindTableEvents=function(){this._afterScrollCallback&&
(this.instance.removeHook("afterScrollVertically",this._afterScrollCallback),this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)};a.prototype.performAction=function(b,c){var d=c.getSelected()[0],d=c.getData()[d];if(!0!==d.disabled&&("function"!=typeof d.disabled||!0!==d.disabled.call(this.instance))&&!d.hasOwnProperty("submenu")&&"function"==typeof d.callback){var e=this.instance.getSelectedRange(),e=a.utils.normalizeSelection(e);d.callback.call(this.instance,
d.key,e,b);this.closeAll()}};a.prototype.unbindMouseEvents=function(){this.eventManager.clear();v(this.instance).removeEventListener(this.instance.rootElement,"contextmenu")};a.prototype.show=function(a,b){var c=this;a.removeAttribute("style");a.style.display="block";var d={data:b,colHeaders:!1,colWidths:[200],readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:g.proxy(this.renderer,this)}],renderAllRows:!0,beforeKeyDown:function(a){c.onBeforeKeyDown(a,e)},afterOnCellMouseOver:function(a,b,f){c.onCellMouseOver(a,
b,f,e)}},e=new Handsontable(a,d);e.isHotTableEnv=this.instance.isHotTableEnv;Handsontable.eventManager.isHotTableEnv=this.instance.isHotTableEnv;this.eventManager.removeEventListener(a,"mousedown");this.eventManager.addEventListener(a,"mousedown",function(a){c.performAction(a,e)});this.bindTableEvents();e.listen();this.htMenus[e.guid]=e;Handsontable.hooks.run(this.instance,"afterContextMenuShow",e)};a.prototype.close=function(a){this.hide(a);this.eventManager.clear();this.unbindTableEvents();this.instance.listen()};
a.prototype.closeAll=function(){for(;0<this.menus.length;){var a=this.menus.pop();a&&this.close(a)}this.triggerRows=[]};a.prototype.closeLastOpenedSubMenu=function(){var a=this.menus.pop();a&&this.hide(a)};a.prototype.hide=function(a){a.style.display="none";var b=this.htMenus[a.id];Handsontable.hooks.run(this.instance,"afterContextMenuHide",b);b.destroy();delete this.htMenus[a.id]};a.prototype.renderer=function(b,c,d,e,g,l){g=b.getData()[d];var p=document.createElement("DIV");"function"===typeof l&&
(l=l.call(this.instance));t.empty(c);c.appendChild(p);(new RegExp(a.SEPARATOR.name,"i")).test(g.name)?t.addClass(c,"htSeparator"):t.fastInnerHTML(p,l);!0===g.disabled||"function"==typeof g.disabled&&!0===g.disabled.call(this.instance)?(t.addClass(c,"htDisabled"),this.eventManager.addEventListener(p,"mouseenter",function(){b.deselectCell()})):(g.hasOwnProperty("submenu")?t.addClass(c,"htSubmenu"):(t.removeClass(c,"htSubmenu"),t.removeClass(c,"htDisabled")),this.eventManager.addEventListener(p,"mouseenter",
function(){b.selectCell(d,e)}))};a.prototype.onCellMouseOver=function(a,b,c,d){a=this.menus.length;0<a?this.menus[a-1].id!=d.guid&&this.closeLastOpenedSubMenu():this.closeLastOpenedSubMenu();-1!=c.className.indexOf("htSubmenu")&&(a=d.getData()[b.row],d=this.getItems(a.submenu),b=this.createMenu(a.name,b.row),c=c.getBoundingClientRect(),this.show(b,d),this.setSubMenuPosition(c,b))};a.prototype.onBeforeKeyDown=function(b,c){function d(b){var c=b.getCell(0,0);a.utils.isSeparator(c)||a.utils.isDisabled(c)?
l(0,0,b):b.selectCell(0,0)}function e(b){var c=b.countRows()-1,d=b.getCell(c,0);a.utils.isSeparator(d)||a.utils.isDisabled(d)?p(c,0,b):b.selectCell(c,0)}function l(b,c,d){b+=1;var f=b<d.countRows()?d.getCell(b,c):null;f&&(a.utils.isSeparator(f)||a.utils.isDisabled(f)?l(b,c,d):d.selectCell(b,c))}function p(b,c,d){--b;var f=0<=b?d.getCell(b,c):null;f&&(a.utils.isSeparator(f)||a.utils.isDisabled(f)?p(b,c,d):d.selectCell(b,c))}function m(a,b,c,d){var f=a.getData()[d];a=b.getItems(f.submenu);d=b.createMenu(f.name,
d);c=c.getBoundingClientRect();a=b.show(d,a);b.setSubMenuPosition(c,d);a.selectCell(0,0)}t.enableImmediatePropagation(b);var k=c.getSelected();switch(b.keyCode){case g.keyCode.ESCAPE:this.closeAll();b.preventDefault();b.stopImmediatePropagation();break;case g.keyCode.ENTER:k&&this.performAction(b,c);break;case g.keyCode.ARROW_DOWN:k?l(k[0],k[1],c,this):d(c,this);b.preventDefault();b.stopImmediatePropagation();break;case g.keyCode.ARROW_UP:k?p(k[0],k[1],c,this):e(c,this);b.preventDefault();b.stopImmediatePropagation();
break;case g.keyCode.ARROW_RIGHT:if(k){var v=k[0],k=c.getCell(k[0],0);a.utils.hasSubMenu(k)&&m(c,this,k,v)}b.preventDefault();b.stopImmediatePropagation();break;case g.keyCode.ARROW_LEFT:k&&(-1!=c.rootElement.className.indexOf("htContextSubMenu_")&&(this.closeLastOpenedSubMenu(),v=this.menus.length,0<v&&(v=this.menus[v-1],k=this.triggerRows.pop(),c=this.htMenus[v.id],c.selectCell(k,0))),b.preventDefault(),b.stopImmediatePropagation())}};a.prototype.getItems=function(a){function b(a){"string"==typeof a?
this.name=a:g.extend(this,a)}var c,d;(b.prototype=a)&&a.items&&(a=a.items);!0===a&&(a=this.defaultOptions.items);c=[];for(var l in a)a.hasOwnProperty(l)&&((d="string"===typeof a[l]?e(this.defaultOptions.items,a[l]):e(this.defaultOptions.items,l))||(d=a[l]),d=new b(d),"object"===typeof a[l]&&g.extend(d,a[l]),d.key||(d.key=l),c.push(d));return c};a.prototype.setSubMenuPosition=function(a,b){var c=t.getWindowScrollTop(),d=t.getWindowScrollLeft(),c={top:c+a.top,topRelative:a.top,left:a.left,leftRelative:a.left-
d,scrollTop:c,scrollLeft:d,cellHeight:a.height,cellWidth:a.width};this.menuFitsBelowCursor(c,b,document.body.clientWidth)?this.positionMenuBelowCursor(c,b,!0):this.menuFitsAboveCursor(c,b)?this.positionMenuAboveCursor(c,b,!0):this.positionMenuBelowCursor(c,b,!0);this.menuFitsOnRightOfCursor(c,b,document.body.clientWidth)?this.positionMenuOnRightOfCursor(c,b,!0):this.positionMenuOnLeftOfCursor(c,b,!0)};a.prototype.setMenuPosition=function(a,b){var c=t.getWindowScrollTop(),d=t.getWindowScrollLeft(),
e=a.pageY||a.clientY+c,g=a.pageX||a.clientX+d,c={top:e,topRelative:e-c,left:g,leftRelative:g-d,scrollTop:c,scrollLeft:d,cellHeight:a.target.clientHeight,cellWidth:a.target.clientWidth};this.menuFitsBelowCursor(c,b,document.body.clientHeight)?this.positionMenuBelowCursor(c,b):this.menuFitsAboveCursor(c,b)?this.positionMenuAboveCursor(c,b):this.positionMenuBelowCursor(c,b);this.menuFitsOnRightOfCursor(c,b,document.body.clientWidth)?this.positionMenuOnRightOfCursor(c,b):this.positionMenuOnLeftOfCursor(c,
b)};a.prototype.menuFitsAboveCursor=function(a,b){return a.topRelative>=b.offsetHeight};a.prototype.menuFitsBelowCursor=function(a,b,c){return a.topRelative+b.offsetHeight<=c};a.prototype.menuFitsOnRightOfCursor=function(a,b,c){return a.leftRelative+b.offsetWidth<=c};a.prototype.positionMenuBelowCursor=function(a,b){b.style.top=a.top+"px"};a.prototype.positionMenuAboveCursor=function(a,b,c){b.style.top=c?a.top+a.cellHeight-b.offsetHeight+"px":a.top-b.offsetHeight+"px"};a.prototype.positionMenuOnRightOfCursor=
function(a,b,c){b.style.left=c?1+a.left+a.cellWidth+"px":1+a.left+"px"};a.prototype.positionMenuOnLeftOfCursor=function(a,b,c){b.style.left=a.left-b.offsetWidth+"px"};a.utils={};a.utils.normalizeSelection=function(a){return{start:a.getTopLeftCorner(),end:a.getBottomRightCorner()}};a.utils.isSeparator=function(a){return t.hasClass(a,"htSeparator")};a.utils.hasSubMenu=function(a){return t.hasClass(a,"htSubmenu")};a.utils.isDisabled=function(a){return t.hasClass(a,"htDisabled")};a.prototype.enable=function(){this.enabled||
(this.enabled=!0,this.bindMouseEvents())};a.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.closeAll(),this.unbindMouseEvents(),this.unbindTableEvents())};a.prototype.destroy=function(){for(this.closeAll();0<this.menus.length;){var a=this.menus.pop();this.triggerRows.pop();a&&(this.close(a),this.isMenuEnabledByOtherHotInstance()||this.removeMenu(a))}this.unbindMouseEvents();this.unbindTableEvents()};a.prototype.isMenuEnabledByOtherHotInstance=function(){for(var a=document.querySelectorAll(".handsontable"),
b=!1,c=0,d=a.length;c<d;c++){var e=this.htMenus[a[c].id];if(e&&e.getSettings().contextMenu){b=!0;break}}return b};a.prototype.removeMenu=function(a){a.parentNode&&this.menu.parentNode.removeChild(a)};a.prototype.align=function(a,b,c){m.call(this,a,b,c)};a.SEPARATOR={name:"---------"};Handsontable.hooks.add("afterInit",c);Handsontable.hooks.add("afterUpdateSettings",c);Handsontable.hooks.add("afterInit",function(){if(!this.rootElement.className.indexOf("htContextMenu")){for(var b=0,c=0,d=this.getSettings().data.length,
e=parseInt(this.view.wt.wtTable.hider.style.width,10),g=0;g<d;g++)this.getSettings().data[g].name==a.SEPARATOR.name?b+=1:c+=26;this.view.wt.wtTable.holder.style.width=e+22+"px";this.view.wt.wtTable.holder.style.height=c+b+4+"px"}});Handsontable.hooks.register("afterContextMenuDefaultOptions");Handsontable.hooks.register("afterContextMenuShow");Handsontable.hooks.register("afterContextMenuHide");Handsontable.ContextMenu=a},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],
53:[function(h,q,r){Object.defineProperties(r,{ContextMenuCopyPaste:{get:function(){return l}},__esModule:{value:!0}});var a,e,d,k,m,c=(a=h("./../../dom.js"),a&&a.__esModule&&a||{default:a}),b=(e=h("./../../eventManager.js"),e&&e.__esModule&&e||{default:e}).eventManager;q=(d=h("./../../plugins.js"),d&&d.__esModule&&d||{default:d}).registerPlugin;d=(k=h("./../_base.js"),k&&k.__esModule&&k||{default:k}).default;var p=(m=h("zeroclipboard"),m&&m.__esModule&&m||{default:m}).default,l=function(a){var b=
this;$traceurRuntime.superConstructor(g).call(this,a);this.outsideClickDeselectsCache=this.hotContextMenu=this.swfPath=null;this.hot.addHook("afterContextMenuShow",function(a){return b.setupZeroClipboard(a)});this.hot.addHook("afterInit",function(){return b.afterInit()});this.hot.addHook("afterContextMenuDefaultOptions",function(a){return b.addToContextMenu(a)})},g=l;$traceurRuntime.createClass(l,{afterInit:function(){if(this.hot.getSettings().contextMenuCopyPaste){"object"==typeof this.hot.getSettings().contextMenuCopyPaste&&
(this.swfPath=this.hot.getSettings().contextMenuCopyPaste.swfPath);if("undefined"===typeof p)throw Error("To be able to use the Copy/Paste feature from the context menu, you need to manualy include ZeroClipboard.js file to your website.");try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(a){if("undefined"==typeof navigator.mimeTypes["application/x-shockwave-flash"])throw Error("To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.");
}this.prepareZeroClipboard()}},prepareZeroClipboard:function(){this.swfPath&&p.config({swfPath:this.swfPath})},getCopyValue:function(){this.hot.copyPaste.setCopyableText();return this.hot.copyPaste.copyPasteInstance.elTextarea.value},addToContextMenu:function(a){this.hot.getSettings().contextMenuCopyPaste&&a.items.unshift({key:"copy",name:"Copy"},{key:"paste",name:"Paste",callback:function(){this.copyPaste.triggerPaste()}},Handsontable.ContextMenu.SEPARATOR)},setupZeroClipboard:function(a){var b=
this;if(this.hot.getSettings().contextMenuCopyPaste){this.hotContextMenu=a;a=this.hotContextMenu.getData();for(var c=0,d=a.length;c<d;c++)if("copy"===a[c].key){a=new p(this.hotContextMenu.getCell(c,0));a.off();a.on("copy",function(a){a.clipboardData.setData("text/plain",b.getCopyValue());b.hot.getSettings().outsideClickDeselects=b.outsideClickDeselectsCache});this.bindEvents();break}}},removeCurrentClass:function(){if(this.hotContextMenu.rootElement){var a=this.hotContextMenu.rootElement.querySelector("td.current");
a&&c.removeClass(a,"current")}this.outsideClickDeselectsCache=this.hot.getSettings().outsideClickDeselects;this.hot.getSettings().outsideClickDeselects=!1},removeZeroClipboardClass:function(){if(this.hotContextMenu.rootElement){var a=this.hotContextMenu.rootElement.querySelector("td.zeroclipboard-is-hover");a&&c.removeClass(a,"zeroclipboard-is-hover")}this.hot.getSettings().outsideClickDeselects=this.outsideClickDeselectsCache},bindEvents:function(){var a=this,c=b(this.hotContextMenu);c.addEventListener(document,
"mouseenter",function(){return a.removeCurrentClass()});c.addEventListener(document,"mouseleave",function(){return a.removeZeroClipboardClass()})}},{},d);q("contextMenuCopyPaste",l)},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46,zeroclipboard:"zeroclipboard"}],54:[function(h,q,r){function a(a){function b(){a.isListening()&&a.selection.empty()}function c(b){var d,e,n,l;a.isListening()&&a.selection.isSelected()&&(b=g.parse(b),d=a.getSelected(),e=new t(d[0],
d[1]),d=new t(d[2],d[3]),e=new v(e,e,d),n=e.getTopLeftCorner(),e=e.getBottomRightCorner(),l=new t(Math.max(e.row,b.length-1+n.row),Math.max(e.col,b[0].length-1+n.col)),a.addHookOnce("afterChange",function(a,b){a&&a.length&&this.selectCell(n.row,n.col,l.row,l.col)}),a.populateFromArray(n.row,n.col,b,l.row,l.col,"paste",a.getSettings().pasteMode))}function d(b){var c;a.getSelected()&&(p.isCtrlKey(b.keyCode)?(e.setCopyableText(),b.stopImmediatePropagation()):(c=(b.ctrlKey||b.metaKey)&&!b.altKey,b.keyCode==
p.keyCode.A&&c&&a._registerTimeout(setTimeout(p.proxy(e.setCopyableText,e),0))))}var e=this;this.copyPasteInstance=l();this.copyPasteInstance.onCut(b);this.copyPasteInstance.onPaste(c);a.addHook("beforeKeyDown",d);this.destroy=function(){this.copyPasteInstance.removeCallback(b);this.copyPasteInstance.removeCallback(c);this.copyPasteInstance.destroy();a.removeHook("beforeKeyDown",d)};a.addHook("afterDestroy",p.proxy(this.destroy,this));this.triggerPaste=p.proxy(this.copyPasteInstance.triggerPaste,
this.copyPasteInstance);this.triggerCut=p.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance);this.setCopyableText=function(){var b=a.getSettings(),c=b.copyRowsLimit,b=b.copyColsLimit,d=a.getSelectedRange(),e=d.getTopLeftCorner(),n=d.getBottomRightCorner(),d=e.row,e=e.col,g=n.row,n=n.col,l=Math.min(g,d+c-1),p=Math.min(n,e+b-1);a.copyPaste.copyPasteInstance.copyable(a.getCopyableData(d,e,l,p));g===l&&n===p||Handsontable.hooks.run(a,"afterCopyLimit",g-d+1,n-e+1,c,b)}}function e(){var b=
!1!==this.getSettings().copyPaste;b&&!this.copyPaste?this.copyPaste=new a(this):!b&&this.copyPaste&&(this.copyPaste.destroy(),delete this.copyPaste)}Object.defineProperties(r,{CopyPaste:{get:function(){return CopyPaste}},__esModule:{value:!0}});var d,k,m,c,b,p=(d=h("./../../helpers.js"),d&&d.__esModule&&d||{default:d}),l=(k=h("copyPaste"),k&&k.__esModule&&k||{default:k}).default,g=(m=h("SheetClip"),m&&m.__esModule&&m||{default:m}).default;h("./../../plugins.js");var t=(c=h("./../../3rdparty/walkontable/src/cell/coords.js"),
c&&c.__esModule&&c||{default:c}).WalkontableCellCoords,v=(b=h("./../../3rdparty/walkontable/src/cell/range.js"),b&&b.__esModule&&b||{default:b}).WalkontableCellRange;Handsontable.hooks.add("afterInit",e);Handsontable.hooks.add("afterUpdateSettings",e);Handsontable.hooks.register("afterCopyLimit")},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../3rdparty/walkontable/src/cell/range.js":6,"./../../helpers.js":42,"./../../plugins.js":45,SheetClip:"SheetClip",copyPaste:"copyPaste"}],55:[function(h,
q,r){function a(){}var e,d;h("./../../plugins.js");var k=(e=h("./../../3rdparty/walkontable/src/cell/range.js"),e&&e.__esModule&&e||{default:e}).WalkontableCellRange,m=(d=h("./../../3rdparty/walkontable/src/selection.js"),d&&d.__esModule&&d||{default:d}).WalkontableSelection,c,b=function(a){var b={row:a.row,col:a.col},b=new m(a,new k(b,b,b));a:{for(var d=0;d<c.view.wt.selections.length;d++)if(c.view.wt.selections[d].settings.className==a.className){a=d;break a}a=-1}0<=a?c.view.wt.selections[a]=b:
c.view.wt.selections.push(b)},p=function(a,b){return"border_row"+a+"col"+b},l=function(a,b){return{className:p(a,b),border:{width:1,color:"#000",cornerVisible:!1},row:a,col:b,top:{hide:!0},right:{hide:!0},bottom:{hide:!0},left:{hide:!0}}},g=function(a){a=document.querySelectorAll("."+a);for(var b=0;b<a.length;b++)if(a[b]&&"TD"!=a[b].nodeName){var c=a[b].parentNode;c.parentNode&&c.parentNode.removeChild(c)}},t=function(a,c,d,f){var e=this.getCellMeta(a,c).borders;e&&void 0!=e.border||(e=l(a,c));e[d]=
f?{hide:!0}:{width:1,color:"#000"};this.setCellMeta(a,c,"borders",e);a=p(a,c);g(a);b(e);this.render()},v=function(a,b,c){if(a.from.row==a.to.row&&a.from.col==a.to.col)"noBorders"==b?(b=a.from.row,a=a.from.col,c=p(b,a),g(c),this.removeCellMeta(b,a,"borders")):t.call(this,a.from.row,a.from.col,b,c);else switch(b){case "noBorders":for(b=a.from.col;b<=a.to.col;b++)for(c=a.from.row;c<=a.to.row;c++){var d=c,f=b,e=p(d,f);g(e);this.removeCellMeta(d,f,"borders")}break;case "top":for(d=a.from.col;d<=a.to.col;d++)t.call(this,
a.from.row,d,b,c);break;case "right":for(c=a.from.row;c<=a.to.row;c++)t.call(this,c,a.to.col,b);break;case "bottom":for(c=a.from.col;c<=a.to.col;c++)t.call(this,a.to.row,c,b);break;case "left":for(c=a.from.row;c<=a.to.row;c++)t.call(this,c,a.from.col,b)}},f=function(a,b){var c=!1;a.getSelectedRange().forAll(function(d,f){var e=a.getCellMeta(d,f).borders;if(e)if(b){if(!e[b].hasOwnProperty("hide"))return c=!0,!1}else return c=!0,!1});return c},n=function(a){return"<span class='selected'>"+String.fromCharCode(10003)+
"</span>"+a};Handsontable.hooks.add("beforeInit",function(){var b;b=this.getSettings().customBorders;b="boolean"===typeof b&&!0===b?!0:"object"===typeof b&&0<b.length?!0:!1;b&&!this.customBorders&&(c=this,this.customBorders=new a)});Handsontable.hooks.add("afterContextMenuDefaultOptions",function(a){this.getSettings().customBorders&&(a.items.push(Handsontable.ContextMenu.SEPARATOR),a.items.push({key:"borders",name:"Borders",submenu:{items:{top:{name:function(){var a="Top";f(this,"top")&&(a=n(a));
return a},callback:function(){var a=f(this,"top");v.call(this,this.getSelectedRange(),"top",a)},disabled:!1},right:{name:function(){var a="Right";f(this,"right")&&(a=n(a));return a},callback:function(){var a=f(this,"right");v.call(this,this.getSelectedRange(),"right",a)},disabled:!1},bottom:{name:function(){var a="Bottom";f(this,"bottom")&&(a=n(a));return a},callback:function(){var a=f(this,"bottom");v.call(this,this.getSelectedRange(),"bottom",a)},disabled:!1},left:{name:function(){var a="Left";
f(this,"left")&&(a=n(a));return a},callback:function(){var a=f(this,"left");v.call(this,this.getSelectedRange(),"left",a)},disabled:!1},remove:{name:"Remove border(s)",callback:function(){v.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!f(this)}}}}}))});Handsontable.hooks.add("afterInit",function(){var a=this.getSettings().customBorders;if(a){for(var c=0;c<a.length;c++)if(a[c].range)for(var d=a[c],f=d.range,e=f.from.row;e<=f.to.row;e++)for(var n=f.from.col;n<=f.to.col;n++){var g=
l(e,n),p=0;e==f.from.row&&(p++,d.hasOwnProperty("top")&&(g.top=d.top));e==f.to.row&&(p++,d.hasOwnProperty("bottom")&&(g.bottom=d.bottom));n==f.from.col&&(p++,d.hasOwnProperty("left")&&(g.left=d.left));n==f.to.col&&(p++,d.hasOwnProperty("right")&&(g.right=d.right));0<p&&(this.setCellMeta(e,n,"borders",g),b(g))}else d=a[c].row,f=a[c].col,e=a[c],n=l(d,f),e.hasOwnProperty("border")&&(n.border=e.border),e.hasOwnProperty("top")&&(n.top=e.top),e.hasOwnProperty("right")&&(n.right=e.right),e.hasOwnProperty("bottom")&&
(n.bottom=e.bottom),e.hasOwnProperty("left")&&(n.left=e.left),this.setCellMeta(d,f,"borders",n),b(n);this.render();this.view.wt.draw(!0)}});Handsontable.CustomBorders=a},{"./../../3rdparty/walkontable/src/cell/range.js":6,"./../../3rdparty/walkontable/src/selection.js":18,"./../../plugins.js":45}],56:[function(h,q,r){function a(){this.callback=this.boundaries=null}Object.defineProperties(r,{DragToScroll:{get:function(){return a}},__esModule:{value:!0}});var e,d=(e=h("./../../eventManager.js"),e&&
e.__esModule&&e||{default:e}).eventManager;h("./../../plugins.js");Handsontable.plugins.DragToScroll=a;a.prototype.setBoundaries=function(a){this.boundaries=a};a.prototype.setCallback=function(a){this.callback=a};a.prototype.check=function(a,b){var d=0,e=0;b<this.boundaries.top?e=b-this.boundaries.top:b>this.boundaries.bottom&&(e=b-this.boundaries.bottom);a<this.boundaries.left?d=a-this.boundaries.left:a>this.boundaries.right&&(d=a-this.boundaries.right);this.callback(d,e)};var k;if("undefined"!==
typeof Handsontable)var m=function(c){c.dragToScrollListening=!1;var b=c.view.wt.wtTable.holder;k=new a;b!==window&&(k.setBoundaries(b.getBoundingClientRect()),k.setCallback(function(a,c){0>a?b.scrollLeft-=50:0<a&&(b.scrollLeft+=50);0>c?b.scrollTop-=20:0<c&&(b.scrollTop+=20)}),c.dragToScrollListening=!0)};Handsontable.hooks.add("afterInit",function(){var a=this,b=d(this);b.addEventListener(document,"mouseup",function(){a.dragToScrollListening=!1});b.addEventListener(document,"mousemove",function(b){a.dragToScrollListening&&
k.check(b.clientX,b.clientY)})});Handsontable.hooks.add("afterDestroy",function(){d(this).clear()});Handsontable.hooks.add("afterOnCellMouseDown",function(){m(this)});Handsontable.hooks.add("afterOnCellCornerMouseDown",function(){m(this)});Handsontable.plugins.DragToScroll=a},{"./../../eventManager.js":41,"./../../plugins.js":45}],57:[function(h,q,r){function a(a){var c=[],b={rows:0,cols:0},e={rows:0,cols:0},l=[],g=[],k={groupIndicatorContainer:"htGroupIndicatorContainer",groupIndicator:function(a){return"ht"+
a+"Group"},groupStart:"htGroupStart",collapseButton:"htCollapseButton",expandButton:"htExpandButton",collapseGroupId:function(a){return"htCollapse-"+a},collapseFromLevel:function(a,b){return"htCollapse"+a+"FromLevel-"+b},clickable:"clickable",levelTrigger:"htGroupLevelTrigger"},v=function(a,b){return function(c,d){return"undefined"===typeof b||"asc"===b?c[a]-d[a]:d[a]-c[a]}},f=function(a,b){for(var c=[];a<=b;)c.push(a++);return c},n=function(a,b,c){var d=[],f={row:null,col:null};if("cols"==a)for(;b<=
c;)f={row:-1,col:b++},d.push(f);else for(;b<=c;)f={row:b++,col:-1},d.push(f);a=w(d);for(d=c=b=0;d<a.length;d++)b+=a[d].filter(function(a){return a.rows}).length,c+=a[d].filter(function(a){return a.cols}).length;return{total:{rows:b,cols:c},groups:a}},w=function(a){for(var b=[],c=0;c<a.length;c++)b.push(h(a[c]));return b},h=function(a,b,d){var f=a.row;a=a.col;for(var e=-1===f?0:f,n=-1===a?0:a,g=[],l=0;l<c.length;l++){var p=c[l],k=p.rows||[],m=p.cols||[];-1===g.indexOf(p.id)&&(-1===k.indexOf(e)&&-1===
m.indexOf(n)||g.push(p))}-1===a?g=g.concat(F()):-1===f&&(g=g.concat(B()));b&&(g=g.filter(function(a){return a.level===b}));d&&("cols"===d?g=g.filter(function(a){return a.cols}):"rows"===d&&(g=g.filter(function(a){return a.rows})));var v=[];return g.filter(function(a){if(-1===v.indexOf(a.id))return v.push(a.id),a})},q=function(a){for(var b=0,d=c.length;b<d;b++)if(c[b].id==a)return c[b];return!1},r=function(a,b){for(var d=0,f=c.length;d<f;d++)if(c[d].level==b&&c[d].rows&&-1<c[d].rows.indexOf(a))return c[d];
return!1},y=function(a,b){for(var d=0,f=c.length;d<f;d++)if(c[d].level==b&&c[d].cols&&-1<c[d].cols.indexOf(a))return c[d];return!1},F=function(){for(var a=[],b=0,d=c.length;b<d;b++)Array.isArray(c[b].cols)&&a.push(c[b]);return a},B=function(){for(var a=[],b=0,d=c.length;b<d;b++)Array.isArray(c[b].rows)&&a.push(c[b]);return a},z=function(a){var b=0;a.length&&a.forEach(function(a){a=a.filter(function(a){return a.cols});a.length&&(a=a.sort(v("level","desc"))[0].level,b<a&&(b=a))});return b},A=function(a){var b=
0;a.length&&a.forEach(function(a){a=a.filter(function(a){return a.rows});a.length&&(a=a.sort(v("level","desc"))[0].level,b<a&&(b=a))});return b},H=function(a,b){for(var c,d=0,f=b.length;d<f;d++)if(b[d].hidden=a,c=b[d].level,l[c]||(l[c]=[]),g[c]||(g[c]=[]),b[d].rows)for(var e=0,n=b[d].rows.length;e<n;e++)l[c][b[d].rows[e]]=0<a?!0:void 0;else if(b[d].cols)for(e=0,n=b[d].cols.length;e<n;e++)g[c][b[d].cols[e]]=0<a?!0:void 0},M=function(a,b,c,d){var f,e;switch(a){case "rows":f=r(b+1,c).id;e=Handsontable.Grouping.getGroupLevelsByRows();
break;case "cols":f=y(b+1,c).id,e=Handsontable.Grouping.getGroupLevelsByCols()}return!!(e[b+1]&&-1<e[b+1].indexOf(c)&&d==f)},O=function(a,b,c,d){var f,e;switch(a){case "rows":f=r(b-1,c).id;e=Handsontable.Grouping.getGroupLevelsByRows();break;case "cols":f=y(b-1,c).id,e=Handsontable.Grouping.getGroupLevelsByCols()}return!!(e[b-1]&&-1<e[b-1].indexOf(c)&&d==f)},U=function(b,c,d,f){var n,k,v=q(f),t=!1,w=function(a){for(var b=!1,d="rows"==a?l:g,f=0;f<=e[a];f++){for(z=c;-1<v[a].indexOf(z);)b=!(!d[f]||!d[f][z]),
z--;if(b)break}return b},h=O(b,c,d,f);d=M(b,c,d,f);var z;switch(b){case "rows":n=Handsontable.Grouping.getGroupLevelsByRows();k=a.countRows();t=w(b);break;case "cols":n=Handsontable.Grouping.getGroupLevelsByCols(),k=a.countCols(),t=w(b)}if(c!=k-1)if(0===c){if(d)return!0}else if(!h||h&&t){if(d)return!0}else if(!n[c-1]&&d)return!0;return!1},D=function(a){for(var b=B(),c=F(),d=0,f=b.length;d<f;d++)if(-1<b[d].rows.indexOf(a.row)&&b[d].hidden)return!0;if(null===a.col)return!1;d=0;for(b=c.length;d<b;d++)if(-1<
c[d].cols.indexOf(a.col)&&c[d].hidden)return!0;return!1};return{getGroups:function(){return c},getLevels:function(){return e},instance:a,baseSpareRows:a.getSettings().minSpareRows,baseSpareCols:a.getSettings().minSpareCols,getRowGroups:B,getColGroups:F,init:function(){var b=a.getSettings().groups;b&&Array.isArray(b)&&Handsontable.Grouping.initGroups(b)},initGroups:function(a){c=[];a.forEach(function(a){var d=[],g=!1,l=!1;Array.isArray(a.rows)?(d=a.rows,g=!0):Array.isArray(a.cols)&&(d=a.cols,l=!0);
a=d[0];d=d[d.length-1];g?(g=n("rows",a,d),g=A(g.groups),e.rows=Math.max(e.rows,g+1),b.rows||(b.rows=B().length),b.rows++,c.push({id:"r"+b.rows,level:g+1,rows:f(a,d),hidden:0})):l&&(g=n("cols",a,d),g=z(g.groups),g===e.cols?e.cols++:g>e.cols&&(e.cols=g+1),b.cols||(b.cols=F().length),b.cols++,c.push({id:"c"+b.cols,level:g+1,cols:f(a,d),hidden:0}))})},resetGroups:function(){c=[];b={rows:0,cols:0};e={rows:0,cols:0};var a,f;for(f in k)if("function"!=typeof k[f]){a=document.querySelectorAll("."+k[f]);for(var n=
0,g=a.length;n<g;n++)d.removeClass(a[n],k[f])}var l=["htGroupColClosest","htGroupCol"];f=0;for(var m=l.length;f<m;f++)for(a=document.querySelectorAll("."+l[f]),n=0,g=a.length;n<g;n++)d.removeClass(a[n],l[f])},updateGroups:function(){var a=this.getSettings().groups;Handsontable.Grouping.resetGroups();Handsontable.Grouping.initGroups(a)},afterGetRowHeader:function(a,b){for(var c=!1,f=0,e=l.length;f<e;f++)l[f]&&!0===l[f][a]&&(c=!0);c?d.addClass(b.parentNode,"hidden"):!c&&d.hasClass(b.parentNode,"hidden")&&
d.removeClass(b.parentNode,"hidden")},afterGetColHeader:function(b,c){var f=this.view.wt.wtSettings.getSetting("rowHeaders").length,f=a.rootElement.querySelectorAll("colgroup col:nth-child("+parseInt(b+f+1,10)+")");if(0!==f.length){for(var e=!1,n=0,l=g.length;n<l;n++)g[n]&&!0===g[n][b]&&(e=!0);if(e)for(n=0,e=f.length;n<e;n++)d.addClass(f[n],"hidden");else if(!e&&d.hasClass(f[0],"hidden"))for(n=0,e=f.length;n<e;n++)d.removeClass(f[n],"hidden")}},groupIndicatorsFactory:function(c,f){var n,v,w,h,z,A;
switch(f){case "horizontal":n=Handsontable.Grouping.getGroupLevelsByCols();v=function(a,b){return y(a,b).id};w="cols";h=function(a,b){return y(a-1,b)};z=function(a){if(1===a.length){var b=a[0];a[0]=function(a,c,f){-1>a?D()(a,c,f):(d.removeClass(c,k.groupIndicatorContainer),b(a,c,f))}}return function(){return a}};A=!0;break;case "vertical":n=Handsontable.Grouping.getGroupLevelsByRows(),v=function(a,b){return r(a,b).id},w="rows",h=function(a,b){return r(a-1,b)},z=function(a){return a}}var I=function(a){var b=
document.createElement("div");a.appendChild(b);return{button:b,addClass:function(a){d.addClass(b,a)}}},D=function(){var b=f.charAt(0).toUpperCase()+f.slice(1);return function(c,f,z){z++;for(var x,D;x=f.lastChild;)f.removeChild(x);d.addClass(f,k.groupIndicatorContainer);x=v(c,z);if(-1<c&&n[c]&&-1<n[c].indexOf(z)){D=I(f);D.addClass(k.groupIndicator(b));U(w,c,z,x)&&D.addClass(k.groupStart);var H;a:{var q=w,N=z;if(0!==c){var B,Z=O(q,c,N,x),N=M(q,c,N,x),F=!1;switch(q){case "rows":H=Handsontable.Grouping.getGroupLevelsByRows();
B=a.countRows();for(q=0;q<=e.rows;q++)if(l[q]&&l[q][c+1]){F=!0;break}break;case "cols":for(H=Handsontable.Grouping.getGroupLevelsByCols(),B=a.countCols(),q=0;q<=e.cols;q++)if(g[q]&&g[q][c+1]){F=!0;break}}if(Z)if(c==B-1){H=!0;break a}else if(!N||N&&F){H=!0;break a}else if(!H[c+1]){H=!0;break a}}H=!1}H&&(D.button.appendChild(document.createTextNode("-")),D.addClass(k.collapseButton),D.button.id=k.collapseGroupId(x),D.button.setAttribute("data-level",z),D.button.setAttribute("data-type",w))}if(A&&(H=
d.index(f.parentNode),-1===c||-1>c&&H===Handsontable.Grouping.getLevels().cols+1||0===H&&0===Handsontable.Grouping.getLevels().cols))if(D=I(f),D.addClass(k.levelTrigger),-1===c)D.button.id=k.collapseFromLevel("Cols",z),D.button.appendChild(document.createTextNode(z));else if(-1>c&&H===Handsontable.Grouping.getLevels().cols+1||0===H&&0===Handsontable.Grouping.getLevels().cols)H=d.index(f)+1,D.button.id=k.collapseFromLevel("Rows",H),D.button.appendChild(document.createTextNode(H));D=w;H=z;var X;switch(D){case "rows":X=
r(c-1,H).id;break;case "cols":X=y(c-1,H).id}X&&0<c&&O(D,c-1,H,X)&&X!=x?(x=document.createElement("DIV"),d.addClass(x,k.expandButton),x.id="htExpand-"+X,x.appendChild(document.createTextNode("+")),x.setAttribute("data-level",H),x.setAttribute("data-type",D),x.setAttribute("data-hidden","1"),f.appendChild(x),f=x):f=null;0<c&&(c=h(c-1,z),f&&c.hidden&&d.addClass(f,k.clickable));a:for(c=document.querySelectorAll("colgroup"),z=0,f=c.length;z<f;z++){X=c[z].querySelectorAll("col.rowHeader");if(0===X.length)break a;
x=0;for(D=X.length+1;x<D;x++){if(2==D)break a;x<Handsontable.Grouping.getLevels().rows+1&&(x==Handsontable.Grouping.getLevels().rows?d.addClass(X[x],"htGroupColClosest"):d.addClass(X[x],"htGroupCol"))}}}};c=z(c);if(0<b[w])for(z=0;z<e[w]+1;z++)Array.isArray(c)||(c="function"===typeof c?c():Array(c)),c.unshift(D())},getGroupLevelsByRows:function(){for(var a=B(),b=[],c=0,d=a.length;c<d;c++)if(a[c].rows)for(var f=0,e=a[c].rows.length;f<e;f++)b[a[c].rows[f]]||(b[a[c].rows[f]]=[]),b[a[c].rows[f]].push(a[c].level);
return b},getGroupLevelsByCols:function(){for(var a=F(),b=[],c=0,d=a.length;c<d;c++)if(a[c].cols)for(var f=0,e=a[c].cols.length;f<e;f++)b[a[c].cols[f]]||(b[a[c].cols[f]]=[]),b[a[c].cols[f]].push(a[c].level);return b},toggleGroupVisibility:function(b,f,n){if(d.hasClass(b.target,k.expandButton)||d.hasClass(b.target,k.collapseButton)||d.hasClass(b.target,k.levelTrigger)){var v=b.target;f=v.id.split("-");n=[];var w,h;if(-1<v.className.indexOf(k.levelTrigger)){var z;n=[];h=[];for(var A=-1<v.id.indexOf("Rows")?
"rows":"cols",v=1,y=e[A];v<=y;v++){if("rows"==A){z=v;for(var I=[],D=0,B=c.length;D<B;D++)c[D].rows&&c[D].level===z&&I.push(c[D])}else for(z=v,I=[],D=0,B=c.length;D<B;D++)c[D].cols&&c[D].level===z&&I.push(c[D]);z=I;if(v>=parseInt(f[1],10))for(I=0,D=z.length;I<D;I++)h.push(z[I]);else for(I=0,D=z.length;I<D;I++)n.push(z[I])}H(!0,h);H(!1,n)}else f=v.id.split("-"),f=f[1],parseInt(v.getAttribute("data-level"),10),w=v.getAttribute("data-type"),h=parseInt(v.getAttribute("data-hidden")),h=isNaN(h)?1:h?0:1,
v.setAttribute("data-hidden",h.toString()),n.push(q(f)),H(h,n);w=w||A;a:{switch(w){case "rows":A=e.rows;for(f=0;f<=A;f++)if(l[f]&&l[f][a.countRows()-1]){A=!0;break a}break;case "cols":for(A=e.cols,f=0;f<=A;f++)if(g[f]&&g[f][a.countCols()-1]){A=!0;break a}}A=!1}f=w.charAt(0).toUpperCase()+w.slice(1);n=Handsontable.Grouping["baseSpare"+f];A?0==n&&(a.alter("insert_"+w.slice(0,-1),a["count"+f]()),Handsontable.Grouping["dummy"+w.slice(0,-1)]=!0):0==n&&Handsontable.Grouping["dummy"+w.slice(0,-1)]&&(a.alter("remove_"+
w.slice(0,-1),a["count"+f]()-1),Handsontable.Grouping["dummy"+w.slice(0,-1)]=!1);a.render();b.stopImmediatePropagation()}},modifySelectionFactory:function(a){var b=this.instance,c,d=new WalkontableCellCoords(0,0),f=function(a,b){var c=0;switch(a){case "down":for(;D(b);)c++,b.row+=1;break;case "up":for(;D(b);)c--,--b.row;break;case "right":for(;D(b);)c++,b.col+=1;break;case "left":for(;D(b);)c--,--b.col}return c},e=function(a,b){0<a.row?D(b)&&(a.row+=f("down",b)):0>a.row&&D(b)&&(a.row+=f("up",b));
0<a.col?D(b)&&(a.col+=f("right",b)):0>a.col&&D(b)&&(a.col+=f("left",b))};switch(a){case "start":return function(a){c=b.getSelected();d.row=c[0]+a.row;d.col=c[1]+a.col;e(a,d)};case "end":return function(a){c=b.getSelected();d.row=c[2]+a.row;d.col=c[3]+a.col;e(a,d)}}},modifyRowHeight:function(b,c){if(a.view.wt.wtTable.rowFilter&&D({row:c,col:null}))return 0},validateGroups:function(){for(var b=function(a,b){if(a[0]<b[0]&&a[1]<b[1]&&b[0]<=a[1]||a[0]>b[0]&&b[1]<a[1]&&a[0]<=b[1])return!0},c=a.getSettings().groups,
d=[],f=[],e=0,n=c.length;e<n;e++)if(c[e].rows){if(1===c[e].rows.length)throw Error("Grouping error:  Group {"+c[e].rows[0]+"} is invalid. Cannot define single-entry groups.");if(0===c[e].rows.length)throw Error("Grouping error:  Cannot define empty groups.");f.push(c[e].rows);for(var g=0,l=f.length;g<l;g++)if(b(c[e].rows,f[g]))throw Error("Grouping error:  ranges {"+c[e].rows[0]+", "+c[e].rows[1]+"} and {"+f[g][0]+", "+f[g][1]+"} are overlapping.");}else if(c[e].cols){if(1===c[e].cols.length)throw Error("Grouping error:  Group {"+
c[e].cols[0]+"} is invalid. Cannot define single-entry groups.");if(0===c[e].cols.length)throw Error("Grouping error:  Cannot define empty groups.");d.push(c[e].cols);g=0;for(l=d.length;g<l;g++)if(b(c[e].cols,d[g]))throw Error("Grouping error:  ranges {"+c[e].cols[0]+", "+c[e].cols[1]+"} and {"+d[g][0]+", "+d[g][1]+"} are overlapping.");}return!0},afterGetRowHeaderRenderers:function(a){Handsontable.Grouping.groupIndicatorsFactory(a,"vertical")},afterGetColumnHeaderRenderers:function(a){Handsontable.Grouping.groupIndicatorsFactory(a,
"horizontal")},hookProxy:function(b,c){return function(){if(a.getSettings().groups)return c?Handsontable.Grouping[b](c).apply(this,arguments):Handsontable.Grouping[b].apply(this,arguments)}}}}var e,d=(e=h("./../../dom.js"),e&&e.__esModule&&e||{default:e});h("./../../plugins.js");a.prototype.beforeInit=function(){};var k=function(){if(this.getSettings().groups){var d={};Handsontable.Grouping=new a(this);this.getSettings().rowHeaders||(d.rowHeaders=!0);this.getSettings().colHeaders||(d.colHeaders=!0);
(d.colHeaders||d.rowHeaders)&&this.updateSettings(d);Handsontable.Grouping.validateGroups()&&(this.addHook("beforeInit",Handsontable.Grouping.hookProxy("init")),this.addHook("afterUpdateSettings",Handsontable.Grouping.hookProxy("updateGroups")),this.addHook("afterGetColumnHeaderRenderers",Handsontable.Grouping.hookProxy("afterGetColumnHeaderRenderers")),this.addHook("afterGetRowHeaderRenderers",Handsontable.Grouping.hookProxy("afterGetRowHeaderRenderers")),this.addHook("afterGetRowHeader",Handsontable.Grouping.hookProxy("afterGetRowHeader")),
this.addHook("afterGetColHeader",Handsontable.Grouping.hookProxy("afterGetColHeader")),this.addHook("beforeOnCellMouseDown",Handsontable.Grouping.hookProxy("toggleGroupVisibility")),this.addHook("modifyTransformStart",Handsontable.Grouping.hookProxy("modifySelectionFactory","start")),this.addHook("modifyTransformEnd",Handsontable.Grouping.hookProxy("modifySelectionFactory","end")),this.addHook("modifyRowHeight",Handsontable.Grouping.hookProxy("modifyRowHeight")))}};Handsontable.hooks.add("beforeInit",
k);Handsontable.hooks.add("afterUpdateSettings",function(){this.getSettings().groups&&!Handsontable.Grouping?k.call(this,arguments):!this.getSettings().groups&&Handsontable.Grouping&&(Handsontable.Grouping.resetGroups(),Handsontable.Grouping=void 0)});Handsontable.plugins.Grouping=a},{"./../../dom.js":27,"./../../plugins.js":45}],58:[function(h,q,r){function a(a){function d(b){b.items.push(Handsontable.ContextMenu.SEPARATOR,{key:"freeze_column",name:function(){return a.getSelected()[1]>f-1?"Freeze this column":
"Unfreeze this column"},disabled:function(){var b=a.getSelected();return b[1]!==b[3]},callback:function(){var b=a.getSelected()[1];b>f-1?g(b):t(b)}})}function k(){a.updateSettings({fixedColumnsLeft:f+1});f++}function m(){a.updateSettings({fixedColumnsLeft:f-1});f--}function c(c){a.manualColumnPositions&&0!==a.manualColumnPositions.length||a.manualColumnPositions||(a.manualColumnPositions=[]);c?a.manualColumnPositions[c]||b(c+1):b(a.countCols())}function b(b){if(a.manualColumnPositions.length<b)for(var c=
a.manualColumnPositions.length;c<b;c++)a.manualColumnPositions[c]=c}function p(b,c,d,g){null==d&&(d=b);"freeze"===g?a.manualColumnPositions.splice(f,0,a.manualColumnPositions.splice(c,1)[0]):"unfreeze"===g&&a.manualColumnPositions.splice(d,0,a.manualColumnPositions.splice(c,1)[0])}function l(b){var c=f,d=a.manualColumnPositions[c];for(b=a.manualColumnPositions[b];d<b;)c++,d=a.manualColumnPositions[c];return c-1}function g(b){if(!(b<=f-1)){var d=a.manualColumnPositions[b]||b;c(d);p(d,b,null,"freeze");
k();a.view.wt.wtOverlays.leftOverlay.refresh();a.view.wt.wtOverlays.adjustElementsSize()}}function t(b){if(!(b>f-1)){var d=l(b),g=a.manualColumnPositions[b]||b;c(g);p(g,b,d,"unfreeze");m();a.view.wt.wtOverlays.leftOverlay.refresh()}}function v(b){return 1<this.manualColumnPositionsPluginUsages.length?b:a.manualColumnPositions[b]}var f=a.getSettings().fixedColumnsLeft;return{init:function(){"undefined"!==typeof a.manualColumnPositionsPluginUsages?a.manualColumnPositionsPluginUsages.push("manualColumnFreeze"):
a.manualColumnPositionsPluginUsages=["manualColumnFreeze"];a.addHook("modifyCol",v);a.addHook("afterContextMenuDefaultOptions",d)},freezeColumn:g,unfreezeColumn:t,helpers:{addFixedColumn:k,removeFixedColumn:m,checkPositionData:c,modifyColumnOrder:p,getBestColumnReturnPosition:l}}}Object.defineProperties(r,{ManualColumnFreeze:{get:function(){return a}},__esModule:{value:!0}});h("./../../plugins.js");Handsontable.hooks.add("beforeInit",function(){this.getSettings().manualColumnFreeze&&(Handsontable.plugins.manualColumnFreeze=
a,this.manualColumnFreeze=new a(this),this.manualColumnFreeze.init.call(this))})},{"./../../plugins.js":45}],59:[function(h,q,r){function a(){function a(b){h=this;q=b;b=this.view.wt.wtTable.getCoords(b).col;0<=b&&(k=b,b=q.getBoundingClientRect(),n=b.left,r.style.top=b.top+"px",r.style.left=n+"px",h.rootElement.appendChild(r))}function d(){c.addClass(r,"active");c.addClass(y,"active");var a=q.getBoundingClientRect();y.style.width=a.width+"px";y.style.height=this.view.maximumVisibleElementHeight(0)+
"px";y.style.top=r.style.top;y.style.left=n+"px";this.rootElement.appendChild(y)}var e,p,f,n,k,h,q,r=document.createElement("DIV"),y=document.createElement("DIV"),F=b(this);r.className="manualColumnMover";y.className="manualColumnMoverGuide";var B=function(){Handsontable.hooks.run(this,"persistentStateSave","manualColumnPositions",this.manualColumnPositions)},z=function(a){if("BODY"!=a.tagName){if("THEAD"==a.parentNode.tagName)return!0;a=a.parentNode;return z(a)}return!1},A=function(a){return"TABLE"!=
a.tagName?"TH"==a.tagName?a:A(a.parentNode):null},H=function(){var b=this,h;F.addEventListener(b.rootElement,"mouseover",function(c){if(z(c.target)){var d=A(c.target);d&&(h?(d=b.view.wt.wtTable.getCoords(d).col,0<=d&&(p=d,d=p-e,c=c.target.getBoundingClientRect(),r.style.left=0<d?c.left+c.width-6+"px":c.left+"px")):a.call(b,d))}});F.addEventListener(b.rootElement,"mousedown",function(a){c.hasClass(a.target,"manualColumnMover")&&(f=m.pageX(a),d.call(b),h=b,p=e=k)});F.addEventListener(window,"mousemove",
function(a){h&&(a=m.pageX(a)-f,y.style.left=n+a+"px")});F.addEventListener(window,"mouseup",function(d){h&&(c.removeClass(r,"active"),c.removeClass(y,"active"),h=!1,O(b.manualColumnPositions,b.countCols()),b.manualColumnPositions.splice(p,0,b.manualColumnPositions.splice(e,1)[0]),b.forceFullRender=!0,b.view.render(),B.call(b),Handsontable.hooks.run(b,"afterColumnMove",e,p),a.call(b,q))});b.addHook("afterDestroy",M)},M=function(){F.clear()},O=function(a,b){if(a.length<b)for(var c=a.length;c<b;c++)a[c]=
c};this.beforeInit=function(){this.manualColumnPositions=[]};this.init=function(a){if(this.getSettings().manualColumnMove){var b=this.getSettings().manualColumnMove,c;c={};Handsontable.hooks.run(this,"persistentStateLoad","manualColumnPositions",c);c=c.value;"undefined"!=typeof c?this.manualColumnPositions=c:Array.isArray(b)?this.manualColumnPositions=b:this.manualColumnPositions=[];"afterInit"==a&&("undefined"!=typeof this.manualColumnPositionsPluginUsages?this.manualColumnPositionsPluginUsages.push("manualColumnMove"):
this.manualColumnPositionsPluginUsages=["manualColumnMove"],H.call(this),0<this.manualColumnPositions.length&&(this.forceFullRender=!0,this.render()))}else a=this.manualColumnPositionsPluginUsages?this.manualColumnPositionsPluginUsages.indexOf("manualColumnMove"):-1,-1<a&&(M.call(this),this.manualColumnPositions=[],this.manualColumnPositionsPluginUsages[a]=void 0)};this.modifyCol=function(a){return this.getSettings().manualColumnMove?("undefined"===typeof this.manualColumnPositions[a]&&O(this.manualColumnPositions,
a+1),this.manualColumnPositions[a]):a};this.afterRemoveCol=function(a,b){if(this.getSettings().manualColumnMove){var c,d=this.manualColumnPositions;c=d.splice(a,b);this.manualColumnPositions=d=d.map(function(a){var b,d=a;for(b=0;b<c.length;b++)a>c[b]&&d--;return d})}};this.afterCreateCol=function(a,b){if(this.getSettings().manualColumnMove){var c=this.manualColumnPositions;if(c.length){for(var d=[],f=0;f<b;f++)d.push(a+f);a>=c.length?c.concat(d):(c=c.map(function(c){return c>=a?c+b:c}),c.splice.apply(c,
[a,0].concat(d)));this.manualColumnPositions=c}}}}Object.defineProperties(r,{ManualColumnMove:{get:function(){return a}},__esModule:{value:!0}});var e,d,k,m=(e=h("./../../helpers.js"),e&&e.__esModule&&e||{default:e}),c=(d=h("./../../dom.js"),d&&d.__esModule&&d||{default:d}),b=(k=h("./../../eventManager.js"),k&&k.__esModule&&k||{default:k}).eventManager;h("./../../plugins.js");var p=new a;Handsontable.hooks.add("beforeInit",p.beforeInit);Handsontable.hooks.add("afterInit",function(){p.init.call(this,
"afterInit")});Handsontable.hooks.add("afterUpdateSettings",function(){p.init.call(this,"afterUpdateSettings")});Handsontable.hooks.add("modifyCol",p.modifyCol);Handsontable.hooks.add("afterRemoveCol",p.afterRemoveCol);Handsontable.hooks.add("afterCreateCol",p.afterCreateCol);Handsontable.hooks.register("afterColumnMove")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],60:[function(h,q,r){function a(){function a(b){n=this;e=b;b=this.view.wt.wtTable.getCoords(b).col;
0<=b&&(p=b,b=e.getBoundingClientRect(),r=b.left-6,q=parseInt(b.width,10),y.style.top=b.top+"px",y.style.left=r+q+"px",n.rootElement.appendChild(y))}function d(){c.addClass(y,"active");c.addClass(F,"active");F.style.top=y.style.top;F.style.left=y.style.left;F.style.height=this.view.maximumVisibleElementHeight(0)+"px";this.rootElement.appendChild(F)}var e,p,f,n,k,h,q,r,y=document.createElement("DIV"),F=document.createElement("DIV"),B=b(this);y.className="manualColumnResizer";F.className="manualColumnResizerGuide";
var z=function(){Handsontable.hooks.run(this,"persistentStateSave","manualColumnWidths",this.manualColumnWidths)},A=function(a){if("BODY"!=a.tagName){if("THEAD"==a.parentNode.tagName)return!0;a=a.parentNode;return A(a)}return!1},H=function(a){return"TABLE"!=a.tagName?"TH"==a.tagName?a:H(a.parentNode):null},M=function(){var b=this,n,M=0,S=null;B.addEventListener(b.rootElement,"mouseover",function(c){A(c.target)&&(c=H(c.target))&&(n||a.call(b,c))});B.addEventListener(b.rootElement,"mousedown",function(a){c.hasClass(a.target,
"manualColumnResizer")&&(d.call(b),n=b,null==S&&(S=setTimeout(function(){2<=M&&(k=b.determineColumnWidth.call(b,p),U(p,k),b.forceFullRender=!0,b.view.render(),Handsontable.hooks.run(b,"afterColumnResize",p,k));M=0;S=null},500),b._registerTimeout(S)),M++,h=m.pageX(a),k=q)});B.addEventListener(window,"mousemove",function(a){n&&(f=q+(m.pageX(a)-h),k=U(p,f),y.style.left=r+f+"px",F.style.left=y.style.left)});B.addEventListener(window,"mouseup",function(){n&&(c.removeClass(y,"active"),c.removeClass(F,"active"),
n=!1,k!=q&&(b.forceFullRender=!0,b.view.render(),b.view.wt.wtOverlays.adjustElementsSize(),z.call(b),Handsontable.hooks.run(b,"afterColumnResize",p,k)),a.call(b,e))});b.addHook("afterDestroy",O)},O=function(){B.clear()};this.beforeInit=function(){this.manualColumnWidths=[]};this.init=function(a){if(this.getSettings().manualColumnResize){var b=this.getSettings().manualColumnResize,c;c={};Handsontable.hooks.run(this,"persistentStateLoad","manualColumnWidths",c);c=c.value;"undefined"!=typeof this.manualColumnWidthsPluginUsages?
this.manualColumnWidthsPluginUsages.push("manualColumnResize"):this.manualColumnWidthsPluginUsages=["manualColumnResize"];"undefined"!=typeof c?this.manualColumnWidths=c:Array.isArray(b)?this.manualColumnWidths=b:this.manualColumnWidths=[];"afterInit"==a&&(M.call(this),0<this.manualColumnWidths.length&&(this.forceFullRender=!0,this.render()))}else-1<(this.manualColumnWidthsPluginUsages?this.manualColumnWidthsPluginUsages.indexOf("manualColumnResize"):-1)&&(O.call(this),this.manualColumnWidths=[])};
var U=function(a,b){b=Math.max(b,20);a=Handsontable.hooks.run(n,"modifyCol",a);return n.manualColumnWidths[a]=b};this.modifyColWidth=function(a,b){b=this.runHooks("modifyCol",b);return this.getSettings().manualColumnResize&&this.manualColumnWidths[b]?this.manualColumnWidths[b]:a}}Object.defineProperties(r,{ManualColumnResize:{get:function(){return a}},__esModule:{value:!0}});var e,d,k,m=(e=h("./../../helpers.js"),e&&e.__esModule&&e||{default:e}),c=(d=h("./../../dom.js"),d&&d.__esModule&&d||{default:d}),
b=(k=h("./../../eventManager.js"),k&&k.__esModule&&k||{default:k}).eventManager;h("./../../plugins.js");var p=new a;Handsontable.hooks.add("beforeInit",p.beforeInit);Handsontable.hooks.add("afterInit",function(){p.init.call(this,"afterInit")});Handsontable.hooks.add("afterUpdateSettings",function(){p.init.call(this,"afterUpdateSettings")});Handsontable.hooks.add("modifyColWidth",p.modifyColWidth);Handsontable.hooks.register("afterColumnResize")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,
"./../../plugins.js":45}],61:[function(h,q,r){function a(){function a(b){h=b;b=this.view.wt.wtTable.getCoords(b).row;0<=b&&(k=b,b=h.getBoundingClientRect(),n=b.top,q.style.top=n+"px",q.style.left=b.left+"px",this.rootElement.appendChild(q))}function d(){c.addClass(q,"active");c.addClass(r,"active");var a=h.getBoundingClientRect();r.style.width=this.view.maximumVisibleElementWidth(0)+"px";r.style.height=a.height+"px";r.style.top=n+"px";r.style.left=q.style.left;this.rootElement.appendChild(r)}var e,
p,f,n,k,h,q=document.createElement("DIV"),r=document.createElement("DIV"),y=b(this);q.className="manualRowMover";r.className="manualRowMoverGuide";var F=function(){Handsontable.hooks.run(this,"persistentStateSave","manualRowPositions",this.manualRowPositions)},B=function(a){if("BODY"!=a.tagName){if("TBODY"==a.parentNode.tagName)return!0;a=a.parentNode;return B(a)}return!1},z=function(a){return"TABLE"!=a.tagName?"TH"==a.tagName?a:z(a.parentNode):null},A=function(){var b=this,A;y.addEventListener(b.rootElement,
"mouseover",function(c){if(B(c.target)){var d=z(c.target);d&&(A?(p=b.view.wt.wtTable.getCoords(d).row,c=p-e,d=d.getBoundingClientRect(),q.style.top=0<c?d.top+d.height-6+"px":d.top+"px"):a.call(b,d))}});y.addEventListener(b.rootElement,"mousedown",function(a){c.hasClass(a.target,"manualRowMover")&&(f=m.pageY(a),d.call(b),A=b,p=e=k)});y.addEventListener(window,"mousemove",function(a){A&&(a=m.pageY(a)-f,r.style.top=n+a+"px")});y.addEventListener(window,"mouseup",function(d){A&&(c.removeClass(q,"active"),
c.removeClass(r,"active"),A=!1,M(b.manualRowPositions,b.countRows()),b.manualRowPositions.splice(p,0,b.manualRowPositions.splice(e,1)[0]),b.forceFullRender=!0,b.view.render(),F.call(b),Handsontable.hooks.run(b,"afterRowMove",e,p),a.call(b,h))});b.addHook("afterDestroy",H)},H=function(){y.clear()},M=function(a,b){if(a.length<b)for(var c=a.length;c<b;c++)a[c]=c};this.beforeInit=function(){this.manualRowPositions=[]};this.init=function(a){if(this.getSettings().manualRowMove){var b=this.getSettings().manualRowMove,
c;c={};Handsontable.hooks.run(this,"persistentStateLoad","manualRowPositions",c);c=c.value;"undefined"!=typeof this.manualRowPositionsPluginUsages?this.manualRowPositionsPluginUsages.push("manualColumnMove"):this.manualRowPositionsPluginUsages=["manualColumnMove"];"undefined"!=typeof c?this.manualRowPositions=c:Array.isArray(b)?this.manualRowPositions=b:this.manualRowPositions=[];"afterInit"===a&&(A.call(this),0<this.manualRowPositions.length&&(this.forceFullRender=!0,this.render()))}else a=this.manualRowPositionsPluginUsages?
this.manualRowPositionsPluginUsages.indexOf("manualColumnMove"):-1,-1<a&&(H.call(this),this.manualRowPositions=[],this.manualRowPositionsPluginUsages[a]=void 0)};this.modifyRow=function(a){return this.getSettings().manualRowMove?("undefined"===typeof this.manualRowPositions[a]&&M(this.manualRowPositions,a+1),this.manualRowPositions[a]):a}}Object.defineProperties(r,{ManualRowMove:{get:function(){return a}},__esModule:{value:!0}});var e,d,k,m=(e=h("./../../helpers.js"),e&&e.__esModule&&e||{default:e}),
c=(d=h("./../../dom.js"),d&&d.__esModule&&d||{default:d}),b=(k=h("./../../eventManager.js"),k&&k.__esModule&&k||{default:k}).eventManager;h("./../../plugins.js");var p=new a;Handsontable.hooks.add("beforeInit",p.beforeInit);Handsontable.hooks.add("afterInit",function(){p.init.call(this,"afterInit")});Handsontable.hooks.add("afterUpdateSettings",function(){p.init.call(this,"afterUpdateSettings")});Handsontable.hooks.add("modifyRow",p.modifyRow);Handsontable.hooks.register("afterRowMove")},{"./../../dom.js":27,
"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],62:[function(h,q,r){function a(){function a(b){n=this;e=b;b=this.view.wt.wtTable.getCoords(b).row;0<=b&&(p=b,b=e.getBoundingClientRect(),r=b.top-6,q=parseInt(b.height,10),y.style.left=b.left+"px",y.style.top=r+q+"px",n.rootElement.appendChild(y))}function d(){c.addClass(y,"active");c.addClass(F,"active");F.style.top=y.style.top;F.style.left=y.style.left;F.style.width=this.view.maximumVisibleElementWidth(0)+"px";this.rootElement.appendChild(F)}
var e,p,f,n,k,h,q,r,y=document.createElement("DIV"),F=document.createElement("DIV"),B=b(this);y.className="manualRowResizer";F.className="manualRowResizerGuide";var z=function(){Handsontable.hooks.run(this,"persistentStateSave","manualRowHeights",this.manualRowHeights)},A=function(a){if("BODY"!=a.tagName){if("TBODY"==a.parentNode.tagName)return!0;a=a.parentNode;return A(a)}return!1},H=function(a){return"TABLE"!=a.tagName?"TH"==a.tagName?a:H(a.parentNode):null},M=function(){var b=this,n,M=0,S=null;
B.addEventListener(b.rootElement,"mouseover",function(c){A(c.target)&&(c=H(c.target))&&(n||a.call(b,c))});B.addEventListener(b.rootElement,"mousedown",function(a){c.hasClass(a.target,"manualRowResizer")&&(d.call(b),n=b,null==S&&(S=setTimeout(function(){2<=M&&(U(p,null),b.forceFullRender=!0,b.view.render(),Handsontable.hooks.run(b,"afterRowResize",p,k));M=0;S=null},500),b._registerTimeout(S)),M++,h=m.pageY(a),k=q)});B.addEventListener(window,"mousemove",function(a){n&&(f=q+(m.pageY(a)-h),k=U(p,f),
y.style.top=r+f+"px",F.style.top=y.style.top)});B.addEventListener(window,"mouseup",function(d){n&&(c.removeClass(y,"active"),c.removeClass(F,"active"),n=!1,k!=q&&(b.forceFullRender=!0,b.view.render(),z.call(b),Handsontable.hooks.run(b,"afterRowResize",p,k)),a.call(b,e))});b.addHook("afterDestroy",O)},O=function(){B.clear()};this.beforeInit=function(){this.manualRowHeights=[]};this.init=function(a){if(this.getSettings().manualRowResize){var b=this.getSettings().manualRowResize,c;c={};Handsontable.hooks.run(this,
"persistentStateLoad","manualRowHeights",c);c=c.value;"undefined"!=typeof this.manualRowHeightsPluginUsages?this.manualRowHeightsPluginUsages.push("manualRowResize"):this.manualRowHeightsPluginUsages=["manualRowResize"];"undefined"!=typeof c?this.manualRowHeights=c:Array.isArray(b)?this.manualRowHeights=b:this.manualRowHeights=[];"afterInit"===a?(M.call(this),0<this.manualRowHeights.length&&(this.forceFullRender=!0,this.render())):(this.forceFullRender=!0,this.render())}else a=this.manualRowHeightsPluginUsages?
this.manualRowHeightsPluginUsages.indexOf("manualRowResize"):-1,-1<a&&(O.call(this),this.manualRowHeights=[],this.manualRowHeightsPluginUsages[a]=void 0)};var U=function(a,b){a=Handsontable.hooks.run(n,"modifyRow",a);return n.manualRowHeights[a]=b};this.modifyRowHeight=function(a,b){return this.getSettings().manualRowResize&&(b=this.runHooks("modifyRow",b),void 0!==this.manualRowHeights[b])?this.manualRowHeights[b]:a}}Object.defineProperties(r,{ManualRowResize:{get:function(){return a}},__esModule:{value:!0}});
var e,d,k,m=(e=h("./../../helpers.js"),e&&e.__esModule&&e||{default:e}),c=(d=h("./../../dom.js"),d&&d.__esModule&&d||{default:d}),b=(k=h("./../../eventManager.js"),k&&k.__esModule&&k||{default:k}).eventManager;h("./../../plugins.js");var p=new a;Handsontable.hooks.add("beforeInit",p.beforeInit);Handsontable.hooks.add("afterInit",function(){p.init.call(this,"afterInit")});Handsontable.hooks.add("afterUpdateSettings",function(){p.init.call(this,"afterUpdateSettings")});Handsontable.hooks.add("modifyRowHeight",
p.modifyRowHeight);Handsontable.hooks.register("afterRowResize")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],63:[function(h,q,r){function a(){var a=[];a.getInfo=function(a,b){for(var c=0,d=this.length;c<d;c++)if(this[c].row<=a&&this[c].row+this[c].rowspan-1>=a&&this[c].col<=b&&this[c].col+this[c].colspan-1>=b)return this[c]};a.setInfo=function(a){for(var b=0,c=this.length;b<c;b++)if(this[b].row===a.row&&this[b].col===a.col){this[b]=a;return}this.push(a)};
a.removeInfo=function(a,b){for(var c=0,d=this.length;c<d;c++)if(this[c].row===a&&this[c].col===b){this.splice(c,1);break}};return a}function e(b){this.mergedCellInfoCollection=new a;if(Array.isArray(b))for(var c=0,d=b.length;c<d;c++)this.mergedCellInfoCollection.setInfo(b[c])}Object.defineProperties(r,{MergeCells:{get:function(){return e}},__esModule:{value:!0}});var d,k,m;h("./../../plugins.js");var c=(d=h("./../../3rdparty/walkontable/src/cell/coords.js"),d&&d.__esModule&&d||{default:d}).WalkontableCellCoords,
b=(k=h("./../../3rdparty/walkontable/src/cell/range.js"),k&&k.__esModule&&k||{default:k}).WalkontableCellRange,p=(m=h("./../../3rdparty/walkontable/src/table.js"),m&&m.__esModule&&m||{default:m}).WalkontableTable;e.prototype.canMergeRange=function(a){return!a.isSingle()};e.prototype.mergeRange=function(a){if(this.canMergeRange(a)){var b=a.getTopLeftCorner();a=a.getBottomRightCorner();var c={};c.row=b.row;c.col=b.col;c.rowspan=a.row-b.row+1;c.colspan=a.col-b.col+1;this.mergedCellInfoCollection.setInfo(c)}};
e.prototype.mergeOrUnmergeSelection=function(a){this.mergedCellInfoCollection.getInfo(a.from.row,a.from.col)?this.unmergeSelection(a.from):this.mergeSelection(a)};e.prototype.mergeSelection=function(a){this.mergeRange(a)};e.prototype.unmergeSelection=function(a){a=this.mergedCellInfoCollection.getInfo(a.row,a.col);this.mergedCellInfoCollection.removeInfo(a.row,a.col)};e.prototype.applySpanProperties=function(a,b,c){var d=this.mergedCellInfoCollection.getInfo(b,c);d?d.row===b&&d.col===c?(a.setAttribute("rowspan",
d.rowspan),a.setAttribute("colspan",d.colspan)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none"):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"))};e.prototype.modifyTransform=function(a,d,f){var e=f.row,g=f.col;if("modifyTransformStart"==a){this.lastDesiredCoords||(this.lastDesiredCoords=new c(null,null));var l=new c(d.highlight.row,d.highlight.col),p=this.mergedCellInfoCollection.getInfo(l.row,l.col);a=0;for(var k=this.mergedCellInfoCollection.length;a<
k;a++){var m=this.mergedCellInfoCollection[a],m=new c(m.row+m.rowspan-1,m.col+m.colspan-1);if(d.includes(m))break}if(p){var m=new c(p.row,p.col),h=new c(p.row+p.rowspan-1,p.col+p.colspan-1);(new b(m,m,h)).includes(this.lastDesiredCoords)||(this.lastDesiredCoords=new c(null,null));e=this.lastDesiredCoords.row?this.lastDesiredCoords.row-l.row:e;g=this.lastDesiredCoords.col?this.lastDesiredCoords.col-l.col:g;0<f.row?e=p.row+p.rowspan-1-l.row+f.row:0>f.row&&(e=l.row-p.row+f.row);0<f.col?g=p.col+p.colspan-
1-l.col+f.col:0>f.col&&(g=l.col-p.col+f.col)}p=new c(d.highlight.row+e,d.highlight.col+g);if(d=this.mergedCellInfoCollection.getInfo(p.row,p.col))this.lastDesiredCoords=p,e=d.row-l.row,g=d.col-l.col}else if("modifyTransformEnd"==a)for(a=0,k=this.mergedCellInfoCollection.length;a<k;a++){l=this.mergedCellInfoCollection[a];m=new c(l.row,l.col);h=new c(l.row+l.rowspan-1,l.col+l.colspan-1);m=new b(m,m,h);p=d.getBordersSharedWith(m);m.isEqual(d)?d.setDirection("NW-SE"):0<p.length&&(h=d.highlight.isEqual(m.from),
-1<p.indexOf("top")?d.to.isSouthEastOf(m.from)&&h?d.setDirection("NW-SE"):d.to.isSouthWestOf(m.from)&&h&&d.setDirection("NE-SW"):-1<p.indexOf("bottom")&&(d.to.isNorthEastOf(m.from)&&h?d.setDirection("SW-NE"):d.to.isNorthWestOf(m.from)&&h&&d.setDirection("SE-NW")));p=new c(d.to.row+e,d.to.col+g);h=p.row>=l.row&&p.row<=l.row+l.rowspan-1?!0:!1;var q;q=p.col>=l.col&&p.col<=l.col+l.colspan-1?!0:!1;d.includesRange(m)&&(m.includes(p)||h||q)&&(h&&(0>e?e-=l.rowspan-1:0<e&&(e+=l.rowspan-1)),q&&(0>g?g-=l.colspan-
1:0<g&&(g+=l.colspan-1)))}0!==e&&(f.row=e);0!==g&&(f.col=g)};h=function(a){return function(b){if(this.getSettings().mergeCells){var c=this.getSelectedRange();this.mergeCells.modifyTransform(a,c,b);if("modifyTransformEnd"===a){b=this.countRows();var d=this.countCols();0>c.from.row?c.from.row=0:0<c.from.row&&c.from.row>=b&&(c.from.row=c.from-1);0>c.from.col?c.from.col=0:0<c.from.col&&c.from.col>=d&&(c.from.col=d-1)}}}};var l=function(a){if(this.getSettings().mergeCells)for(var b=this.countCols(),c,
d=0;d<b;d++){if((c=this.mergeCells.mergedCellInfoCollection.getInfo(a.startRow,d))&&c.row<a.startRow)return a.startRow=c.row,l.call(this,a);if(c=this.mergeCells.mergedCellInfoCollection.getInfo(a.endRow,d))if(c=c.row+c.rowspan-1,c>a.endRow)return a.endRow=c,l.call(this,a)}},g=function(a){if(this.getSettings().mergeCells)for(var b=this.countRows(),c,d=0;d<b;d++){if((c=this.mergeCells.mergedCellInfoCollection.getInfo(d,a.startColumn))&&c.col<a.startColumn)return a.startColumn=c.col,g.call(this,a);if(c=
this.mergeCells.mergedCellInfoCollection.getInfo(d,a.endColumn))if(c=c.col+c.colspan-1,c>a.endColumn)return a.endColumn=c,g.call(this,a)}};Handsontable.hooks.add("beforeInit",function(){var a=this.getSettings().mergeCells;a&&!this.mergeCells&&(this.mergeCells=new e(a))});Handsontable.hooks.add("afterInit",function(){var a=this;a.mergeCells&&(a.view.wt.wtTable.getCell=function(b){if(a.getSettings().mergeCells){var c=a.mergeCells.mergedCellInfoCollection.getInfo(b.row,b.col);c&&(b=c)}return p.prototype.getCell.call(this,
b)})});Handsontable.hooks.add("beforeKeyDown",function(a){this.mergeCells&&(a.ctrlKey||a.metaKey)&&!a.altKey&&77===a.keyCode&&(this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render(),a.stopImmediatePropagation())});Handsontable.hooks.add("modifyTransformStart",h("modifyTransformStart"));Handsontable.hooks.add("modifyTransformEnd",h("modifyTransformEnd"));Handsontable.hooks.add("beforeSetRangeEnd",function(a){this.lastDesiredCoords=null;if(this.getSettings().mergeCells){var d=
this.getSelectedRange();d.highlight=new c(d.highlight.row,d.highlight.col);d.to=a;var f=!1;do for(var f=!1,e=0,g=this.mergeCells.mergedCellInfoCollection.length;e<g;e++){var l=this.mergeCells.mergedCellInfoCollection[e],p=new c(l.row,l.col),l=new c(l.row+l.rowspan-1,l.col+l.colspan-1),p=new b(p,p,l);d.expandByRange(p)&&(a.row=d.to.row,a.col=d.to.col,f=!0)}while(f)}});Handsontable.hooks.add("beforeDrawBorders",function(a,d){if(d&&"area"==d&&this.getSettings().mergeCells)for(var f=this.getSelectedRange(),
e=new b(f.from,f.from,f.from),f=new b(f.to,f.to,f.to),g=0,l=this.mergeCells.mergedCellInfoCollection.length;g<l;g++){var p=this.mergeCells.mergedCellInfoCollection[g],k=new c(p.row,p.col),p=new c(p.row+p.rowspan-1,p.col+p.colspan-1),k=new b(k,k,p);e.expandByRange(k)&&(a[0]=e.from.row,a[1]=e.from.col);f.expandByRange(k)&&(a[2]=f.from.row,a[3]=f.from.col)}});Handsontable.hooks.add("afterIsMultipleSelection",function(a){if(a&&this.mergeCells){var b=this.mergeCells.mergedCellInfoCollection,c=this.getSelectedRange(),
d;for(d in b)if(c.highlight.row==b[d].row&&c.highlight.col==b[d].col&&c.to.row==b[d].row+b[d].rowspan-1&&c.to.col==b[d].col+b[d].colspan-1)return!1}return a});Handsontable.hooks.add("afterRenderer",function(a,b,c,d,e,g){this.mergeCells&&this.mergeCells.applySpanProperties(a,b,c)});Handsontable.hooks.add("afterContextMenuDefaultOptions",function(a){this.getSettings().mergeCells&&(a.items.push(Handsontable.ContextMenu.SEPARATOR),a.items.push({key:"mergeCells",name:function(){var a=this.getSelected();
return this.mergeCells.mergedCellInfoCollection.getInfo(a[0],a[1])?"Unmerge cells":"Merge cells"},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange());this.render()},disabled:function(){return!1}}))});Handsontable.hooks.add("afterGetCellMeta",function(a,b,c){if(this.getSettings().mergeCells){var d=this.mergeCells.mergedCellInfoCollection.getInfo(a,b);!d||d.row==a&&d.col==b||(c.copyable=!1)}});Handsontable.hooks.add("afterViewportRowCalculatorOverride",l);Handsontable.hooks.add("afterViewportColumnCalculatorOverride",
g);Handsontable.hooks.add("afterAutofillApplyValues",function(a,b){if(this.getSettings().mergeCells&&!this.selection.isMultiple()){var c=this.mergeCells.mergedCellInfoCollection.getInfo(a[0],a[1]);c&&(a[0]=c.row,a[1]=c.col,a[2]=c.row+c.rowspan-1,a[3]=c.col+c.colspan-1)}});Handsontable.MergeCells=e},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../3rdparty/walkontable/src/cell/range.js":6,"./../../3rdparty/walkontable/src/table.js":20,"./../../plugins.js":45}],64:[function(h,q,r){Object.defineProperties(r,
{default:{get:function(){return p}},__esModule:{value:!0}});var a,e,d,k,m=(a=h("./../../dom.js"),a&&a.__esModule&&a||{default:a});q=(e=h("./../_base.js"),e&&e.__esModule&&e||{default:e}).default;var c=(d=h("./../../eventManager.js"),d&&d.__esModule&&d||{default:d}).eventManager;h=(k=h("./../../plugins.js"),k&&k.__esModule&&k||{default:k}).registerPlugin;var b=k=function(a){var d=this;$traceurRuntime.superConstructor(b).call(this,a);this.dragged=[];this.eventManager=c(this.hot);this.bindTouchEvents();
this.hot.addHook("afterInit",function(){return d.init()})};$traceurRuntime.createClass(k,{init:function(){this.lastSetCell=null;Handsontable.plugins.multipleSelectionHandles=new b(this.hot)},bindTouchEvents:function(){function a(c){if(1===b.dragged.length)return b.dragged.splice(0,b.dragged.length),!0;c=b.dragged.indexOf(c);if(-1==c)return!1;0===c?b.dragged=b.dragged.slice(0,1):1==c&&(b.dragged=b.dragged.slice(-1))}var b=this;this.eventManager.addEventListener(this.hot.rootElement,"touchstart",function(a){var c;
if(m.hasClass(a.target,"topLeftSelectionHandle-HitArea"))return c=b.hot.getSelectedRange(),b.dragged.push("topLeft"),b.touchStartRange={width:c.getWidth(),height:c.getHeight(),direction:c.getDirection()},a.preventDefault(),!1;if(m.hasClass(a.target,"bottomRightSelectionHandle-HitArea"))return c=b.hot.getSelectedRange(),b.dragged.push("bottomRight"),b.touchStartRange={width:c.getWidth(),height:c.getHeight(),direction:c.getDirection()},a.preventDefault(),!1});this.eventManager.addEventListener(this.hot.rootElement,
"touchend",function(c){if(m.hasClass(c.target,"topLeftSelectionHandle-HitArea"))return a.call(b,"topLeft"),b.touchStartRange=void 0,c.preventDefault(),!1;if(m.hasClass(c.target,"bottomRightSelectionHandle-HitArea"))return a.call(b,"bottomRight"),b.touchStartRange=void 0,c.preventDefault(),!1});this.eventManager.addEventListener(this.hot.rootElement,"touchmove",function(a){var c=m.getWindowScrollTop(),d=m.getWindowScrollLeft(),e,l,p,k;if(0!==b.dragged.length&&(c=document.elementFromPoint(a.touches[0].screenX-
d,a.touches[0].screenY-c))&&c!==b.lastSetCell){if("TD"==c.nodeName||"TH"==c.nodeName)d=b.hot.getCoords(c),-1==d.col&&(d.col=0),e=b.hot.getSelectedRange(),l=e.getWidth(),p=e.getHeight(),k=e.getDirection(),1==l&&1==p&&b.hot.selection.setRangeEnd(d),d=b.getCurrentRangeCoords(e,d,b.touchStartRange.direction,k,b.dragged[0]),null!==d.start&&b.hot.selection.setRangeStart(d.start),b.hot.selection.setRangeEnd(d.end),b.lastSetCell=c;a.preventDefault()}})},getCurrentRangeCoords:function(a,b,c,d,f){var e=a.getTopLeftCorner(),
p=a.getBottomRightCorner(),k=a.getBottomLeftCorner(),m=a.getTopRightCorner(),h={start:null,end:null};switch(c){case "NE-SW":switch(d){case "NE-SW":case "NW-SE":h="topLeft"==f?{start:new WalkontableCellCoords(b.row,a.highlight.col),end:new WalkontableCellCoords(k.row,b.col)}:{start:new WalkontableCellCoords(a.highlight.row,b.col),end:new WalkontableCellCoords(b.row,e.col)};break;case "SE-NW":"bottomRight"==f&&(h={start:new WalkontableCellCoords(p.row,b.col),end:new WalkontableCellCoords(b.row,e.col)})}break;
case "NW-SE":switch(d){case "NE-SW":"topLeft"==f?h={start:b,end:k}:h.end=b;break;case "NW-SE":"topLeft"==f?h={start:b,end:p}:h.end=b;break;case "SE-NW":"topLeft"==f?h={start:b,end:e}:h.end=b;break;case "SW-NE":"topLeft"==f?h={start:b,end:m}:h.end=b}break;case "SW-NE":switch(d){case "NW-SE":h="bottomRight"==f?{start:new WalkontableCellCoords(b.row,e.col),end:new WalkontableCellCoords(k.row,b.col)}:{start:new WalkontableCellCoords(e.row,b.col),end:new WalkontableCellCoords(b.row,p.col)};break;case "SW-NE":h=
"topLeft"==f?{start:new WalkontableCellCoords(a.highlight.row,b.col),end:new WalkontableCellCoords(b.row,p.col)}:{start:new WalkontableCellCoords(b.row,e.col),end:new WalkontableCellCoords(e.row,b.col)};break;case "SE-NW":"bottomRight"==f?h={start:new WalkontableCellCoords(b.row,m.col),end:new WalkontableCellCoords(e.row,b.col)}:"topLeft"==f&&(h={start:k,end:b})}break;case "SE-NW":switch(d){case "NW-SE":case "NE-SW":case "SW-NE":"topLeft"==f&&(h.end=b);break;case "SE-NW":"topLeft"==f?h.end=b:h={start:b,
end:e}}}return h},isDragged:function(){return 0<this.dragged.length}},{},q);var p=k;h("multipleSelectionHandles",k)},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46}],65:[function(h,q,r){function a(){}function e(){var a=this.getSettings().observeChanges;a?(this.observer&&m.call(this),d.call(this),c.call(this)):a||m.call(this)}function d(){var a=this;a.observeChangesActive=!0;a.pauseObservingChanges=function(){a.observeChangesActive=!1};a.resumeObservingChanges=
function(){a.observeChangesActive=!0};a.observedData=a.getData();a.observer=l.observe(a.observedData,function(b){a.observeChangesActive&&(k.call(a,b),a.render());a.runHooks("afterChangesObserved")})}function k(a){function b(a){var c=[];return a.filter(function(a){var b=d(a.path);if(-1!=["add","remove"].indexOf(a.op)&&!isNaN(b.col)){if(-1!=c.indexOf(b.col))return!1;c.push(b.col)}return!0})}function c(a){return a.filter(function(a){return!/[/]length/ig.test(a.path)})}function d(a){a=a.match(/^\/(\d+)\/?(.*)?$/);
return{row:parseInt(a[1],10),col:/^\d*$/.test(a[2])?parseInt(a[2],10):a[2]}}a=function(a){a=c(a);return a=b(a)}(a);for(var e=0,l=a.length;e<l;e++){var p=a[e],k=d(p.path);switch(p.op){case "add":isNaN(k.col)?this.runHooks("afterCreateRow",k.row):this.runHooks("afterCreateCol",k.col);break;case "remove":isNaN(k.col)?this.runHooks("afterRemoveRow",k.row,1):this.runHooks("afterRemoveCol",k.col,1);break;case "replace":this.runHooks("afterChange",[k.row,k.col,null,p.value],"external")}}}function m(){this.observer&&
(l.unobserve(this.observedData,this.observer),delete this.observeChangesActive,delete this.pauseObservingChanges,delete this.resumeObservingChanges,this.removeHook("afterDestroy",m),this.removeHook("afterCreateRow",b),this.removeHook("afterRemoveRow",b),this.removeHook("afterCreateCol",b),this.removeHook("afterRemoveCol",b),this.removeHook("afterChange",b))}function c(){this.addHook("afterDestroy",m);this.addHook("afterCreateRow",b);this.addHook("afterRemoveRow",b);this.addHook("afterCreateCol",b);
this.addHook("afterRemoveCol",b);this.addHook("afterChange",function(a,c){"loadData"!=c&&b.call(this)})}function b(){var a=this;a.pauseObservingChanges();a.addHookOnce("afterChangesObserved",function(){a.resumeObservingChanges()})}Object.defineProperties(r,{ObserveChanges:{get:function(){return a}},__esModule:{value:!0}});var p;h("./../../plugins.js");var l=(p=h("jsonpatch"),p&&p.__esModule&&p||{default:p}).default;Handsontable.hooks.add("afterLoadData",e);Handsontable.hooks.add("afterUpdateSettings",
e);Handsontable.hooks.register("afterChangesObserved")},{"./../../plugins.js":45,jsonpatch:"jsonpatch"}],66:[function(h,q,r){function a(a){var e,m=function(){window.localStorage[a+"__persistentStateKeys"]=JSON.stringify(e)};(function(){var c=window.localStorage[a+"__persistentStateKeys"];e=(c="string"==typeof c?JSON.parse(c):void 0)?c:[]})();this.saveValue=function(c,b){window.localStorage[a+"_"+c]=JSON.stringify(b);-1==e.indexOf(c)&&(e.push(c),m())};this.loadValue=function(c,b){var e=window.localStorage[a+
"_"+("undefined"!=typeof c?c:b)];return"undefined"==typeof e?void 0:JSON.parse(e)};this.reset=function(c){window.localStorage.removeItem(a+"_"+c)};this.resetAll=function(){for(var c=0;c<e.length;c++)window.localStorage.removeItem(a+"_"+e[c]);e=[];m()}}function e(){var d=this;this.init=function(){var c=this.getSettings().persistentState;d.enabled=!!c;if(d.enabled){this.storage||(this.storage=new a(this.rootElement.id));this.resetState=d.resetValue;for(var b in e)e.hasOwnProperty(b)&&this.addHook(b,
e[b])}else for(var p in e)e.hasOwnProperty(p)&&this.removeHook(p,e[p])};this.saveValue=function(a,b){this.storage.saveValue(a,b)};this.loadValue=function(a,b){b.value=this.storage.loadValue(a)};this.resetValue=function(a){"undefined"!=typeof a?this.storage.reset(a):this.storage.resetAll()};var e={persistentStateSave:d.saveValue,persistentStateLoad:d.loadValue,persistentStateReset:d.resetValue},m;for(m in e)e.hasOwnProperty(m)&&Handsontable.hooks.register(m)}Object.defineProperties(r,{HandsontablePersistentState:{get:function(){return e}},
__esModule:{value:!0}});h("./../../plugins.js");h=new e;Handsontable.hooks.add("beforeInit",h.init);Handsontable.hooks.add("afterUpdateSettings",h.init)},{"./../../plugins.js":45}],67:[function(h,q,r){function a(){this.getSettings().search?this.search=new Handsontable.Search(this):delete this.search}var e,d,k=(e=h("./../../dom.js"),e&&e.__esModule&&e||{default:e});h=(d=h("./../../renderers.js"),d&&d.__esModule&&d||{default:d});d=h.registerRenderer;h=h.getRenderer;Handsontable.Search=function(a){this.query=
function(b,d,e){var g=a.countRows(),k=a.countCols(),m=[];d||(d=Handsontable.Search.global.getDefaultCallback());e||(e=Handsontable.Search.global.getDefaultQueryMethod());for(var f=0;f<g;f++)for(var n=0;n<k;n++){var h=a.getDataAtCell(f,n),q=a.getCellMeta(f,n),r=q.search.callback||d;(q=(q.search.queryMethod||e)(b,h))&&m.push({row:f,col:n,data:h});r&&r(a,f,n,h,q)}return m}};Handsontable.Search.DEFAULT_CALLBACK=function(a,b,d,e,g){a.getCellMeta(b,d).isSearchResult=g};Handsontable.Search.DEFAULT_QUERY_METHOD=
function(a,b){return"undefined"!=typeof a&&null!=a&&a.toLowerCase&&0!==a.length&&"undefined"!=typeof b&&null!=b?-1!=b.toString().toLowerCase().indexOf(a.toLowerCase()):!1};Handsontable.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult";Handsontable.Search.global=function(){var a=Handsontable.Search.DEFAULT_CALLBACK,b=Handsontable.Search.DEFAULT_QUERY_METHOD,d=Handsontable.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return a},setDefaultCallback:function(b){a=b},getDefaultQueryMethod:function(){return b},
setDefaultQueryMethod:function(a){b=a},getDefaultSearchResultClass:function(){return d},setDefaultSearchResultClass:function(a){d=a}}}();Handsontable.SearchCellDecorator=function(a,b,d,e,g,m,h){a=null!==h.search&&"object"==typeof h.search&&h.search.searchResultClass||Handsontable.Search.global.getDefaultSearchResultClass();h.isSearchResult?k.addClass(b,a):k.removeClass(b,a)};var m=h("base");d("base",function(a,b,d,e,g,k,h){m.apply(this,arguments);Handsontable.SearchCellDecorator.apply(this,arguments)});
Handsontable.hooks.add("afterInit",a);Handsontable.hooks.add("afterUpdateSettings",a)},{"./../../dom.js":27,"./../../renderers.js":70}],68:[function(h,q,r){Object.defineProperties(r,{TouchScroll:{get:function(){return m}},__esModule:{value:!0}});var a,e,d,k=(a=h("./../../dom.js"),a&&a.__esModule&&a||{default:a});q=(e=h("./../_base.js"),e&&e.__esModule&&e||{default:e}).default;h=(d=h("./../../plugins.js"),d&&d.__esModule&&d||{default:d}).registerPlugin;var m=function(a){var d=this;$traceurRuntime.superConstructor(c).call(this,
a);this.hot.addHook("afterInit",function(){return d.init()});this.hot.addHook("afterUpdateSettings",function(){return d.onAfterUpdateSettings()});this.scrollbars=[];this.clones=[]},c=m;$traceurRuntime.createClass(m,{init:function(){this.registerEvents();this.onAfterUpdateSettings()},onAfterUpdateSettings:function(){var a=this;this.hot.addHookOnce("afterRender",function(){var c=a.hot.view.wt.wtOverlays;a.scrollbars=[];a.scrollbars.push(c.topOverlay);a.scrollbars.push(c.leftOverlay);c.topLeftCornerOverlay&&
a.scrollbars.push(c.topLeftCornerOverlay);a.clones=[];c.topOverlay.needFullRender&&a.clones.push(c.topOverlay.clone.wtTable.holder.parentNode);c.leftOverlay.needFullRender&&a.clones.push(c.leftOverlay.clone.wtTable.holder.parentNode);c.topLeftCornerOverlay&&a.clones.push(c.topLeftCornerOverlay.clone.wtTable.holder.parentNode)})},registerEvents:function(){var a=this;this.hot.addHook("beforeTouchScroll",function(){return a.onBeforeTouchScroll()});this.hot.addHook("afterMomentumScroll",function(){return a.onAfterMomentumScroll()})},
onBeforeTouchScroll:function(){Handsontable.freezeOverlays=!0;for(var a=0,c=this.clones.length;a<c;a++)k.addClass(this.clones[a],"hide-tween")},onAfterMomentumScroll:function(){Handsontable.freezeOverlays=!1;for(var a=this,c=0,d=this.clones.length;c<d;c++)k.removeClass(this.clones[c],"hide-tween");c=0;for(d=this.clones.length;c<d;c++)k.addClass(this.clones[c],"show-tween");setTimeout(function(){for(var c=0,d=a.clones.length;c<d;c++)k.removeClass(a.clones[c],"show-tween")},400);c=0;for(d=this.scrollbars.length;c<
d;c++)this.scrollbars[c].refresh(),this.scrollbars[c].resetFixedPosition();this.hot.view.wt.wtOverlays.syncScrollWithMaster()}},{},q);h("touchScroll",m)},{"./../../dom.js":27,"./../../plugins.js":45,"./../_base.js":46}],69:[function(h,q,r){function a(){"undefined"==typeof this.getSettings().undo||this.getSettings().undo?this.undoRedo||(this.undoRedo=new Handsontable.UndoRedo(this),k(this),this.addHook("beforeKeyDown",e),this.addHook("afterChange",d)):this.undoRedo&&(delete this.undoRedo,delete this.undo,
delete this.redo,delete this.isUndoAvailable,delete this.isRedoAvailable,delete this.clearUndo,this.removeHook("beforeKeyDown",e),this.removeHook("afterChange",d))}function e(a){!a.ctrlKey&&!a.metaKey||a.altKey||(89===a.keyCode||a.shiftKey&&90===a.keyCode?(this.undoRedo.redo(),a.stopImmediatePropagation()):90===a.keyCode&&(this.undoRedo.undo(),a.stopImmediatePropagation()))}function d(a,c){if("loadData"==c)return this.undoRedo.clear()}function k(a){a.undo=function(){return a.undoRedo.undo()};a.redo=
function(){return a.undoRedo.redo()};a.isUndoAvailable=function(){return a.undoRedo.isUndoAvailable()};a.isRedoAvailable=function(){return a.undoRedo.isRedoAvailable()};a.clearUndo=function(){return a.undoRedo.clear()}}var m,c=(m=h("./../../helpers.js"),m&&m.__esModule&&m||{default:m});Handsontable.UndoRedo=function(a){var c=this;this.instance=a;this.doneActions=[];this.undoneActions=[];this.ignoreNewActions=!1;a.addHook("afterChange",function(a,b){if(a){var d=new Handsontable.UndoRedo.ChangeAction(a);
c.done(d)}});a.addHook("afterCreateRow",function(a,b,d){d||(a=new Handsontable.UndoRedo.CreateRowAction(a,b),c.done(a))});a.addHook("beforeRemoveRow",function(a,b){var d=c.instance.getData();a=(d.length+a)%d.length;d=d.slice(a,a+b);d=new Handsontable.UndoRedo.RemoveRowAction(a,d);c.done(d)});a.addHook("afterCreateCol",function(a,b,d){d||(a=new Handsontable.UndoRedo.CreateColumnAction(a,b),c.done(a))});a.addHook("beforeRemoveCol",function(d,e){var k=c.instance.getData();d=(c.instance.countCols()+d)%
c.instance.countCols();for(var m=[],f=0,n=k.length;f<n;f++)m[f]=k[f].slice(d,d+e);var h;Array.isArray(a.getSettings().colHeaders)&&(h=a.getSettings().colHeaders.slice(d,d+m.length));k=new Handsontable.UndoRedo.RemoveColumnAction(d,m,h);c.done(k)});a.addHook("beforeCellAlignment",function(a,b,d,e){a=new Handsontable.UndoRedo.CellAlignmentAction(a,b,d,e);c.done(a)})};Handsontable.UndoRedo.prototype.done=function(a){this.ignoreNewActions||(this.doneActions.push(a),this.undoneActions.length=0)};Handsontable.UndoRedo.prototype.undo=
function(){if(this.isUndoAvailable()){var a=this.doneActions.pop();this.ignoreNewActions=!0;var c=this;a.undo(this.instance,function(){c.ignoreNewActions=!1;c.undoneActions.push(a)})}};Handsontable.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var a=this.undoneActions.pop();this.ignoreNewActions=!0;var c=this;a.redo(this.instance,function(){c.ignoreNewActions=!1;c.doneActions.push(a)})}};Handsontable.UndoRedo.prototype.isUndoAvailable=function(){return 0<this.doneActions.length};Handsontable.UndoRedo.prototype.isRedoAvailable=
function(){return 0<this.undoneActions.length};Handsontable.UndoRedo.prototype.clear=function(){this.doneActions.length=0;this.undoneActions.length=0};Handsontable.UndoRedo.Action=function(){};Handsontable.UndoRedo.Action.prototype.undo=function(){};Handsontable.UndoRedo.Action.prototype.redo=function(){};Handsontable.UndoRedo.ChangeAction=function(a){this.changes=a};c.inherit(Handsontable.UndoRedo.ChangeAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.ChangeAction.prototype.undo=function(a,
d){for(var e=c.deepClone(this.changes),g=a.countEmptyRows(!0),k=a.countEmptyCols(!0),m=0,f=e.length;m<f;m++)e[m].splice(3,1);a.addHookOnce("afterChange",d);a.setDataAtRowProp(e,null,null,"undo");m=0;for(f=e.length;m<f;m++)a.getSettings().minSpareRows&&e[m][0]+1+a.getSettings().minSpareRows===a.countRows()&&g==a.getSettings().minSpareRows&&(a.alter("remove_row",parseInt(e[m][0]+1,10),a.getSettings().minSpareRows),a.undoRedo.doneActions.pop()),a.getSettings().minSpareCols&&e[m][1]+1+a.getSettings().minSpareCols===
a.countCols()&&k==a.getSettings().minSpareCols&&(a.alter("remove_col",parseInt(e[m][1]+1,10),a.getSettings().minSpareCols),a.undoRedo.doneActions.pop())};Handsontable.UndoRedo.ChangeAction.prototype.redo=function(a,d){for(var e=c.deepClone(this.changes),g=0,k=e.length;g<k;g++)e[g].splice(2,1);a.addHookOnce("afterChange",d);a.setDataAtRowProp(e,null,null,"redo")};Handsontable.UndoRedo.CreateRowAction=function(a,c){this.index=a;this.amount=c};c.inherit(Handsontable.UndoRedo.CreateRowAction,Handsontable.UndoRedo.Action);
Handsontable.UndoRedo.CreateRowAction.prototype.undo=function(a,c){var d=a.countRows(),e=a.getSettings().minSpareRows;this.index>=d&&this.index-e<d&&(this.index-=e);a.addHookOnce("afterRemoveRow",c);a.alter("remove_row",this.index,this.amount)};Handsontable.UndoRedo.CreateRowAction.prototype.redo=function(a,c){a.addHookOnce("afterCreateRow",c);a.alter("insert_row",this.index+1,this.amount)};Handsontable.UndoRedo.RemoveRowAction=function(a,c){this.index=a;this.data=c};c.inherit(Handsontable.UndoRedo.RemoveRowAction,
Handsontable.UndoRedo.Action);Handsontable.UndoRedo.RemoveRowAction.prototype.undo=function(a,c){var d=[this.index,0];Array.prototype.push.apply(d,this.data);Array.prototype.splice.apply(a.getData(),d);a.addHookOnce("afterRender",c);a.render()};Handsontable.UndoRedo.RemoveRowAction.prototype.redo=function(a,c){a.addHookOnce("afterRemoveRow",c);a.alter("remove_row",this.index,this.data.length)};Handsontable.UndoRedo.CreateColumnAction=function(a,c){this.index=a;this.amount=c};c.inherit(Handsontable.UndoRedo.CreateColumnAction,
Handsontable.UndoRedo.Action);Handsontable.UndoRedo.CreateColumnAction.prototype.undo=function(a,c){a.addHookOnce("afterRemoveCol",c);a.alter("remove_col",this.index,this.amount)};Handsontable.UndoRedo.CreateColumnAction.prototype.redo=function(a,c){a.addHookOnce("afterCreateCol",c);a.alter("insert_col",this.index+1,this.amount)};Handsontable.UndoRedo.CellAlignmentAction=function(a,c,d,e){this.stateBefore=a;this.range=c;this.type=d;this.alignment=e};Handsontable.UndoRedo.CellAlignmentAction.prototype.undo=
function(a,c){if(a.contextMenu){for(var d=this.range.from.row;d<=this.range.to.row;d++)for(var e=this.range.from.col;e<=this.range.to.col;e++)a.setCellMeta(d,e,"className",this.stateBefore[d][e]||" htLeft");a.addHookOnce("afterRender",c);a.render()}};Handsontable.UndoRedo.CellAlignmentAction.prototype.redo=function(a,c){if(a.contextMenu){for(var d=this.range.from.row;d<=this.range.to.row;d++)for(var e=this.range.from.col;e<=this.range.to.col;e++)a.contextMenu.align.call(a,this.range,this.type,this.alignment);
a.addHookOnce("afterRender",c);a.render()}};Handsontable.UndoRedo.RemoveColumnAction=function(a,c,d){this.index=a;this.data=c;this.amount=this.data[0].length;this.headers=d};c.inherit(Handsontable.UndoRedo.RemoveColumnAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.RemoveColumnAction.prototype.undo=function(a,c){for(var d,e,k=0,m=a.getData().length;k<m;k++)d=a.getSourceDataAtRow(k),e=[this.index,0],Array.prototype.push.apply(e,this.data[k]),Array.prototype.splice.apply(d,e);"undefined"!=
typeof this.headers&&(e=[this.index,0],Array.prototype.push.apply(e,this.headers),Array.prototype.splice.apply(a.getSettings().colHeaders,e));a.addHookOnce("afterRender",c);a.render()};Handsontable.UndoRedo.RemoveColumnAction.prototype.redo=function(a,c){a.addHookOnce("afterRemoveCol",c);a.alter("remove_col",this.index,this.amount)};Handsontable.hooks.add("afterInit",a);Handsontable.hooks.add("afterUpdateSettings",a)},{"./../../helpers.js":42}],70:[function(h,q,r){function a(a,d){var e;c[a]=d;e=m.toUpperCaseFirst(a)+
"Renderer";Handsontable.renderers[e]=d;Handsontable[e]=d}function e(a){if("function"==typeof a)return a;if("string"!=typeof a)throw Error('Only strings and functions can be passed as "renderer" parameter');if(!(a in c))throw Error('No editor registered under name "'+a+'"');return c[a]}function d(a){return a in c}Object.defineProperties(r,{registerRenderer:{get:function(){return a}},getRenderer:{get:function(){return e}},hasRenderer:{get:function(){return d}},__esModule:{value:!0}});var k,m=(k=h("./helpers.js"),
k&&k.__esModule&&k||{default:k}),c={};Handsontable.renderers=Handsontable.renderers||{};Handsontable.renderers.registerRenderer=a;Handsontable.renderers.getRenderer=e},{"./helpers.js":42}],71:[function(h,q,r){function a(a,c,b,d,e,g,h){h.className&&(c.className=c.className?c.className+" "+h.className:h.className);h.readOnly&&k.addClass(c,h.readOnlyCellClassName);!1===h.valid&&h.invalidCellClassName?k.addClass(c,h.invalidCellClassName):k.removeClass(c,h.invalidCellClassName);!1===h.wordWrap&&h.noWordWrapClassName&&
k.addClass(c,h.noWordWrapClassName);!g&&h.placeholder&&k.addClass(c,h.placeholderCellClassName)}Object.defineProperties(r,{cellDecorator:{get:function(){return a}},__esModule:{value:!0}});var e,d,k=(e=h("./../dom.js"),e&&e.__esModule&&e||{default:e});h=(d=h("./../renderers.js"),d&&d.__esModule&&d||{default:d}).registerRenderer;h("base",a);Handsontable.renderers.cellDecorator=a},{"./../dom.js":27,"./../renderers.js":70}],72:[function(h,q,r){function a(a,d,e,k,m,h,q){g.cloneNode(!0);var y=t.cloneNode(!0);
p("text")(a,d,e,k,m,h,q);d.appendChild(y);c.addClass(d,"htAutocomplete");d.firstChild||d.appendChild(document.createTextNode(String.fromCharCode(160)));if(!a.acArrowListener){var r=b(a);a.acArrowListener=function(b){c.hasClass(b.target,"htAutocompleteArrow")&&a.view.wt.getSetting("onCellDblClick",null,new l(e,k),d)};r.addEventListener(a.rootElement,"mousedown",a.acArrowListener);a.addHookOnce("afterDestroy",function(){r.clear()})}}Object.defineProperties(r,{autocompleteRenderer:{get:function(){return a}},
__esModule:{value:!0}});var e,d,k,m,c=(e=h("./../dom.js"),e&&e.__esModule&&e||{default:e}),b=(d=h("./../eventManager.js"),d&&d.__esModule&&d||{default:d}).eventManager;q=(k=h("./../renderers.js"),k&&k.__esModule&&k||{default:k});var p=q.getRenderer;k=q.registerRenderer;var l=(m=h("./../3rdparty/walkontable/src/cell/coords.js"),m&&m.__esModule&&m||{default:m}).WalkontableCellCoords,g=document.createElement("DIV");g.className="htAutocompleteWrapper";var t=document.createElement("DIV");t.className="htAutocompleteArrow";
t.appendChild(document.createTextNode(String.fromCharCode(9660)));k("autocomplete",a)},{"./../3rdparty/walkontable/src/cell/coords.js":5,"./../dom.js":27,"./../eventManager.js":41,"./../renderers.js":70}],73:[function(h,q,r){function a(a,d,f,e,k,m,h){function q(a){var d=[b.keyCode.SPACE,b.keyCode.ENTER,b.keyCode.DELETE,b.keyCode.BACKSPACE];c.enableImmediatePropagation(a);-1===d.indexOf(a.keyCode)||a.isImmediatePropagationStopped()||r(function(){a.stopImmediatePropagation();a.preventDefault()});a.keyCode!=
b.keyCode.SPACE&&a.keyCode!=b.keyCode.ENTER||y();a.keyCode!=b.keyCode.DELETE&&a.keyCode!=b.keyCode.BACKSPACE||y(!1)}function y(a){var b=void 0!==a?a:null;r(function(a){for(var c=0,d=a.length;c<d;c++){var e=a[c],f=void 0!==b?b:null;e.checked=null===f?!e.checked:f;A.fireEvent(e,"change")}})}function r(b){for(var c=a.getSelectedRange(),d=c.getTopLeftCorner(),c=c.getBottomRightCorner(),e=d.row;e<=c.row;e++)for(var f=d.col;f<=c.col;f++){var n=a.getCell(e,f),g=a.getCellMeta(e,f),n=n.querySelectorAll("input[type=checkbox]");
0<n.length&&!g.readOnly&&b(n)}}function B(a){a.preventDefault()}function z(a){b.stopPropagation(a)}var A=new p(a);e=l.cloneNode(!1);"undefined"===typeof h.checkedTemplate&&(h.checkedTemplate=!0);"undefined"===typeof h.uncheckedTemplate&&(h.uncheckedTemplate=!1);c.empty(d);m===h.checkedTemplate||m===b.stringify(h.checkedTemplate)?(e.checked=!0,d.appendChild(e)):m===h.uncheckedTemplate||m===b.stringify(h.uncheckedTemplate)?d.appendChild(e):null===m?(c.addClass(e,"noValue"),d.appendChild(e)):c.fastInnerText(d,
"#bad value#");h.readOnly?A.addEventListener(e,"click",B):(A.addEventListener(e,"mousedown",z),A.addEventListener(e,"mouseup",z),A.addEventListener(e,"change",function(b){a.setDataAtRowProp(f,k,b.target.checked?h.checkedTemplate:h.uncheckedTemplate)}));g.has(a)||(g.set(a,!0),a.addHook("beforeKeyDown",q))}Object.defineProperties(r,{checkboxRenderer:{get:function(){return a}},__esModule:{value:!0}});var e,d,k,m,c=(e=h("./../dom.js"),e&&e.__esModule&&e||{default:e}),b=(d=h("./../helpers.js"),d&&d.__esModule&&
d||{default:d}),p=(k=h("./../eventManager.js"),k&&k.__esModule&&k||{default:k}).EventManager;h=(m=h("./../renderers.js"),m&&m.__esModule&&m||{default:m}).registerRenderer;var l=document.createElement("INPUT");l.className="htCheckboxRendererInput";l.type="checkbox";l.setAttribute("autocomplete","off");var g=new WeakMap;h("checkbox",a)},{"./../dom.js":27,"./../eventManager.js":41,"./../helpers.js":42,"./../renderers.js":70}],74:[function(h,q,r){function a(a,b,d,e,g,h,v){m("base").apply(this,arguments);
k.fastInnerHTML(b,h)}Object.defineProperties(r,{htmlRenderer:{get:function(){return a}},__esModule:{value:!0}});var e,d,k=(e=h("./../dom.js"),e&&e.__esModule&&e||{default:e});h=(d=h("./../renderers.js"),d&&d.__esModule&&d||{default:d});var m=h.getRenderer;d=h.registerRenderer;d("html",a)},{"./../dom.js":27,"./../renderers.js":70}],75:[function(h,q,r){function a(a,d,e,f,n,k,m){b.isNumeric(k)&&("undefined"!==typeof m.language&&p.language(m.language),k=p(k).format(m.format||"0"),c.addClass(d,"htNumeric"));
l("text")(a,d,e,f,n,k,m)}Object.defineProperties(r,{numericRenderer:{get:function(){return a}},__esModule:{value:!0}});var e,d,k,m,c=(e=h("./../dom.js"),e&&e.__esModule&&e||{default:e}),b=(d=h("./../helpers.js"),d&&d.__esModule&&d||{default:d}),p=(k=h("numeral"),k&&k.__esModule&&k||{default:k}).default;h=(m=h("./../renderers.js"),m&&m.__esModule&&m||{default:m});var l=h.getRenderer;m=h.registerRenderer;m("numeric",a)},{"./../dom.js":27,"./../helpers.js":42,"./../renderers.js":70,numeral:"numeral"}],
76:[function(h,q,r){function a(a,b,d,e,g,h,v){m("text").apply(this,arguments);h=b.innerHTML;var f,n=v.hashLength||h.length,w=v.hashSymbol||"*";for(f="";f.split(w).length-1<n;f+=w);k.fastInnerHTML(b,f)}Object.defineProperties(r,{passwordRenderer:{get:function(){return a}},__esModule:{value:!0}});var e,d,k=(e=h("./../dom.js"),e&&e.__esModule&&e||{default:e});h=(d=h("./../renderers.js"),d&&d.__esModule&&d||{default:d});var m=h.getRenderer;d=h.registerRenderer;d("password",a)},{"./../dom.js":27,"./../renderers.js":70}],
77:[function(h,q,r){function a(a,d,e,k,h,f,n){b("base").apply(this,arguments);!f&&n.placeholder&&(f=n.placeholder);var w=c.stringify(f);a.getSettings().trimWhitespace||(w=w.replace(/ /g,String.fromCharCode(160)));n.rendererTemplate?(m.empty(d),w=document.createElement("TEMPLATE"),w.setAttribute("bind","{{}}"),w.innerHTML=n.rendererTemplate,HTMLTemplateElement.decorate(w),w.model=a.getSourceDataAtRow(e),d.appendChild(w)):m.fastInnerText(d,w)}Object.defineProperties(r,{textRenderer:{get:function(){return a}},
__esModule:{value:!0}});var e,d,k,m=(e=h("./../dom.js"),e&&e.__esModule&&e||{default:e}),c=(d=h("./../helpers.js"),d&&d.__esModule&&d||{default:d});h=(k=h("./../renderers.js"),k&&k.__esModule&&k||{default:k});var b=h.getRenderer;k=h.registerRenderer;k("text",a)},{"./../dom.js":27,"./../helpers.js":42,"./../renderers.js":70}],78:[function(h,q,r){Array.prototype.filter||(Array.prototype.filter=function(a,e){if("undefined"===typeof this||null===this)throw new TypeError;if("function"!==typeof a)throw new TypeError;
e=e||this;if(/NodeList/i.test(e.item)){for(var d=e,k=[],m=0,c=d.length;m<c;m++)k[m]=d[m];e=k}d=e.length;k=[];for(m=0;m<d;m+=1)e.hasOwnProperty(m)&&(c=e[m],a.call(e,c,m,e)&&k.push(c));return k})},{}],79:[function(h,q,r){Array.prototype.indexOf||(Array.prototype.indexOf=function(a,e){var d=this.length>>>0,k=Number(e)||0,k=0>k?Math.ceil(k):Math.floor(k);for(0>k&&(k+=d);k<d;k++)if(k in this&&this[k]===a)return k;return-1})},{}],80:[function(h,q,r){Array.isArray||(Array.isArray=function(a){return"[object Array]"==
Object.prototype.toString.call(a)})},{}],81:[function(h,q,r){(function(a){function e(a){return{configurable:!0,enumerable:!1,value:a,writable:!0}}function d(){return"__$"+Math.floor(1E9*Math.random())+"$"+ ++fa+"$__"}function k(a){return sa[a]}function m(){var a=d();sa[a]=!0;return a}function c(a){return"object"===typeof a&&a instanceof l}function b(a){return c(a)?"symbol":typeof a}function p(a){a=new l(a);if(!(this instanceof p))return a;throw new TypeError("Symbol cannot be new'ed");}function l(a){var b=
d();L(this,ba,{value:this});L(this,ga,{value:b});L(this,J,{value:a});h(this);oa[b]=this}function g(a){var b=a[ra];if(b&&b.self===a)return b;if(Y(a))return ia.hash.value=ja++,ia.self.value=a,ha.value=Z(null,ia),L(a,ra,ha),ha.value}function h(a){g(a);return ca.apply(this,arguments)}function v(a){g(a);return K.apply(this,arguments)}function f(a){g(a);return ea.apply(this,arguments)}function n(a){return oa[a]||sa[a]}function w(a){return c(a)?a[ga]:a}function q(a){for(var b=[],c=0;c<a.length;c++)n(a[c])||
b.push(a[c]);return b}function r(a){return q(da(a))}function W(a){return q(u(a))}function y(a){var b=[];a=da(a);for(var c=0;c<a.length;c++){var d=oa[a[c]];d&&b.push(d)}return b}function F(a,b){return E(a,w(b))}function B(a){return R.call(this,w(a))}function z(a,b,d){c(b)&&(b=b[ga]);L(a,b,d);return a}function A(a){for(var b=1;b<arguments.length;b++)for(var c=da(arguments[b]),d=0;d<c.length;d++)n(c[d])||function(b,c){L(a,c,{get:function(){return b[c]},enumerable:!0})}(arguments[b],c[d]);return a}function H(a){return null!=
a&&("object"===typeof a||"function"===typeof a)}function M(a){if(null==a)throw x();return D(a)}function O(a){if(null==a)throw new TypeError("Value cannot be converted to an Object");return a}function U(a){a.Symbol||(a.Symbol=p,Object.getOwnPropertySymbols=y);a.Symbol.iterator||(a.Symbol.iterator=p("Symbol.iterator"));a.Reflect=a.Reflect||{};a.Reflect.global=a.Reflect.global||a;a=a.Object;L(a,"defineProperty",{value:z});L(a,"getOwnPropertyNames",{value:r});L(a,"getOwnPropertyDescriptor",{value:F});
L(a.prototype,"hasOwnProperty",{value:B});L(a,"freeze",{value:h});L(a,"preventExtensions",{value:v});L(a,"seal",{value:f});L(a,"keys",{value:W})}if(!a.$traceurRuntime){var D=Object,x=TypeError,Z=D.create,S=D.defineProperties,L=D.defineProperty,ca=D.freeze,E=D.getOwnPropertyDescriptor,da=D.getOwnPropertyNames,u=D.keys,R=D.prototype.hasOwnProperty,K=Object.preventExtensions,ea=Object.seal,Y=Object.isExtensible,fa=0,ga=d(),J=d(),ba=d(),oa=Z(null),sa=Z(null);L(p.prototype,"constructor",e(p));L(p.prototype,
"toString",e(function(){var b=this[ba];if(!a.traceur||!a.traceur.options.symbols)return b[ga];if(!b)throw TypeError("Conversion from symbol to string");b=b[J];void 0===b&&(b="");return"Symbol("+b+")"}));L(p.prototype,"valueOf",e(function(){var b=this[ba];if(!b)throw TypeError("Conversion from symbol to string");return a.traceur&&a.traceur.options.symbols?b:b[ga]}));L(l.prototype,"constructor",e(p));L(l.prototype,"toString",{value:p.prototype.toString,enumerable:!1});L(l.prototype,"valueOf",{value:p.prototype.valueOf,
enumerable:!1});var ra=m(),ha={value:void 0},ia={hash:{value:void 0},self:{value:void 0}},ja=0;h(l.prototype);U(a);a.$traceurRuntime={checkObjectCoercible:O,createPrivateName:m,defineProperties:S,defineProperty:L,exportStar:A,getOwnHashObject:g,getOwnPropertyDescriptor:E,getOwnPropertyNames:da,isObject:H,isPrivateName:k,isSymbolString:n,keys:u,setupGlobals:U,toObject:M,toProperty:w,typeof:b}}})(window);(function(){var a;$traceurRuntime.require=function(e,d){a=a||"undefined"!==typeof h&&h("path");
if("/"!==d.slice(-1)&&"/"!==d[0])return"."===d[0]?h(a.resolve(a.dirname(e),d)):h(d)}})();(function(){$traceurRuntime.spread=function(){for(var a=[],e=0,d,k=0;k<arguments.length;k++){d=$traceurRuntime.checkObjectCoercible(arguments[k]);if("function"!==typeof d[$traceurRuntime.toProperty(Symbol.iterator)])throw new TypeError("Cannot spread non-iterable object.");for(var m=d[$traceurRuntime.toProperty(Symbol.iterator)]();!(d=m.next()).done;)a[e++]=d.value}return a}})();(function(){function a(a,b){var c=
h(a);do{var d=g(c,b);if(d)return d;c=h(c)}while(c)}function e(a,b,c,e){return d(a,b,c).apply(a,e)}function d(b,c,d){if(c=a(c,d))return c.get?c.get.call(b):c.value}function k(a){for(var b={},c=f(a),d=0;d<c.length;d++){var e=c[d];b[e]=g(a,e)}c=n(a);for(d=0;d<c.length;d++)e=c[d],b[$traceurRuntime.toProperty(e)]=g(a,$traceurRuntime.toProperty(e));return b}var m=Object,c=TypeError,b=m.create,p=$traceurRuntime.defineProperties,l=$traceurRuntime.defineProperty,g=$traceurRuntime.getOwnPropertyDescriptor,
h=Object.getPrototypeOf,v=Object,f=v.getOwnPropertyNames,n=v.getOwnPropertySymbols;$traceurRuntime.createClass=function(a,d,e,f){l(d,"constructor",{value:a,configurable:!0,enumerable:!1,writable:!0});if(3<arguments.length){"function"===typeof f&&(a.__proto__=f);var n;a:{if("function"===typeof f){n=f.prototype;if(m(n)===n||null===n){n=f.prototype;break a}throw new c("super prototype must be an Object or null");}if(null===f)n=null;else throw new c("Super expression must either be null or a function, not "+
typeof f+".");}a.prototype=b(n,k(d))}else a.prototype=d;l(a,"prototype",{configurable:!1,writable:!1});return p(a,k(e))};$traceurRuntime.defaultSuperCall=function(a,b,c){null!==h(b)&&e(a,b,"constructor",c)};$traceurRuntime.superCall=e;$traceurRuntime.superConstructor=function(a){return a.__proto__};$traceurRuntime.superGet=d;$traceurRuntime.superSet=function(b,d,e,f){if((d=a(d,e))&&d.set)return d.set.call(b,f),f;throw c("super has no setter '"+e+"'.");}})()},{path:void 0}],82:[function(h,q,r){Object.keys||
(Object.keys=function(){var a=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),d="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),k=d.length;return function(m){if("object"!==typeof m&&("function"!==typeof m||null===m))throw new TypeError("Object.keys called on non-object");var c=[],b;for(b in m)a.call(m,b)&&c.push(b);if(e)for(b=0;b<k;b++)a.call(m,d[b])&&c.push(d[b]);return c}}())},{}],83:[function(h,q,r){if(!String.prototype.trim){var a=
/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(a,"")}}},{}],84:[function(h,q,r){"undefined"===typeof WeakMap&&function(){var a=Object.defineProperty;try{var e=!0;a(function(){},"foo",{})}catch(d){e=!1}var k=+new Date%1E9,m=function(){this.name="__st"+(1E9*Math.random()>>>0)+(k++ +"__");e||(this._wmCache=[])};m.prototype=e?{set:function(c,b){var d=c[this.name];d&&d[0]===c?d[1]=b:a(c,this.name,{value:[c,b],writable:!0})},get:function(a){var b;return(b=a[this.name])&&b[0]===a?b[1]:
void 0},has:function(a){return this.get(a)?!0:!1},"delete":function(a){this.set(a,void 0)}}:{set:function(a,b){if("undefined"!=typeof a&&"undefined"!=typeof b){for(var d=0,e=this._wmCache.length;d<e;d++)if(this._wmCache[d].key==a){this._wmCache[d].value=b;return}this._wmCache.push({key:a,value:b})}},get:function(a){if("undefined"!=typeof a)for(var b=0,d=this._wmCache.length;b<d;b++)if(this._wmCache[b].key==a)return this._wmCache[b].value},has:function(a){return this.get(a)?!0:!1},"delete":function(a){if("undefined"!=
typeof a)for(var b=0,d=this._wmCache.length;b<d;b++)this._wmCache[b].key==a&&Array.prototype.slice.call(this._wmCache,b,1)}};window.WeakMap=m}()},{}],85:[function(h,q,r){function a(a){var b=this;this.eventManager=g(a);this.instance=a;this.settings=a.getSettings();var c=a.rootElement.getAttribute("style");c&&a.rootElement.setAttribute("data-originalstyle",c);p.addClass(a.rootElement,"handsontable");c=document.createElement("TABLE");c.className="htCore";this.THEAD=document.createElement("THEAD");c.appendChild(this.THEAD);
this.TBODY=document.createElement("TBODY");c.appendChild(this.TBODY);a.table=c;a.container.insertBefore(c,a.container.firstChild);this.eventManager.addEventListener(a.rootElement,"mousedown",function(a){b.isTextSelectionAllowed(a.target)||(window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty(),a.preventDefault(),window.focus())});this.eventManager.addEventListener(document.documentElement,
"keyup",function(b){a.selection.isInProgress()&&!b.shiftKey&&a.selection.finish()});var d;this.isMouseDown=function(){return d};this.eventManager.addEventListener(document.documentElement,"mouseup",function(b){a.selection.isInProgress()&&1===b.which&&a.selection.finish();d=!1;l.isOutsideInput(document.activeElement)&&a.unlisten()});this.eventManager.addEventListener(document.documentElement,"mousedown",function(c){var e=c.target;if(!d){if(e!==a.view.wt.wtTable.holder)for(;e!==document.documentElement;){if(null===
e){if(c.isTargetWebComponent)break;return}if(e===a.rootElement)return;e=e.parentNode}else if(e=Handsontable.Dom.getScrollbarWidth(),document.elementFromPoint(c.x+e,c.y)!==a.view.wt.wtTable.holder||document.elementFromPoint(c.x,c.y+e)!==a.view.wt.wtTable.holder)return;b.settings.outsideClickDeselects?a.deselectCell():a.destroyEditor()}});this.eventManager.addEventListener(c,"selectstart",function(a){b.settings.fragmentSelection||a.preventDefault()});var e=[new v({className:"current",border:{width:2,
color:"#5292F7",cornerVisible:function(){return b.settings.fillHandle&&!b.isCellEdited()&&!a.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!b.isCellEdited()&&!a.selection.isMultiple()}}}),new v({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return b.settings.fillHandle&&!b.isCellEdited()&&a.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!b.isCellEdited()&&a.selection.isMultiple()}}}),new v({className:"highlight",highlightRowClassName:b.settings.currentRowClassName,
highlightColumnClassName:b.settings.currentColClassName}),new v({className:"fill",border:{width:1,color:"red"}})];e.current=e[0];e.area=e[1];e.highlight=e[2];e.fill=e[3];c={debug:function(){return b.settings.debug},table:c,stretchH:this.settings.stretchH,data:a.getDataAtCell,totalRows:a.countRows,totalColumns:a.countCols,fixedColumnsLeft:function(){return b.settings.fixedColumnsLeft},fixedRowsTop:function(){return b.settings.fixedRowsTop},renderAllRows:b.settings.renderAllRows,rowHeaders:function(){var c=
[];a.hasRowHeaders()&&c.push(function(a,c){b.appendRowHeader(a,c)});Handsontable.hooks.run(a,"afterGetRowHeaderRenderers",c);return c},columnHeaders:function(){var c=[];a.hasColHeaders()&&c.push(function(a,c){b.appendColHeader(a,c)});Handsontable.hooks.run(a,"afterGetColumnHeaderRenderers",c);return c},columnWidth:a.getColWidth,rowHeight:a.getRowHeight,cellRenderer:function(a,c,d){var e=b.instance.colToProp(c),f=b.instance.getCellMeta(a,c),g=b.instance.getCellRenderer(f),n=b.instance.getDataAtRowProp(a,
e);g(b.instance,d,a,c,e,n,f);Handsontable.hooks.run(b.instance,"afterRenderer",d,a,c,e,n,f)},selections:e,hideBorderOnMouseDownOver:function(){return b.settings.fragmentSelection},onCellMouseDown:function(c,e,f,g){a.listen();b.activeWt=g;d=!0;p.enableImmediatePropagation(c);Handsontable.hooks.run(a,"beforeOnCellMouseDown",c,e,f);c.isImmediatePropagationStopped()||(2===c.button&&a.selection.inInSelection(e)||(c.shiftKey?0<=e.row&&0<=e.col&&a.selection.setRangeEnd(e):(0>e.row||0>e.col)&&(0<=e.row||
0<=e.col)?(0>e.row&&(a.selectCell(0,e.col,a.countRows()-1,e.col),a.selection.setSelectedHeaders(!1,!0)),0>e.col&&(a.selectCell(e.row,0,e.row,a.countCols()-1),a.selection.setSelectedHeaders(!0,!1))):(e.row=0>e.row?0:e.row,e.col=0>e.col?0:e.col,a.selection.setRangeStart(e))),Handsontable.hooks.run(a,"afterOnCellMouseDown",c,e,f),b.activeWt=b.wt)},onCellMouseOver:function(c,e,f,g){b.activeWt=g;0<=e.row&&0<=e.col?d&&a.selection.setRangeEnd(e):d&&(0>e.row&&(a.selection.setRangeEnd(new t(a.countRows()-
1,e.col)),a.selection.setSelectedHeaders(!1,!0)),0>e.col&&(a.selection.setRangeEnd(new t(e.row,a.countCols()-1)),a.selection.setSelectedHeaders(!0,!1)));Handsontable.hooks.run(a,"afterOnCellMouseOver",c,e,f);b.activeWt=b.wt},onCellCornerMouseDown:function(b){b.preventDefault();Handsontable.hooks.run(a,"afterOnCellCornerMouseDown",b)},beforeDraw:function(a){b.beforeRender(a)},onDraw:function(a){b.onDraw(a)},onScrollVertically:function(){a.runHooks("afterScrollVertically")},onScrollHorizontally:function(){a.runHooks("afterScrollHorizontally")},
onBeforeDrawBorders:function(b,c){a.runHooks("beforeDrawBorders",b,c)},onBeforeTouchScroll:function(){a.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){a.runHooks("afterMomentumScroll")},viewportRowCalculatorOverride:function(c){b.settings.viewportRowRenderingOffset&&(c.startRow=Math.max(c.startRow-b.settings.viewportRowRenderingOffset,0),c.endRow=Math.min(c.endRow+b.settings.viewportRowRenderingOffset,a.countRows()-1));a.runHooks("afterViewportRowCalculatorOverride",c)},viewportColumnCalculatorOverride:function(c){b.settings.viewportColumnRenderingOffset&&
(c.startColumn=Math.max(c.startColumn-b.settings.viewportColumnRenderingOffset,0),c.endColumn=Math.min(c.endColumn+b.settings.viewportColumnRenderingOffset,a.countCols()-1));a.runHooks("afterViewportColumnCalculatorOverride",c)}};Handsontable.hooks.run(a,"beforeInitWalkontable",c);this.activeWt=this.wt=new f(c);this.eventManager.addEventListener(b.wt.wtTable.spreader,"mousedown",function(a){a.target===b.wt.wtTable.spreader&&3===a.which&&l.stopPropagation(a)});this.eventManager.addEventListener(b.wt.wtTable.spreader,
"contextmenu",function(a){a.target===b.wt.wtTable.spreader&&3===a.which&&l.stopPropagation(a)});this.eventManager.addEventListener(document.documentElement,"click",function(){b.settings.observeDOMVisibility&&b.wt.drawInterrupted&&(b.instance.forceFullRender=!0,b.render())})}Object.defineProperties(r,{TableView:{get:function(){return a}},__esModule:{value:!0}});var e,d,k,m,c,b,p=(e=h("./dom.js"),e&&e.__esModule&&e||{default:e}),l=(d=h("./helpers.js"),d&&d.__esModule&&d||{default:d}),g=(k=h("./eventManager.js"),
k&&k.__esModule&&k||{default:k}).eventManager,t=(m=h("./3rdparty/walkontable/src/cell/coords.js"),m&&m.__esModule&&m||{default:m}).WalkontableCellCoords,v=(c=h("./3rdparty/walkontable/src/selection.js"),c&&c.__esModule&&c||{default:c}).WalkontableSelection,f=(b=h("./3rdparty/walkontable/src/core.js"),b&&b.__esModule&&b||{default:b}).Walkontable;Handsontable.TableView=a;a.prototype.isTextSelectionAllowed=function(a){return l.isInput(a)||this.settings.fragmentSelection&&p.isChildOf(a,this.TBODY)?!0:
!1};a.prototype.isCellEdited=function(){var a=this.instance.getActiveEditor();return a&&a.isOpened()};a.prototype.beforeRender=function(a){a&&Handsontable.hooks.run(this.instance,"beforeRender",this.instance.forceFullRender)};a.prototype.onDraw=function(a){a&&Handsontable.hooks.run(this.instance,"afterRender",this.instance.forceFullRender)};a.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender);this.instance.forceFullRender=!1};a.prototype.getCellAtCoords=function(a,b){var c=this.wt.getCell(a,
b);return 0>c?null:c};a.prototype.scrollViewport=function(a){this.wt.scrollViewport(a)};a.prototype.appendRowHeader=function(a,b){if(b.firstChild){var c=b.firstChild;if(!p.hasClass(c,"relative")){p.empty(b);this.appendRowHeader(a,b);return}this.updateCellHeader(c.firstChild,a,this.instance.getRowHeader)}else{var c=document.createElement("div"),d=document.createElement("span");c.className="relative";d.className="colHeader";this.updateCellHeader(d,a,this.instance.getRowHeader);c.appendChild(d);b.appendChild(c)}Handsontable.hooks.run(this.instance,
"afterGetRowHeader",a,b)};a.prototype.appendColHeader=function(a,b){if(b.firstChild){var c=b.firstChild;if(!p.hasClass(c,"relative")){p.empty(b);this.appendRowHeader(a,b);return}this.updateCellHeader(c.firstChild,a,this.instance.getColHeader)}else{var c=document.createElement("div"),d=document.createElement("span");c.className="relative";d.className="colHeader";this.updateCellHeader(d,a,this.instance.getColHeader);c.appendChild(d);b.appendChild(c)}Handsontable.hooks.run(this.instance,"afterGetColHeader",
a,b)};a.prototype.updateCellHeader=function(a,b,c){-1<b?p.fastInnerHTML(a,c(b)):(p.fastInnerText(a,String.fromCharCode(160)),p.addClass(a,"cornerHeader"))};a.prototype.maximumVisibleElementWidth=function(a){a=this.wt.wtViewport.getWorkspaceWidth()-a;return 0<a?a:0};a.prototype.maximumVisibleElementHeight=function(a){a=this.wt.wtViewport.getWorkspaceHeight()-a;return 0<a?a:0};a.prototype.mainViewIsActive=function(){return this.wt===this.activeWt};a.prototype.destroy=function(){this.wt.destroy();this.eventManager.clear()}},
{"./3rdparty/walkontable/src/cell/coords.js":5,"./3rdparty/walkontable/src/core.js":7,"./3rdparty/walkontable/src/selection.js":18,"./dom.js":27,"./eventManager.js":41,"./helpers.js":42}],86:[function(h,q,r){var a=function(a,d){var k="string"===typeof a?a.toLowerCase():null;return function(m){for(var c=!1,b=0,p=m.length;b<p;b++)if(a===m[b]){c=!0;break}else if(k===Handsontable.helper.stringify(m[b]).toLowerCase()){c=!0;break}d(c)}};Handsontable.AutocompleteValidator=function(e,d){this.strict&&this.source?
"function"===typeof this.source?this.source(e,a(e,d)):a(e,d)(this.source):d(!0)}},{}],87:[function(h,q,r){var a,e=(a=h("moment"),a&&a.__esModule&&a||{default:a}).default;Handsontable.DateValidator=function(a,k){var m=null,m=!0,c=Handsontable.editors.getEditor("date",this.instance);null===a&&(a="");var b=e(new Date(a)).isValid(),c=e(a,this.dateFormat||c.defaultDateFormat,!0).isValid();b||(m=!1);!b&&c&&(m=!0);b&&!c&&(!0===this.correctFormat?(m=this.dateFormat,m=e(new Date(a)).format(m),this.instance.setDataAtCell(this.row,
this.col,m,"dateValidator"),m=!0):m=!1);k(m)}},{moment:"moment"}],88:[function(h,q,r){Handsontable.NumericValidator=function(a,e){null===a&&(a="");e(/^-?\d*(\.|\,)?\d*$/.test(a))}},{}],SheetClip:[function(h,q,r){(function(a){var e={parse:function(a){var e,m,c=[],b=0,p,l,g,h;m=a.split("\n");1<m.length&&""===m[m.length-1]&&m.pop();a=0;for(e=m.length;a<e;a+=1){m[a]=m[a].split("\t");p=0;for(l=m[a].length;p<l;p+=1)c[b]||(c[b]=[]),g&&0===p?(h=c[b].length-1,c[b][h]=c[b][h]+"\n"+m[a][0],g&&m[a][0].split('"').length-
1&1&&(g=!1,c[b][h]=c[b][h].substring(0,c[b][h].length-1).replace(/""/g,'"'))):p===l-1&&0===m[a][p].indexOf('"')&&m[a][p].split('"').length-1&1?(c[b].push(m[a][p].substring(1).replace(/""/g,'"')),g=!0):(c[b].push(m[a][p].replace(/""/g,'"')),g=!1);g||(b+=1)}return c},stringify:function(a){var e,m,c,b,h="",l;e=0;for(m=a.length;e<m;e+=1){b=a[e].length;for(c=0;c<b;c+=1)0<c&&(h+="\t"),l=a[e][c],h="string"===typeof l?-1<l.indexOf("\n")?h+('"'+l.replace(/"/g,'""')+'"'):h+l:null===l||void 0===l?h+"":h+l;h+=
"\n"}return h}};"undefined"!==typeof r?(r.parse=e.parse,r.stringify=e.stringify):a.SheetClip=e})(window)},{}],autoResize:[function(h,q,r){function a(){var a=200,d=300,k=100,m=300,c,b=document.body,h=document.createTextNode(""),l=document.createElement("SPAN"),g=function(a,b,c){window.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c,!1)},q=function(a,b,c){window.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent("on"+b,c)},v=function(f){f?/^[a-zA-Z \.,\\\/\|0-9]$/.test(f)||(f=
"."):f="";void 0!==h.textContent?h.textContent=c.value+f:h.data=c.value+f;l.style.fontSize=Handsontable.Dom.getComputedStyle(c).fontSize;l.style.fontFamily=Handsontable.Dom.getComputedStyle(c).fontFamily;l.style.whiteSpace="pre";b.appendChild(l);f=l.clientWidth+2;b.removeChild(l);c.style.height=a+"px";c.style.width=k>f?k+"px":f>m?m+"px":f+"px";f=c.scrollHeight?c.scrollHeight-1:0;a>f?c.style.height=a+"px":d<f?(c.style.height=d+"px",c.style.overflowY="visible"):c.style.height=f+"px"},f=function(){window.setTimeout(v,
0)};return{init:function(b,w,q){c=b;w&&w.minHeight&&("inherit"==w.minHeight?a=c.clientHeight:(b=parseInt(w.minHeight),isNaN(b)||(a=b)));w&&w.maxHeight&&("inherit"==w.maxHeight?d=c.clientHeight:(b=parseInt(w.maxHeight),isNaN(b)||(d=b)));w&&w.minWidth&&("inherit"==w.minWidth?k=c.clientWidth:(b=parseInt(w.minWidth),isNaN(b)||(k=b)));w&&w.maxWidth&&("inherit"==w.maxWidth?m=c.clientWidth:(w=parseInt(w.maxWidth),isNaN(w)||(m=w)));l.firstChild||(l.className="autoResize",l.style.display="inline-block",l.appendChild(h));
"TEXTAREA"==c.nodeName&&(c.style.resize="none",c.style.overflowY="",c.style.height=a+"px",c.style.minWidth=k+"px",c.style.maxWidth=m+"px",c.style.overflowY="hidden");q&&(g(c,"change",v),g(c,"cut",f),g(c,"paste",f),g(c,"drop",f),g(c,"keydown",f));v()},unObserve:function(){q(c,"change",v);q(c,"cut",f);q(c,"paste",f);q(c,"drop",f);q(c,"keydown",f)},resize:v}}"undefined"!==typeof r&&(q.exports=a)},{}],copyPaste:[function(h,q,r){function a(){d?d.hasBeenDestroyed()&&d.init():d=new e;d.refCounter++;return d}
function e(){this.refCounter=0;this.init()}var d;"undefined"!==typeof r&&(q.exports=a);e.prototype.init=function(){var a,d;this.copyCallbacks=[];this.cutCallbacks=[];this.pasteCallbacks=[];d=document.body;document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("div"),this.elDiv.id="CopyPasteDiv",a=this.elDiv.style,a.position="fixed",a.top="-10000px",a.left="-10000px",d.appendChild(this.elDiv),
this.elTextarea=document.createElement("textarea"),this.elTextarea.className="copyPaste",this.elTextarea.onpaste=function(a){if("WebkitAppearance"in document.documentElement.style)return a=a.clipboardData.getData("Text"),-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&(a=a.split("\n"),a.pop(),a=a.join("\n")),this.value=a,!1},a=this.elTextarea.style,a.width="10000px",a.height="10000px",a.overflow="hidden",this.elDiv.appendChild(this.elTextarea),"undefined"!==
typeof a.opacity&&(a.opacity=0));this.onKeyDownRef=this.onKeyDown.bind(this);document.documentElement.addEventListener("keydown",this.onKeyDownRef,!1)};e.prototype.onKeyDown=function(a){function d(){var a=document.activeElement;a.shadowRoot&&a.shadowRoot.activeElement&&(a=a.shadowRoot.activeElement);return-1<["INPUT","SELECT","TEXTAREA"].indexOf(a.nodeName)||"true"===a.contentEditable}var c=this,b=!1;a.metaKey?b=!0:a.ctrlKey&&-1===navigator.userAgent.indexOf("Mac")&&(b=!0);if(b){if(document.activeElement!==
this.elTextarea&&(""!==this.getSelectionText()||d()))return;this.selectNodeText(this.elTextarea);setTimeout(function(){document.activeElement!==c.elTextarea&&c.selectNodeText(c.elTextarea)},0)}!b||67!==a.keyCode&&86!==a.keyCode&&88!==a.keyCode||(a.keyCode===helper.keyCode.X?setTimeout(function(){c.triggerCut(a)},0):a.keyCode===helper.keyCode.V&&setTimeout(function(){c.triggerPaste(a)},0))};e.prototype.selectNodeText=function(a){a&&a.select()};e.prototype.getSelectionText=function(){var a="";window.getSelection?
a=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(a=document.selection.createRange().text);return a};e.prototype.copyable=function(a){if("string"!==typeof a&&void 0===a.toString)throw Error("copyable requires string parameter");this.elTextarea.value=a;this.selectNodeText(this.elTextarea)};e.prototype.onCut=function(a){this.cutCallbacks.push(a)};e.prototype.onPaste=function(a){this.pasteCallbacks.push(a)};e.prototype.removeCallback=function(a){var d,c;d=0;
for(c=this.copyCallbacks.length;d<c;d++)if(this.copyCallbacks[d]===a)return this.copyCallbacks.splice(d,1),!0;d=0;for(c=this.cutCallbacks.length;d<c;d++)if(this.cutCallbacks[d]===a)return this.cutCallbacks.splice(d,1),!0;d=0;for(c=this.pasteCallbacks.length;d<c;d++)if(this.pasteCallbacks[d]===a)return this.pasteCallbacks.splice(d,1),!0;return!1};e.prototype.triggerCut=function(a){var d=this;d.cutCallbacks&&setTimeout(function(){for(var c=0,b=d.cutCallbacks.length;c<b;c++)d.cutCallbacks[c](a)},50)};
e.prototype.triggerPaste=function(a,d){var c=this;c.pasteCallbacks&&setTimeout(function(){for(var b=d||c.elTextarea.value,e=0,l=c.pasteCallbacks.length;e<l;e++)c.pasteCallbacks[e](b,a)},50)};e.prototype.destroy=function(){this.hasBeenDestroyed()||0!==--this.refCounter||(this.elDiv&&this.elDiv.parentNode&&(this.elDiv.parentNode.removeChild(this.elDiv),this.elTextarea=this.elDiv=null),document.documentElement.removeEventListener("keydown",this.onKeyDownRef))};e.prototype.hasBeenDestroyed=function(){return!this.refCounter}},
{}],jsonpatch:[function(h,q,r){var a;(function(a){function d(a){return-1===a.indexOf("/")&&-1===a.indexOf("~")?a:a.replace(/~/g,"~0").replace(/\//g,"~1")}function k(a,b){var c,e;for(e in a)if(a.hasOwnProperty(e)){if(a[e]===b)return d(e)+"/";if("object"===typeof a[e]&&(c=k(a[e],b),""!=c))return d(e)+"/"+c}return""}function m(a,b){if(a===b)return"/";var c=k(a,b);if(""===c)throw Error("Object not found in root");return"/"+c}function c(a){for(var b=0,c=r.length;b<c;b++)if(r[b].obj===a)return r[b]}function b(a,
b){for(var c=0,d=a.observers.length;c<d;c++)if(a.observers[c].callback===b)return a.observers[c].observer}function h(a,b){if(Object.observe){Object.observe(b,a);for(var c in b)if(b.hasOwnProperty(c)){var d=b[c];d&&"object"===typeof d&&h(a,d)}}return a}function l(a,b){if(Object.observe){Object.unobserve(b,a);for(var c in b)if(b.hasOwnProperty(c)){var d=b[c];d&&"object"===typeof d&&l(a,d)}}return a}function g(a){if(Object.observe)Object.deliverChangeRecords(a);else{for(var b,c=0,d=r.length;c<d;c++)if(r[c].obj===
a.object){b=r[c];break}q(b.value,a.object,a.patches,"")}b=a.patches;0<b.length&&(a.patches=[],a.callback&&a.callback(b));return b}function q(a,b,c,e){for(var f=y(b),g=y(a),k=!1,n=g.length-1;0<=n;n--){var l=g[n],h=a[l];if(b.hasOwnProperty(l)){var m=b[l];h instanceof Object?q(h,m,c,e+"/"+d(l)):h!=m&&(c.push({op:"replace",path:e+"/"+d(l),value:m}),a[l]=m)}else c.push({op:"remove",path:e+"/"+d(l)}),delete a[l],k=!0}if(k||f.length!=g.length)for(n=0;n<f.length;n++)l=f[n],a.hasOwnProperty(l)||(c.push({op:"add",
path:e+"/"+d(l),value:b[l]}),a[l]=JSON.parse(JSON.stringify(b[l])))}function v(a,b){for(var c=!1,d=0,e=b.length;d<e;){for(var c=b[d],g=c.path.split("/"),k=a,l=1,h=g.length;;){if(F(k)){var m=parseInt(g[l],10);l++;if(l>=h){c=n[c.op].call(c,k,m,a);break}}else if(m=g[l],-1!=m.indexOf("~")&&(m=m.replace(/~1/g,"/").replace(/~0/g,"~")),l++,l>=h){c=f[c.op].call(c,k,m,a);break}k=k[m]}d++}return c}var f={add:function(a,b){a[b]=this.value;return!0},remove:function(a,b){delete a[b];return!0},replace:function(a,
b){a[b]=this.value;return!0},move:function(a,b,c){a={op:"_get",path:this.from};v(c,[a]);v(c,[{op:"remove",path:this.from}]);v(c,[{op:"add",path:this.path,value:a.value}]);return!0},copy:function(a,b,c){a={op:"_get",path:this.from};v(c,[a]);v(c,[{op:"add",path:this.path,value:a.value}]);return!0},test:function(a,b){return JSON.stringify(a[b])===JSON.stringify(this.value)},_get:function(a,b){this.value=a[b]}},n={add:function(a,b){a.splice(b,0,this.value);return!0},remove:function(a,b){a.splice(b,1);
return!0},replace:function(a,b){a[b]=this.value;return!0},move:f.move,copy:f.copy,test:f.test,_get:f._get},w={add:function(a,b){var c={op:"add",path:b+d(this.name),value:this.object[this.name]};a.push(c)},"delete":function(a,b){var c={op:"remove",path:b+d(this.name)};a.push(c)},update:function(a,b){var c={op:"replace",path:b+d(this.name),value:this.object[this.name]};a.push(c)}},r=[];a.intervals;var N=function(){return function(a){this.observers=[];this.obj=a}}(),W=function(){return function(a,b){this.callback=
a;this.observer=b}}();a.unobserve=function(a,b){g(b);Object.observe?l(b,a):clearTimeout(b.next);a:for(var d=c(a),e=0,f=d.observers.length;e<f;e++)if(d.observers[e].observer===b){d.observers.splice(e,1);break a}};a.observe=function(a,d){var e=[],f,k=c(a);k?f=b(k,d):(k=new N(a),r.push(k));if(f)return f;if(Object.observe)f=function(b){l(f,a);h(f,a);for(var c=0,g=b.length;c<g;){if(("length"!==b[c].name||!F(b[c].object))&&"__Jasmine_been_here_before__"!==b[c].name){var k=b[c].type;switch(k){case "new":k=
"add";break;case "deleted":k="delete";break;case "updated":k="update"}w[k].call(b[c],e,m(a,b[c].object))}c++}e&&d&&d(e);f.patches=e;e=[]};else if(f={},k.value=JSON.parse(JSON.stringify(a)),d){f.callback=d;f.next=null;var n=this.intervals||[100,1E3,1E4,6E4],v=0,q=function(){clearTimeout(f.next);f.next=setTimeout(function(){g(f);v=0;f.next=setTimeout(t,n[v++])},0)},t=function(){g(f);v==n.length&&(v=n.length-1);f.next=setTimeout(t,n[v++])};"undefined"!==typeof window&&(window.addEventListener?(window.addEventListener("mousedown",
q),window.addEventListener("mouseup",q),window.addEventListener("keydown",q)):(window.attachEvent("onmousedown",q),window.attachEvent("onmouseup",q),window.attachEvent("onkeydown",q)));f.next=setTimeout(t,n[v++])}f.patches=e;f.object=a;k.observers.push(new W(d,f));return h(f,a)};a.generate=g;var y;y=Object.keys?Object.keys:function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c);return b};var F;F=Array.isArray?Array.isArray:function(a){return a.push&&"number"===typeof a.length};a.apply=v})(a||
(a={}));"undefined"!==typeof r&&(r.apply=a.apply,r.observe=a.observe,r.unobserve=a.unobserve,r.generate=a.generate)},{}],moment:[function(h,q,r){(function(a,e){"object"===typeof r&&"undefined"!==typeof q?q.exports=e():"function"===typeof define&&define.amd?define(e):a.moment=e()})(this,function(){function a(){return hb.apply(null,arguments)}function e(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}
function d(a){return"[object Array]"===Object.prototype.toString.call(a)}function k(a){return"[object Date]"===Object.prototype.toString.call(a)||a instanceof Date}function m(a,b){var c=[],d;for(d=0;d<a.length;++d)c.push(b(a[d],d));return c}function c(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function b(a,b){for(var d in b)c(b,d)&&(a[d]=b[d]);c(b,"toString")&&(a.toString=b.toString);c(b,"valueOf")&&(a.valueOf=b.valueOf);return a}function p(a,b,c,d){return fb(a,b,c,d,!0).utc()}function l(a){null==
a._isValid&&(a._isValid=!isNaN(a._d.getTime())&&0>a._pf.overflow&&!a._pf.empty&&!a._pf.invalidMonth&&!a._pf.nullInput&&!a._pf.invalidFormat&&!a._pf.userInvalidated,a._strict&&(a._isValid=a._isValid&&0===a._pf.charsLeftOver&&0===a._pf.unusedTokens.length&&void 0===a._pf.bigHour));return a._isValid}function g(a){var c=p(NaN);null!=a?b(c._pf,a):c._pf.userInvalidated=!0;return c}function t(a,b){var c,d,e;"undefined"!==typeof b._isAMomentObject&&(a._isAMomentObject=b._isAMomentObject);"undefined"!==typeof b._i&&
(a._i=b._i);"undefined"!==typeof b._f&&(a._f=b._f);"undefined"!==typeof b._l&&(a._l=b._l);"undefined"!==typeof b._strict&&(a._strict=b._strict);"undefined"!==typeof b._tzm&&(a._tzm=b._tzm);"undefined"!==typeof b._isUTC&&(a._isUTC=b._isUTC);"undefined"!==typeof b._offset&&(a._offset=b._offset);"undefined"!==typeof b._pf&&(a._pf=b._pf);"undefined"!==typeof b._locale&&(a._locale=b._locale);if(0<$a.length)for(c in $a)d=$a[c],e=b[d],"undefined"!==typeof e&&(a[d]=e);return a}function v(b){t(this,b);this._d=
new Date(+b._d);!1===ab&&(ab=!0,a.updateOffset(this),ab=!1)}function f(a){return a instanceof v||null!=a&&c(a,"_isAMomentObject")}function n(a){a=+a;var b=0;0!==a&&isFinite(a)&&(b=0<=a?Math.floor(a):Math.ceil(a));return b}function w(a,b,c){var d=Math.min(a.length,b.length),e=Math.abs(a.length-b.length),f=0,g;for(g=0;g<d;g++)(c&&a[g]!==b[g]||!c&&n(a[g])!==n(b[g]))&&f++;return f+e}function r(){}function N(a){return a?a.toLowerCase().replace("_","-"):a}function W(a){var b=null;if(!wa[a]&&"undefined"!==
typeof q&&q&&q.exports)try{b=Pa._abbr,h("./locale/"+a),y(b)}catch(c){}return wa[a]}function y(a,b){var c;a&&(c="undefined"===typeof b?B(a):F(a,b))&&(Pa=c);return Pa._abbr}function F(a,b){if(null!==b)return b.abbr=a,wa[a]||(wa[a]=new r),wa[a].set(b),y(a),wa[a];delete wa[a];return null}function B(a){var b;a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr);if(!a)return Pa;if(!d(a)){if(b=W(a))return b;a=[a]}a:{b=0;for(var c,e,f,g;b<a.length;){g=N(a[b]).split("-");c=g.length;for(e=(e=N(a[b+1]))?e.split("-"):
null;0<c;){if(f=W(g.slice(0,c).join("-"))){a=f;break a}if(e&&e.length>=c&&w(g,e,!0)>=c-1)break;c--}b++}a=null}return a}function z(a,b){var c=a.toLowerCase();Ha[c]=Ha[c+"s"]=Ha[b]=a}function A(a){return"string"===typeof a?Ha[a]||Ha[a.toLowerCase()]:void 0}function H(a){var b={},d,e;for(e in a)c(a,e)&&(d=A(e))&&(b[d]=a[e]);return b}function M(b,c){return function(d){return null!=d?(this._d["set"+(this._isUTC?"UTC":"")+b](d),a.updateOffset(this,c),this):O(this,b)}}function O(a,b){return a._d["get"+(a._isUTC?
"UTC":"")+b]()}function U(a,b){var c;if("object"===typeof a)for(c in a)this.set(c,a[c]);else if(a=A(a),"function"===typeof this[a])return this[a](b);return this}function D(a,b,c){for(var d=""+Math.abs(a);d.length<b;)d="0"+d;return(0<=a?c?"+":"":"-")+d}function x(a,b,c,d){var e=d;"string"===typeof d&&(e=function(){return this[d]()});a&&(xa[a]=e);b&&(xa[b[0]]=function(){return D(e.apply(this,arguments),b[1],b[2])});c&&(xa[c]=function(){return this.localeData().ordinal(e.apply(this,arguments),a)})}function Z(a){return a.match(/\[[\s\S]/)?
a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function S(a){var b=a.match(ib),c,d;c=0;for(d=b.length;c<d;c++)b[c]=xa[b[c]]?xa[b[c]]:Z(b[c]);return function(e){var f="";for(c=0;c<d;c++)f+=b[c]instanceof Function?b[c].call(e,a):b[c];return f}}function L(a,b){if(!a.isValid())return a.localeData().invalidDate();b=ca(b,a.localeData());bb[b]||(bb[b]=S(b));return bb[b](a)}function ca(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(Ia.lastIndex=0;0<=d&&Ia.test(a);)a=a.replace(Ia,c),Ia.lastIndex=
0,--d;return a}function E(a,b,c){ub[a]="function"===typeof b?b:function(a){return a&&c?c:b}}function da(a,b){return c(ub,a)?ub[a](b._strict,b._locale):new RegExp(u(a))}function u(a){return a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function R(a,b){var c,d=b;"string"===typeof a&&(a=[a]);"number"===typeof b&&(d=function(a,c){c[b]=n(a)});for(c=0;c<a.length;c++)vb[a[c]]=d}function K(a,b){R(a,function(a,
c,d,e){d._w=d._w||{};b(a,d._w,d,e)})}function ea(a,b){return(new Date(Date.UTC(a,b+1,0))).getUTCDate()}function Y(a,b){var c;if("string"===typeof b&&(b=a.localeData().monthsParse(b),"number"!==typeof b))return a;c=Math.min(a.date(),ea(a.year(),b));a._d["set"+(a._isUTC?"UTC":"")+"Month"](b,c);return a}function fa(b){return null!=b?(Y(this,b),a.updateOffset(this,!0),this):O(this,"Month")}function ga(a){var b;(b=a._a)&&-2===a._pf.overflow&&(b=0>b[ya]||11<b[ya]?ya:1>b[ua]||b[ua]>ea(b[za],b[ya])?ua:0>
b[ka]||24<b[ka]||24===b[ka]&&(0!==b[Ja]||0!==b[Ka]||0!==b[La])?ka:0>b[Ja]||59<b[Ja]?Ja:0>b[Ka]||59<b[Ka]?Ka:0>b[La]||999<b[La]?La:-1,a._pf._overflowDayOfYear&&(b<za||b>ua)&&(b=ua),a._pf.overflow=b);return a}function J(b){!1===a.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+b)}function ba(a,c){var d=!0;return b(function(){d&&(J(a),d=!1);return c.apply(this,arguments)},c)}function oa(a){var b,c,d=a._i,e=Fb.exec(d);if(e){a._pf.iso=!0;b=
0;for(c=wb.length;b<c;b++)if(wb[b][1].exec(d)){a._f=wb[b][0]+(e[6]||" ");break}b=0;for(c=xb.length;b<c;b++)if(xb[b][1].exec(d)){a._f+=xb[b][0];break}d.match(jb)&&(a._f+="Z");Fa(a)}else a._isValid=!1}function sa(b){var c=Gb.exec(b._i);null!==c?b._d=new Date(+c[1]):(oa(b),!1===b._isValid&&(delete b._isValid,a.createFromInputFallback(b)))}function ra(a,b,c,d,e,f,g){b=new Date(a,b,c,d,e,f,g);1970>a&&b.setFullYear(a);return b}function ha(a){var b=new Date(Date.UTC.apply(null,arguments));1970>a&&b.setUTCFullYear(a);
return b}function ia(a){return 0===a%4&&0!==a%100||0===a%400}function ja(a,b,c){b=c-b;c-=a.day();c>b&&(c-=7);c<b-7&&(c+=7);a=T(a).add(c,"d");return{week:Math.ceil(a.dayOfYear()/7),year:a.year()}}function X(a,b,c){return null!=a?a:null!=b?b:c}function va(a){var b,c,d=[],e;if(!a._d){e=new Date;e=a._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()];if(a._w&&null==a._a[ua]&&null==a._a[ya]){var f,g,k;f=a._w;null!=f.GG||null!=f.W||null!=f.E?(b=1,k=4,c=
X(f.GG,a._a[za],ja(T(),1,4).year),g=X(f.W,1),f=X(f.E,1)):(b=a._locale._week.dow,k=a._locale._week.doy,c=X(f.gg,a._a[za],ja(T(),b,k).year),g=X(f.w,1),null!=f.d?(f=f.d,f<b&&++g):f=null!=f.e?f.e+b:b);var n=ha(c,0,1).getUTCDay(),n=0===n?7:n;k=7*(g-1)+((null!=f?f:b)-b)+(b-n+(n>k?7:0)-(n<b?7:0))+1;b=0<k?c:c-1;c=0<k?k:(ia(c-1)?366:365)+k;a._a[za]=b;a._dayOfYear=c}a._dayOfYear&&(c=X(a._a[za],e[za]),a._dayOfYear>(ia(c)?366:365)&&(a._pf._overflowDayOfYear=!0),c=ha(c,0,a._dayOfYear),a._a[ya]=c.getUTCMonth(),
a._a[ua]=c.getUTCDate());for(c=0;3>c&&null==a._a[c];++c)a._a[c]=d[c]=e[c];for(;7>c;c++)a._a[c]=d[c]=null==a._a[c]?2===c?1:0:a._a[c];24===a._a[ka]&&0===a._a[Ja]&&0===a._a[Ka]&&0===a._a[La]&&(a._nextDay=!0,a._a[ka]=0);a._d=(a._useUTC?ha:ra).apply(null,d);null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm);a._nextDay&&(a._a[ka]=24)}}function Fa(b){if(b._f===a.ISO_8601)oa(b);else{b._a=[];b._pf.empty=!0;var d=""+b._i,e,f,g,k,n,l=d.length,m=0;g=ca(b._f,b._locale).match(ib)||[];for(e=0;e<g.length;e++){k=
g[e];if(f=(d.match(da(k,b))||[])[0])n=d.substr(0,d.indexOf(f)),0<n.length&&b._pf.unusedInput.push(n),d=d.slice(d.indexOf(f)+f.length),m+=f.length;if(xa[k]){if(f?b._pf.empty=!1:b._pf.unusedTokens.push(k),n=b,null!=f&&c(vb,k))vb[k](f,n._a,n,k)}else b._strict&&!f&&b._pf.unusedTokens.push(k)}b._pf.charsLeftOver=l-m;0<d.length&&b._pf.unusedInput.push(d);!0===b._pf.bigHour&&12>=b._a[ka]&&(b._pf.bigHour=void 0);d=b._a;e=ka;l=b._locale;g=b._a[ka];m=b._meridiem;null!=m&&(null!=l.meridiemHour?g=l.meridiemHour(g,
m):null!=l.isPM&&((l=l.isPM(m))&&12>g&&(g+=12),l||12!==g||(g=0)));d[e]=g;va(b);ga(b)}}function Ma(a){if(!a._d){var b=H(a._i);a._a=[b.year,b.month,b.day||b.date,b.hour,b.minute,b.second,b.millisecond];va(a)}}function Na(b){var c=b._i;void 0===c?b._d=new Date:k(c)?b._d=new Date(+c):"string"===typeof c?sa(b):d(c)?(b._a=m(c.slice(0),function(a){return parseInt(a,10)}),va(b)):"object"===typeof c?Ma(b):"number"===typeof c?b._d=new Date(c):a.createFromInputFallback(b)}function fb(a,c,k,n,m){var h={};"boolean"===
typeof k&&(n=k,k=void 0);h._isAMomentObject=!0;h._useUTC=h._isUTC=m;h._l=k;h._i=a;h._f=c;h._strict=n;h._pf=e();a=h._i;c=h._f;h._locale=h._locale||B(h._l);if(null===a||void 0===c&&""===a)h=g({nullInput:!0});else if("string"===typeof a&&(h._i=a=h._locale.preparse(a)),f(a))h=new v(ga(a));else{if(d(c)){var p,xa,Wa;if(0===h._f.length)h._pf.invalidFormat=!0,h._d=new Date(NaN);else{for(a=0;a<h._f.length;a++)if(c=0,p=t({},h),null!=h._useUTC&&(p._useUTC=h._useUTC),p._pf=e(),p._f=h._f[a],Fa(p),l(p)&&(c+=p._pf.charsLeftOver,
c+=10*p._pf.unusedTokens.length,p._pf.score=c,null==Wa||c<Wa))Wa=c,xa=p;b(h,xa||p)}}else c?Fa(h):Na(h);h=new v(ga(h));h._nextDay&&(h.add(1,"d"),h._nextDay=void 0)}return h}function T(a,b,c,d){return fb(a,b,c,d,!1)}function gb(a,b){var c,e;1===b.length&&d(b[0])&&(b=b[0]);if(!b.length)return T();c=b[0];for(e=1;e<b.length;++e)b[e][a](c)&&(c=b[e]);return c}function Ga(a){a=H(a);var b=a.year||0,c=a.quarter||0,d=a.month||0,e=a.week||0,f=a.day||0;this._milliseconds=+(a.millisecond||0)+1E3*(a.second||0)+
6E4*(a.minute||0)+36E5*(a.hour||0);this._days=+f+7*e;this._months=+d+3*c+12*b;this._data={};this._locale=B();this._bubble()}function Oa(a){return a instanceof Ga}function Ya(a,b){x(a,0,0,function(){var a=this.utcOffset(),c="+";0>a&&(a=-a,c="-");return c+D(~~(a/60),2)+b+D(~~a%60,2)})}function Za(a){a=(a||"").match(jb)||[];a=((a[a.length-1]||[])+"").match(Hb)||["-",0,0];var b=+(60*a[1])+n(a[2]);return"+"===a[0]?b:-b}function pa(b,c){var d,e;return c._isUTC?(d=c.clone(),e=(f(b)||k(b)?+b:+T(b))-+d,d._d.setTime(+d._d+
e),a.updateOffset(d,!1),d):T(b).local()}function kb(){return this._isUTC&&0===this._offset}function la(a,b){var d=a,e=null;Oa(a)?d={ms:a._milliseconds,d:a._days,M:a._months}:"number"===typeof a?(d={},b?d[b]=a:d.milliseconds=a):(e=Ib.exec(a))?(d="-"===e[1]?-1:1,d={y:0,d:n(e[ua])*d,h:n(e[ka])*d,m:n(e[Ja])*d,s:n(e[Ka])*d,ms:n(e[La])*d}):(e=Jb.exec(a))?(d="-"===e[1]?-1:1,d={y:Aa(e[2],d),M:Aa(e[3],d),d:Aa(e[4],d),h:Aa(e[5],d),m:Aa(e[6],d),s:Aa(e[7],d),w:Aa(e[8],d)}):null==d?d={}:"object"===typeof d&&("from"in
d||"to"in d)&&(e=T(d.from),d=T(d.to),d=pa(d,e),e.isBefore(d)?d=lb(e,d):(d=lb(d,e),d.milliseconds=-d.milliseconds,d.months=-d.months),e=d,d={},d.ms=e.milliseconds,d.M=e.months);d=new Ga(d);Oa(a)&&c(a,"_locale")&&(d._locale=a._locale);return d}function Aa(a,b){var c=a&&parseFloat(a.replace(",","."));return(isNaN(c)?0:c)*b}function lb(a,b){var c={milliseconds:0,months:0};c.months=b.month()-a.month()+12*(b.year()-a.year());a.clone().add(c.months,"M").isAfter(b)&&--c.months;c.milliseconds=+b-+a.clone().add(c.months,
"M");return c}function Qa(a,b){return function(c,d){var e;null===d||isNaN(+d)||(Bb[b]||(J("moment()."+b+"(period, number) is deprecated. Please use moment()."+b+"(number, period)."),Bb[b]=!0),e=c,c=d,d=e);e=la("string"===typeof c?+c:c,d);mb(this,e,a);return this}}function mb(b,c,d,e){var f=c._milliseconds,g=c._days;c=c._months;e=null==e?!0:e;f&&b._d.setTime(+b._d+f*d);g&&(f=O(b,"Date")+g*d,b._d["set"+(b._isUTC?"UTC":"")+"Date"](f));c&&Y(b,O(b,"Month")+c*d);e&&a.updateOffset(b,g||c)}function ma(a){return 0>
a?Math.ceil(a):Math.floor(a)}function Da(){var a=this.clone().utc();return 0<a.year()&&9999>=a.year()?"function"===typeof Date.prototype.toISOString?this.toDate().toISOString():L(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):L(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function cb(a){if(void 0===a)return this._locale._abbr;a=B(a);null!=a&&(this._locale=a);return this}function Ra(){return this._locale}function Ba(a,b){x(0,[a,a.length],0,b)}function Sa(a,b,c){return ja(T([a,11,31+b-c]),b,c).week}function Ta(a,b){x(a,
0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),b)})}function db(a,b){return b._meridiemParse}function C(a){return a}function nb(a,b,c,d){var e=B();b=p().set(d,b);return e[c](b,a)}function V(a,b,c,d,e){"number"===typeof a&&(b=a,a=void 0);a=a||"";if(null!=b)return nb(a,b,c,e);var f=[];for(b=0;b<d;b++)f[b]=nb(a,b,c,e);return f}function ob(a,b,c,d){b=la(b,c);a._milliseconds+=d*b._milliseconds;a._days+=d*b._days;a._months+=d*b._months;return a._bubble()}function na(a){return function(){return this.as(a)}}
function ta(a){return function(){return this._data[a]}}function yb(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function Ua(){var a=Va(this.years()),b=Va(this.months()),c=Va(this.days()),d=Va(this.hours()),e=Va(this.minutes()),f=Va(this.seconds()+this.milliseconds()/1E3),g=this.asSeconds();return g?(0>g?"-":"")+"P"+(a?a+"Y":"")+(b?b+"M":"")+(c?c+"D":"")+(d||e||f?"T":"")+(d?d+"H":"")+(e?e+"M":"")+(f?f+"S":""):"P0D"}var hb,$a=a.momentProperties=[],ab=!1,wa={},Pa,Ha={},ib=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,
Ia=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,bb={},xa={},Wa=/\d/,qa=/\d\d/,pb=/\d{3}/,zb=/\d{4}/,qb=/[+-]?\d{6}/,aa=/\d\d?/,rb=/\d{1,3}/,Ab=/\d{1,4}/,sb=/[+-]?\d{1,6}/,tb=/[+-]?\d+/,jb=/Z|[+-]\d\d:?\d\d/gi,eb=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,ub={},vb={},za=0,ya=1,ua=2,ka=3,Ja=4,Ka=5,La=6;x("M",["MM",2],"Mo",function(){return this.month()+1});x("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)});x("MMMM",
0,0,function(a){return this.localeData().months(this,a)});z("month","M");E("M",aa);E("MM",aa,qa);E("MMM",eb);E("MMMM",eb);R(["M","MM"],function(a,b){b[ya]=n(a)-1});R(["MMM","MMMM"],function(a,b,c,d){d=c._locale.monthsParse(a,d,c._strict);null!=d?b[ya]=d:c._pf.invalidMonth=a});var Bb={};a.suppressDeprecationWarnings=!1;var Fb=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,wb=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],
["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],xb=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Gb=/^\/?Date\((\-?\d+)/i;a.createFromInputFallback=ba("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",
function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))});x(0,["YY",2],0,function(){return this.year()%100});x(0,["YYYY",4],0,"year");x(0,["YYYYY",5],0,"year");x(0,["YYYYYY",6,!0],0,"year");z("year","y");E("Y",tb);E("YY",aa,qa);E("YYYY",Ab,zb);E("YYYYY",sb,qb);E("YYYYYY",sb,qb);R(["YYYY","YYYYY","YYYYYY"],za);R("YY",function(b,c){c[za]=a.parseTwoDigitYear(b)});a.parseTwoDigitYear=function(a){return n(a)+(68<n(a)?1900:2E3)};var Cb=M("FullYear",!1);x("w",["ww",2],"wo","week");x("W",["WW",2],"Wo","isoWeek");
z("week","w");z("isoWeek","W");E("w",aa);E("ww",aa,qa);E("W",aa);E("WW",aa,qa);K(["w","ww","W","WW"],function(a,b,c,d){b[d.substr(0,1)]=n(a)});x("DDD",["DDDD",3],"DDDo","dayOfYear");z("dayOfYear","DDD");E("DDD",rb);E("DDDD",pb);R(["DDD","DDDD"],function(a,b,c){c._dayOfYear=n(a)});a.ISO_8601=function(){};var Kb=ba("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var a=T.apply(null,arguments);return a<this?this:a}),Lb=ba("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",
function(){var a=T.apply(null,arguments);return a>this?this:a});Ya("Z",":");Ya("ZZ","");E("Z",jb);E("ZZ",jb);R(["Z","ZZ"],function(a,b,c){c._useUTC=!0;c._tzm=Za(a)});var Hb=/([\+\-]|\d\d)/gi;a.updateOffset=function(){};var Ib=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Jb=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;la.fn=Ga.prototype;var Mb=Qa(1,"add"),Nb=Qa(-1,"subtract");a.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";
var Db=ba("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)});x(0,["gg",2],0,function(){return this.weekYear()%100});x(0,["GG",2],0,function(){return this.isoWeekYear()%100});Ba("gggg","weekYear");Ba("ggggg","weekYear");Ba("GGGG","isoWeekYear");Ba("GGGGG","isoWeekYear");z("weekYear","gg");z("isoWeekYear","GG");E("G",tb);E("g",tb);E("GG",aa,
qa);E("gg",aa,qa);E("GGGG",Ab,zb);E("gggg",Ab,zb);E("GGGGG",sb,qb);E("ggggg",sb,qb);K(["gggg","ggggg","GGGG","GGGGG"],function(a,b,c,d){b[d.substr(0,2)]=n(a)});K(["gg","GG"],function(b,c,d,e){c[e]=a.parseTwoDigitYear(b)});x("Q",0,0,"quarter");z("quarter","Q");E("Q",Wa);R("Q",function(a,b){b[ya]=3*(n(a)-1)});x("D",["DD",2],"Do","date");z("date","D");E("D",aa);E("DD",aa,qa);E("Do",function(a,b){return a?b._ordinalParse:b._ordinalParseLenient});R(["D","DD"],ua);R("Do",function(a,b){b[ua]=n(a.match(aa)[0],
10)});var Eb=M("Date",!0);x("d",0,"do","day");x("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)});x("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)});x("dddd",0,0,function(a){return this.localeData().weekdays(this,a)});x("e",0,0,"weekday");x("E",0,0,"isoWeekday");z("day","d");z("weekday","e");z("isoWeekday","E");E("d",aa);E("e",aa);E("E",aa);E("dd",eb);E("ddd",eb);E("dddd",eb);K(["dd","ddd","dddd"],function(a,b,c){var d=c._locale.weekdaysParse(a);null!=d?b.d=
d:c._pf.invalidWeekday=a});K(["d","e","E"],function(a,b,c,d){b[d]=n(a)});x("H",["HH",2],0,"hour");x("h",["hh",2],0,function(){return this.hours()%12||12});Ta("a",!0);Ta("A",!1);z("hour","h");E("a",db);E("A",db);E("H",aa);E("h",aa);E("HH",aa,qa);E("hh",aa,qa);R(["H","HH"],ka);R(["a","A"],function(a,b,c){c._isPm=c._locale.isPM(a);c._meridiem=a});R(["h","hh"],function(a,b,c){b[ka]=n(a);c._pf.bigHour=!0});var Ob=M("Hours",!0);x("m",["mm",2],0,"minute");z("minute","m");E("m",aa);E("mm",aa,qa);R(["m","mm"],
Ja);var Pb=M("Minutes",!1);x("s",["ss",2],0,"second");z("second","s");E("s",aa);E("ss",aa,qa);R(["s","ss"],Ka);var Qb=M("Seconds",!1);x("S",0,0,function(){return~~(this.millisecond()/100)});x(0,["SS",2],0,function(){return~~(this.millisecond()/10)});x(0,["SSS",3],0,"millisecond");x(0,["SSSS",3],0,"millisecond");z("millisecond","ms");E("S",rb,Wa);E("SS",rb,qa);E("SSS",rb,pb);E("SSSS",/\d+/);R(["S","SS","SSS","SSSS"],function(a,b){b[La]=n(1E3*("0."+a))});var Rb=M("Milliseconds",!1);x("z",0,0,"zoneAbbr");
x("zz",0,0,"zoneName");var G=v.prototype;G.add=Mb;G.calendar=function(a){a=a||T();var b=pa(a,this).startOf("day"),b=this.diff(b,"days",!0),b=-6>b?"sameElse":-1>b?"lastWeek":0>b?"lastDay":1>b?"sameDay":2>b?"nextDay":7>b?"nextWeek":"sameElse";return this.format(this.localeData().calendar(b,this,T(a)))};G.clone=function(){return new v(this)};G.diff=function(a,b,c){a=pa(a,this);var d=6E4*(a.utcOffset()-this.utcOffset());b=A(b);if("year"===b||"month"===b||"quarter"===b){var d=12*(a.year()-this.year())+
(a.month()-this.month()),e=this.clone().add(d,"months"),f;0>a-e?(f=this.clone().add(d-1,"months"),a=(a-e)/(e-f)):(f=this.clone().add(d+1,"months"),a=(a-e)/(f-e));a=-(d+a);"quarter"===b?a/=3:"year"===b&&(a/=12)}else a=this-a,a="second"===b?a/1E3:"minute"===b?a/6E4:"hour"===b?a/36E5:"day"===b?(a-d)/864E5:"week"===b?(a-d)/6048E5:a;return c?a:ma(a)};G.endOf=function(a){a=A(a);return void 0===a||"millisecond"===a?this:this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,"ms")};G.format=function(b){b=
L(this,b||a.defaultFormat);return this.localeData().postformat(b)};G.from=function(a,b){return la({to:this,from:a}).locale(this.locale()).humanize(!b)};G.fromNow=function(a){return this.from(T(),a)};G.get=U;G.invalidAt=function(){return this._pf.overflow};G.isAfter=function(a,b){b=A("undefined"!==typeof b?b:"millisecond");return"millisecond"===b?(a=f(a)?a:T(a),+this>+a):(f(a)?+a:+T(a))<+this.clone().startOf(b)};G.isBefore=function(a,b){var c;b=A("undefined"!==typeof b?b:"millisecond");if("millisecond"===
b)return a=f(a)?a:T(a),+this<+a;c=f(a)?+a:+T(a);return+this.clone().endOf(b)<c};G.isBetween=function(a,b,c){return this.isAfter(a,c)&&this.isBefore(b,c)};G.isSame=function(a,b){var c;b=A(b||"millisecond");if("millisecond"===b)return a=f(a)?a:T(a),+this===+a;c=+T(a);return+this.clone().startOf(b)<=c&&c<=+this.clone().endOf(b)};G.isValid=function(){return l(this)};G.lang=Db;G.locale=cb;G.localeData=Ra;G.max=Lb;G.min=Kb;G.parsingFlags=function(){return b({},this._pf)};G.set=U;G.startOf=function(a){a=
A(a);switch(a){case "year":this.month(0);case "quarter":case "month":this.date(1);case "week":case "isoWeek":case "day":this.hours(0);case "hour":this.minutes(0);case "minute":this.seconds(0);case "second":this.milliseconds(0)}"week"===a&&this.weekday(0);"isoWeek"===a&&this.isoWeekday(1);"quarter"===a&&this.month(3*Math.floor(this.month()/3));return this};G.subtract=Nb;G.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]};G.toDate=
function(){return this._offset?new Date(+this):this._d};G.toISOString=Da;G.toJSON=Da;G.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")};G.unix=function(){return Math.floor(+this/1E3)};G.valueOf=function(){return+this._d-6E4*(this._offset||0)};G.year=Cb;G.isLeapYear=function(){return ia(this.year())};G.weekYear=function(a){var b=ja(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==a?b:this.add(a-b,"y")};G.isoWeekYear=function(a){var b=
ja(this,1,4).year;return null==a?b:this.add(a-b,"y")};G.quarter=G.quarters=function(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)};G.month=fa;G.daysInMonth=function(){return ea(this.year(),this.month())};G.week=G.weeks=function(a){var b=this.localeData().week(this);return null==a?b:this.add(7*(a-b),"d")};G.isoWeek=G.isoWeeks=function(a){var b=ja(this,1,4).week;return null==a?b:this.add(7*(a-b),"d")};G.weeksInYear=function(){var a=this.localeData()._week;return Sa(this.year(),
a.dow,a.doy)};G.isoWeeksInYear=function(){return Sa(this.year(),1,4)};G.date=Eb;G.day=G.days=function(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();if(null!=a){a:{var c=this.localeData();if("string"===typeof a)if(isNaN(a)){if(a=c.weekdaysParse(a),"number"!==typeof a){a=null;break a}}else a=parseInt(a,10)}return this.add(a-b,"d")}return b};G.weekday=function(a){var b=(this.day()+7-this.localeData()._week.dow)%7;return null==a?b:this.add(a-b,"d")};G.isoWeekday=function(a){return null==a?
this.day()||7:this.day(this.day()%7?a:a-7)};G.dayOfYear=function(a){var b=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864E5)+1;return null==a?b:this.add(a-b,"d")};G.hour=G.hours=Ob;G.minute=G.minutes=Pb;G.second=G.seconds=Qb;G.millisecond=G.milliseconds=Rb;G.utcOffset=function(b,c){var d=this._offset||0,e;return null!=b?("string"===typeof b&&(b=Za(b)),16>Math.abs(b)&&(b*=60),!this._isUTC&&c&&(e=15*-Math.round(this._d.getTimezoneOffset()/15)),this._offset=b,this._isUTC=!0,
null!=e&&this.add(e,"m"),d!==b&&(!c||this._changeInProgress?mb(this,la(b-d,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,a.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?d:15*-Math.round(this._d.getTimezoneOffset()/15)};G.utc=function(a){return this.utcOffset(0,a)};G.local=function(a){this._isUTC&&(this.utcOffset(0,a),this._isUTC=!1,a&&this.subtract(15*-Math.round(this._d.getTimezoneOffset()/15),"m"));return this};G.parseZone=function(){this._tzm?this.utcOffset(this._tzm):
"string"===typeof this._i&&this.utcOffset(Za(this._i));return this};G.hasAlignedHourOffset=function(a){a=a?T(a).utcOffset():0;return 0===(this.utcOffset()-a)%60};G.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()};G.isDSTShifted=function(){if(this._a){var a=this._isUTC?p(this._a):T(this._a);return this.isValid()&&0<w(this._a,a.toArray())}return!1};G.isLocal=function(){return!this._isUTC};G.isUtcOffset=function(){return this._isUTC};
G.isUtc=kb;G.isUTC=kb;G.zoneAbbr=function(){return this._isUTC?"UTC":""};G.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""};G.dates=ba("dates accessor is deprecated. Use date instead.",Eb);G.months=ba("months accessor is deprecated. Use month instead",fa);G.years=ba("years accessor is deprecated. Use year instead",Cb);G.zone=ba("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",function(a,b){return null!=a?("string"!==
typeof a&&(a=-a),this.utcOffset(a,b),this):-this.utcOffset()});var P=r.prototype;P._calendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};P.calendar=function(a,b,c){a=this._calendar[a];return"function"===typeof a?a.call(b,c):a};P._longDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"};P.longDateFormat=function(a){var b=this._longDateFormat[a];
!b&&this._longDateFormat[a.toUpperCase()]&&(b=this._longDateFormat[a.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a]=b);return b};P._invalidDate="Invalid date";P.invalidDate=function(){return this._invalidDate};P._ordinal="%d";P.ordinal=function(a){return this._ordinal.replace("%d",a)};P._ordinalParse=/\d{1,2}/;P.preparse=C;P.postformat=C;P._relativeTime={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",
d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};P.relativeTime=function(a,b,c,d){var e=this._relativeTime[c];return"function"===typeof e?e(a,b,c,d):e.replace(/%d/i,a)};P.pastFuture=function(a,b){var c=this._relativeTime[0<a?"future":"past"];return"function"===typeof c?c(b):c.replace(/%s/i,b)};P.set=function(a){var b,c;for(c in a)b=a[c],"function"===typeof b?this[c]=b:this["_"+c]=b;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)};P.months=
function(a){return this._months[a.month()]};P._months="January February March April May June July August September October November December".split(" ");P.monthsShort=function(a){return this._monthsShort[a.month()]};P._monthsShort="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");P.monthsParse=function(a,b,c){var d,e;this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]);for(d=0;12>d;d++)if(e=p([2E3,d]),c&&!this._longMonthsParse[d]&&(this._longMonthsParse[d]=
new RegExp("^"+this.months(e,"").replace(".","")+"$","i"),this._shortMonthsParse[d]=new RegExp("^"+this.monthsShort(e,"").replace(".","")+"$","i")),c||this._monthsParse[d]||(e="^"+this.months(e,"")+"|^"+this.monthsShort(e,""),this._monthsParse[d]=new RegExp(e.replace(".",""),"i")),c&&"MMMM"===b&&this._longMonthsParse[d].test(a)||c&&"MMM"===b&&this._shortMonthsParse[d].test(a)||!c&&this._monthsParse[d].test(a))return d};P.week=function(a){return ja(a,this._week.dow,this._week.doy).week};P._week={dow:0,
doy:6};P.firstDayOfYear=function(){return this._week.doy};P.firstDayOfWeek=function(){return this._week.dow};P.weekdays=function(a){return this._weekdays[a.day()]};P._weekdays="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ");P.weekdaysMin=function(a){return this._weekdaysMin[a.day()]};P._weekdaysMin="Su Mo Tu We Th Fr Sa".split(" ");P.weekdaysShort=function(a){return this._weekdaysShort[a.day()]};P._weekdaysShort="Sun Mon Tue Wed Thu Fri Sat".split(" ");P.weekdaysParse=function(a){var b,
c;this._weekdaysParse||(this._weekdaysParse=[]);for(b=0;7>b;b++)if(this._weekdaysParse[b]||(c=T([2E3,1]).day(b),c="^"+this.weekdays(c,"")+"|^"+this.weekdaysShort(c,"")+"|^"+this.weekdaysMin(c,""),this._weekdaysParse[b]=new RegExp(c.replace(".",""),"i")),this._weekdaysParse[b].test(a))return b};P.isPM=function(a){return"p"===(a+"").toLowerCase().charAt(0)};P._meridiemParse=/[ap]\.?m?\.?/i;P.meridiem=function(a,b,c){return 11<a?c?"pm":"PM":c?"am":"AM"};y("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var b=
a%10,b=1===n(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+b}});a.lang=ba("moment.lang is deprecated. Use moment.locale instead.",y);a.langData=ba("moment.langData is deprecated. Use moment.localeData instead.",B);var Ca=Math.abs,Sb=na("ms"),Tb=na("s"),Ub=na("m"),Vb=na("h"),Wb=na("d"),Xb=na("w"),Yb=na("M"),Zb=na("y"),$b=ta("milliseconds"),ac=ta("seconds"),bc=ta("minutes"),cc=ta("hours"),dc=ta("days"),ec=ta("months"),fc=ta("years"),Xa=Math.round,Ea={s:45,m:45,h:22,d:26,M:11},Va=Math.abs,
Q=Ga.prototype;Q.abs=function(){var a=this._data;this._milliseconds=Ca(this._milliseconds);this._days=Ca(this._days);this._months=Ca(this._months);a.milliseconds=Ca(a.milliseconds);a.seconds=Ca(a.seconds);a.minutes=Ca(a.minutes);a.hours=Ca(a.hours);a.months=Ca(a.months);a.years=Ca(a.years);return this};Q.add=function(a,b){return ob(this,a,b,1)};Q.subtract=function(a,b){return ob(this,a,b,-1)};Q.as=function(a){var b,c=this._milliseconds;a=A(a);if("month"===a||"year"===a)return b=this._days+c/864E5,
b=this._months+400*b/146097*12,"month"===a?b:b/12;b=this._days+Math.round(this._months/12*146097/400);switch(a){case "week":return b/7+c/6048E5;case "day":return b+c/864E5;case "hour":return 24*b+c/36E5;case "minute":return 1440*b+c/6E4;case "second":return 86400*b+c/1E3;case "millisecond":return Math.floor(864E5*b)+c;default:throw Error("Unknown unit "+a);}};Q.asMilliseconds=Sb;Q.asSeconds=Tb;Q.asMinutes=Ub;Q.asHours=Vb;Q.asDays=Wb;Q.asWeeks=Xb;Q.asMonths=Yb;Q.asYears=Zb;Q.valueOf=function(){return this._milliseconds+
864E5*this._days+this._months%12*2592E6+31536E6*n(this._months/12)};Q._bubble=function(){var a=this._milliseconds,b=this._days,c=this._months,d=this._data,e=0;d.milliseconds=a%1E3;a=ma(a/1E3);d.seconds=a%60;a=ma(a/60);d.minutes=a%60;a=ma(a/60);d.hours=a%24;b+=ma(a/24);e=ma(400*b/146097);b-=ma(146097*e/400);c+=ma(b/30);b%=30;e+=ma(c/12);d.days=b;d.months=c%12;d.years=e;return this};Q.get=function(a){a=A(a);return this[a+"s"]()};Q.milliseconds=$b;Q.seconds=ac;Q.minutes=bc;Q.hours=cc;Q.days=dc;Q.weeks=
function(){return ma(this.days()/7)};Q.months=ec;Q.years=fc;Q.humanize=function(a){var b=this.localeData(),c;c=!a;var d=la(this).abs(),e=Xa(d.as("s")),f=Xa(d.as("m")),g=Xa(d.as("h")),k=Xa(d.as("d")),n=Xa(d.as("M")),d=Xa(d.as("y")),e=e<Ea.s&&["s",e]||1===f&&["m"]||f<Ea.m&&["mm",f]||1===g&&["h"]||g<Ea.h&&["hh",g]||1===k&&["d"]||k<Ea.d&&["dd",k]||1===n&&["M"]||n<Ea.M&&["MM",n]||1===d&&["y"]||["yy",d];e[2]=c;e[3]=0<+this;e[4]=b;c=yb.apply(null,e);a&&(c=b.pastFuture(+this,c));return b.postformat(c)};Q.toISOString=
Ua;Q.toString=Ua;Q.toJSON=Ua;Q.locale=cb;Q.localeData=Ra;Q.toIsoString=ba("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Ua);Q.lang=Db;x("X",0,0,"unix");x("x",0,0,"valueOf");E("x",tb);E("X",/[+-]?\d+(\.\d{1,3})?/);R("X",function(a,b,c){c._d=new Date(1E3*parseFloat(a,10))});R("x",function(a,b,c){c._d=new Date(n(a))});a.version="2.10.2";hb=T;a.fn=G;a.min=function(){var a=[].slice.call(arguments,0);return gb("isBefore",a)};a.max=function(){var a=[].slice.call(arguments,
0);return gb("isAfter",a)};a.utc=p;a.unix=function(a){return T(1E3*a)};a.months=function(a,b){return V(a,b,"months",12,"month")};a.isDate=k;a.locale=y;a.invalid=g;a.duration=la;a.isMoment=f;a.weekdays=function(a,b){return V(a,b,"weekdays",7,"day")};a.parseZone=function(){return T.apply(null,arguments).parseZone()};a.localeData=B;a.isDuration=Oa;a.monthsShort=function(a,b){return V(a,b,"monthsShort",12,"month")};a.weekdaysMin=function(a,b){return V(a,b,"weekdaysMin",7,"day")};a.defineLocale=F;a.weekdaysShort=
function(a,b){return V(a,b,"weekdaysShort",7,"day")};a.normalizeUnits=A;a.relativeTimeThreshold=function(a,b){if(void 0===Ea[a])return!1;if(void 0===b)return Ea[a];Ea[a]=b;return!0};return a})},{}],numeral:[function(h,q,r){(function(){function a(a){this._value=a}function e(a,b,c,d){var e=Math.pow(10,b);a=(c(a*e)/e).toFixed(b);d&&(d=new RegExp("0{1,"+d+"}$"),a=a.replace(d,""));return a}function d(a,c,d){var g=!1,k=!1,h=!1,m="",q=!1,t=!1,r=!1,z=!1,A=!1,H="",M="",O=Math.abs(a),U="B KB MB GB TB PB EB ZB YB".split(" "),
D="",x=!1;if(0===a&&null!==l)return l;-1<c.indexOf("(")?(g=!0,c=c.slice(1,-1)):-1<c.indexOf("+")&&(k=!0,c=c.replace(/\+/g,""));if(-1<c.indexOf("a"))if(q=0<=c.indexOf("aK"),t=0<=c.indexOf("aM"),r=0<=c.indexOf("aB"),z=0<=c.indexOf("aT"),A=q||t||r||z,-1<c.indexOf(" a")?(m=" ",c=c.replace(" a","")):c=c.replace("a",""),O>=Math.pow(10,12)&&!A||z)m+=b[p].abbreviations.trillion,a/=Math.pow(10,12);else if(O<Math.pow(10,12)&&O>=Math.pow(10,9)&&!A||r)m+=b[p].abbreviations.billion,a/=Math.pow(10,9);else if(O<
Math.pow(10,9)&&O>=Math.pow(10,6)&&!A||t)m+=b[p].abbreviations.million,a/=Math.pow(10,6);else if(O<Math.pow(10,6)&&O>=Math.pow(10,3)&&!A||q)m+=b[p].abbreviations.thousand,a/=Math.pow(10,3);if(-1<c.indexOf("b"))for(-1<c.indexOf(" b")?(H=" ",c=c.replace(" b","")):c=c.replace("b",""),r=0;r<=U.length;r++)if(q=Math.pow(1024,r),t=Math.pow(1024,r+1),a>=q&&a<t){H+=U[r];0<q&&(a/=q);break}-1<c.indexOf("o")&&(-1<c.indexOf(" o")?(M=" ",c=c.replace(" o","")):c=c.replace("o",""),M+=b[p].ordinal(a));-1<c.indexOf("[.]")&&
(h=!0,c=c.replace("[.]","."));a.toString().split(".");q=c.split(".")[1];U=c.indexOf(",");q?(-1<q.indexOf("[")?(q=q.replace("]",""),q=q.split("["),D=e(a,q[0].length+q[1].length,d,q[1].length)):D=e(a,q.length,d),a=D.split(".")[0],D=D.split(".")[1].length?b[p].delimiters.decimal+D.split(".")[1]:"",h&&0===Number(D.slice(1))&&(D="")):a=e(a,null,d);-1<a.indexOf("-")&&(a=a.slice(1),x=!0);-1<U&&(a=a.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+b[p].delimiters.thousands));0===c.indexOf(".")&&(a="");return(g&&
x?"(":"")+(!g&&x?"-":"")+(!x&&k?"+":"")+a+D+(M?M:"")+(m?m:"")+(H?H:"")+(g&&x?")":"")}function k(a){a=a.toString().split(".");return 2>a.length?1:Math.pow(10,a[1].length)}function h(){return Array.prototype.slice.call(arguments).reduce(function(a,b){var c=k(a),d=k(b);return c>d?c:d},-Infinity)}var c,b={},p="en",l=null,g="0,0",t="undefined"!==typeof q&&q.exports;c=function(b){c.isNumeral(b)?b=b.value():0===b||"undefined"===typeof b?b=0:Number(b)||(b=c.fn.unformat(b));return new a(Number(b))};c.version=
"1.5.3";c.isNumeral=function(b){return b instanceof a};c.language=function(a,d){if(!a)return p;if(a&&!d){if(!b[a])throw Error("Unknown language : "+a);p=a}if(d||!b[a])b[a]=d;return c};c.languageData=function(a){if(!a)return b[p];if(!b[a])throw Error("Unknown language : "+a);return b[a]};c.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":
"th"},currency:{symbol:"$"}});c.zeroFormat=function(a){l="string"===typeof a?a:null};c.defaultFormat=function(a){g="string"===typeof a?a:"0.0"};c.validate=function(a,b){var d,e,g,k,h;"string"!==typeof a&&(a+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",a));a=a.trim();if(""===a)return!1;a=a.replace(/^[+-]?/,"");try{e=c.languageData(b)}catch(l){e=c.languageData(c.language())}g=e.currency.symbol;k=e.abbreviations;d=e.delimiters.decimal;e="."===e.delimiters.thousands?
"\\.":e.delimiters.thousands;h=a.match(/^[^\d]+/);if(null!==h&&(a=a.substr(1),h[0]!==g))return!1;h=a.match(/[^\d]+$/);if(null!==h&&(a=a.slice(0,-1),h[0]!==k.thousand&&h[0]!==k.million&&h[0]!==k.billion&&h[0]!==k.trillion))return!1;if(a.match(/^\d+$/))return!0;g=new RegExp(e+"{2}");return a.match(/[^\d.,]/g)||(d=a.split(d),2<d.length)?!1:2>d.length?!!d[0].match(/^\d+.*\d$/)&&!d[0].match(g):1===d[0].length?!!d[0].match(/^\d+$/)&&!d[0].match(g)&&!!d[1].match(/^\d+$/):!!d[0].match(/^\d+.*\d$/)&&!d[0].match(g)&&
!!d[1].match(/^\d+$/)};"function"!==typeof Array.prototype.reduce&&(Array.prototype.reduce=function(a,b){if(null===this||"undefined"===typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!==typeof a)throw new TypeError(a+" is not a function");var c,d,e=this.length>>>0,g=!1;1<arguments.length&&(d=b,g=!0);for(c=0;e>c;++c)this.hasOwnProperty(c)&&(g?d=a(d,this[c],c,this):(d=this[c],g=!0));if(!g)throw new TypeError("Reduce of empty array with no initial value");
return d});c.fn=a.prototype={clone:function(){return c(this)},format:function(a,c){var e=a?a:g,k=void 0!==c?c:Math.round;if(-1<e.indexOf("$")){var h=e,e=h.indexOf("$"),l=h.indexOf("("),m=h.indexOf("-"),q="";-1<h.indexOf(" $")?(q=" ",h=h.replace(" $","")):-1<h.indexOf("$ ")?(q=" ",h=h.replace("$ ","")):h=h.replace("$","");h=d(this._value,h,k);if(1>=e)if(-1<h.indexOf("(")||-1<h.indexOf("-")){h=h.split("");k=1;if(e<l||e<m)k=0;h.splice(k,0,b[p].currency.symbol+q);h=h.join("")}else h=b[p].currency.symbol+
q+h;else-1<h.indexOf(")")?(h=h.split(""),h.splice(-1,0,q+b[p].currency.symbol),h=h.join("")):h=h+q+b[p].currency.symbol;k=h}else-1<e.indexOf("%")?(l=e,e="",m=100*this._value,-1<l.indexOf(" %")?(e=" ",l=l.replace(" %","")):l=l.replace("%",""),k=d(m,l,k),-1<k.indexOf(")")?(k=k.split(""),k.splice(-1,0,e+"%"),k=k.join("")):k=k+e+"%"):-1<e.indexOf(":")?(k=Math.floor(this._value/60/60),e=Math.floor((this._value-3600*k)/60),l=Math.round(this._value-3600*k-60*e),k=k+":"+(10>e?"0"+e:e)+":"+(10>l?"0"+l:l)):
k=d(this._value,e,k);return k},unformat:function(a){if("[object Number]"===Object.prototype.toString.call(a))return a;var c=a=a?a:g,d,e,k,h,m="KB MB GB TB PB EB ZB YB".split(" "),q=!1,t;if(-1<a.indexOf(":"))a=a.split(":"),c=0,3===a.length?(c+=3600*Number(a[0]),c+=60*Number(a[1]),c+=Number(a[2])):2===a.length&&(c+=60*Number(a[0]),c+=Number(a[1])),this._value=Number(c);else if(a===l)this._value=0;else{"."!==b[p].delimiters.decimal&&(a=a.replace(/\./g,"").replace(b[p].delimiters.decimal,"."));d=new RegExp("[^a-zA-Z]"+
b[p].abbreviations.thousand+"(?:\\)|(\\"+b[p].currency.symbol+")?(?:\\))?)?$");e=new RegExp("[^a-zA-Z]"+b[p].abbreviations.million+"(?:\\)|(\\"+b[p].currency.symbol+")?(?:\\))?)?$");k=new RegExp("[^a-zA-Z]"+b[p].abbreviations.billion+"(?:\\)|(\\"+b[p].currency.symbol+")?(?:\\))?)?$");h=new RegExp("[^a-zA-Z]"+b[p].abbreviations.trillion+"(?:\\)|(\\"+b[p].currency.symbol+")?(?:\\))?)?$");for(t=0;t<=m.length&&!(q=-1<a.indexOf(m[t])?Math.pow(1024,t+1):!1);t++);this._value=(q?q:1)*(c.match(d)?Math.pow(10,
3):1)*(c.match(e)?Math.pow(10,6):1)*(c.match(k)?Math.pow(10,9):1)*(c.match(h)?Math.pow(10,12):1)*(-1<a.indexOf("%")?.01:1)*((a.split("-").length+Math.min(a.split("(").length-1,a.split(")").length-1))%2?1:-1)*Number(a.replace(/[^0-9\.]+/g,""));this._value=q?Math.ceil(this._value):this._value}return this._value},value:function(){return this._value},valueOf:function(){return this._value},set:function(a){this._value=Number(a);return this},add:function(a){var b=h.call(null,this._value,a);this._value=[this._value,
a].reduce(function(a,c,d,e){return a+b*c},0)/b;return this},subtract:function(a){var b=h.call(null,this._value,a);this._value=[a].reduce(function(a,c,d,e){return a-b*c},this._value*b)/b;return this},multiply:function(a){this._value=[this._value,a].reduce(function(a,b,c,d){c=h(a,b);return a*c*b*c/(c*c)},1);return this},divide:function(a){this._value=[this._value,a].reduce(function(a,b,c,d){c=h(a,b);return a*c/(b*c)});return this},difference:function(a){return Math.abs(c(this._value).subtract(a).value())}};
t&&(q.exports=c);"undefined"===typeof ender&&(this.numeral=c);"function"===typeof define&&define.amd&&define([],function(){return c})}).call(window)},{}],pikaday:[function(h,q,r){(function(a,e){var d;if("object"===typeof r){try{d=h("moment")}catch(k){}q.exports=e(d)}else"function"===typeof define&&define.amd?define(function(a){try{d=a("moment")}catch(c){}return e(d)}):a.Pikaday=e(a.moment)})(this,function(a){var e="function"===typeof a,d=!!window.addEventListener,k=window.document,h=window.setTimeout,
c=function(a,b,c,e){d?a.addEventListener(b,c,!!e):a.attachEvent("on"+b,c)},b=function(a,b,c,e){d?a.removeEventListener(b,c,!!e):a.detachEvent("on"+b,c)},p=function(a,b,c){var d;k.createEvent?(d=k.createEvent("HTMLEvents"),d.initEvent(b,!0,!1),d=f(d,c),a.dispatchEvent(d)):k.createEventObject&&(d=k.createEventObject(),d=f(d,c),a.fireEvent("on"+b,d))},l=function(a,b){return-1!==(" "+a.className+" ").indexOf(" "+b+" ")},g=function(a){return/Array/.test(Object.prototype.toString.call(a))},q=function(a){return/Date/.test(Object.prototype.toString.call(a))&&
!isNaN(a.getTime())},r=function(a){q(a)&&a.setHours(0,0,0,0)},f=function(a,b,c){var d,e;for(d in b)if((e=void 0!==a[d])&&"object"===typeof b[d]&&null!==b[d]&&void 0===b[d].nodeName)q(b[d])?c&&(a[d]=new Date(b[d].getTime())):g(b[d])?c&&(a[d]=b[d].slice(0)):a[d]=f({},b[d],c);else if(c||!e)a[d]=b[d];return a},n=function(a){0>a.month&&(a.year-=Math.ceil(Math.abs(a.month)/12),a.month+=12);11<a.month&&(a.year+=Math.floor(Math.abs(a.month)/12),a.month-=12);return a},w={field:null,bound:void 0,position:"bottom left",
reposition:!0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:"January February March April May June July August September October November December".split(" "),weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" ")},onSelect:null,onOpen:null,onClose:null,onDraw:null},I=function(a,b,c){for(b+=a.firstDay;7<=b;)b-=7;return c?a.i18n.weekdaysShort[b]:a.i18n.weekdays[b]},N=function(a,b,c,d,e,f,g){if(g)return'<td class="is-empty"></td>';g=[];f&&g.push("is-disabled");e&&g.push("is-today");d&&g.push("is-selected");return'<td data-day="'+a+'" class="'+g.join(" ")+'"><button class="pika-button pika-day" type="button" data-pika-year="'+c+'" data-pika-month="'+b+'" data-pika-day="'+
a+'">'+a+"</button></td>"},W=function(a,b,c){var d=new Date(c,0,1);return'<td class="pika-week">'+Math.ceil(((new Date(c,b,a)-d)/864E5+d.getDay()+1)/7)+"</td>"},y=function(a,b){return"<tr>"+(b?a.reverse():a).join("")+"</tr>"},F=function(a,b,c,d,e){var f,k,h,l=a._o,m=c===l.minYear,n=c===l.maxYear,p='<div class="pika-title">',q=!0,r=!0;h=[];for(f=0;12>f;f++)h.push('<option value="'+(c===e?f-b:12+f-b)+'"'+(f===d?" selected":"")+(m&&f<l.minMonth||n&&f>l.maxMonth?"disabled":"")+">"+l.i18n.months[f]+"</option>");
e='<div class="pika-label">'+l.i18n.months[d]+'<select class="pika-select pika-select-month">'+h.join("")+"</select></div>";g(l.yearRange)?(f=l.yearRange[0],k=l.yearRange[1]+1):(f=c-l.yearRange,k=1+c+l.yearRange);for(h=[];f<k&&f<=l.maxYear;f++)f>=l.minYear&&h.push('<option value="'+f+'"'+(f===c?" selected":"")+">"+f+"</option>");c='<div class="pika-label">'+c+l.yearSuffix+'<select class="pika-select pika-select-year">'+h.join("")+"</select></div>";p=l.showMonthAfterYear?p+(c+e):p+(e+c);m&&(0===d||
l.minMonth>=d)&&(q=!1);n&&(11===d||l.maxMonth<=d)&&(r=!1);0===b&&(p+='<button class="pika-prev'+(q?"":" is-disabled")+'" type="button">'+l.i18n.previousMonth+"</button>");b===a._o.numberOfMonths-1&&(p+='<button class="pika-next'+(r?"":" is-disabled")+'" type="button">'+l.i18n.nextMonth+"</button>");return p+"</div>"},B=function(b){var f=this,g=f.config(b);f._onMouseDown=function(a){if(f._v){a=a||window.event;var b=a.target||a.srcElement;if(b){if(!l(b,"is-disabled")){if(l(b,"pika-button")&&!l(b,"is-empty")){f.setDate(new Date(b.getAttribute("data-pika-year"),
b.getAttribute("data-pika-month"),b.getAttribute("data-pika-day")));g.bound&&h(function(){f.hide();g.field&&g.field.blur()},100);return}l(b,"pika-prev")?f.prevMonth():l(b,"pika-next")&&f.nextMonth()}if(l(b,"pika-select"))f._c=!0;else if(a.preventDefault)a.preventDefault();else return a.returnValue=!1}}};f._onChange=function(a){a=a||window.event;(a=a.target||a.srcElement)&&(l(a,"pika-select-month")?f.gotoMonth(a.value):l(a,"pika-select-year")&&f.gotoYear(a.value))};f._onInputChange=function(b){b.firedBy!==
f&&(b=e?(b=a(g.field.value,g.format))&&b.isValid()?b.toDate():null:new Date(Date.parse(g.field.value)),f.setDate(q(b)?b:null),f._v||f.show())};f._onInputFocus=function(){f.show()};f._onInputClick=function(){f.show()};f._onInputBlur=function(){var a=k.activeElement;do if(l(a,"pika-single"))return;while(a=a.parentNode);f._c||(f._b=h(function(){f.hide()},50));f._c=!1};f._onClick=function(a){a=a||window.event;var b=a=a.target||a.srcElement;if(a){d||!l(a,"pika-select")||a.onchange||(a.setAttribute("onchange",
"return;"),c(a,"change",f._onChange));do if(l(b,"pika-single")||b===g.trigger)return;while(b=b.parentNode);f._v&&a!==g.trigger&&b!==g.trigger&&f.hide()}};f.el=k.createElement("div");f.el.className="pika-single"+(g.isRTL?" is-rtl":"");c(f.el,"mousedown",f._onMouseDown,!0);c(f.el,"change",f._onChange);g.field&&(g.container?g.container.appendChild(f.el):g.bound?k.body.appendChild(f.el):g.field.parentNode.insertBefore(f.el,g.field.nextSibling),c(g.field,"change",f._onInputChange),g.defaultDate||(g.defaultDate=
e&&g.field.value?a(g.field.value,g.format).toDate():new Date(Date.parse(g.field.value)),g.setDefaultDate=!0));b=g.defaultDate;q(b)?g.setDefaultDate?f.setDate(b,!0):f.gotoDate(b):f.gotoDate(new Date);g.bound?(this.hide(),f.el.className+=" is-bound",c(g.trigger,"click",f._onInputClick),c(g.trigger,"focus",f._onInputFocus),c(g.trigger,"blur",f._onInputBlur)):this.show()};B.prototype={config:function(a){this._o||(this._o=f({},w,!0));a=f(this._o,a,!0);a.isRTL=!!a.isRTL;a.field=a.field&&a.field.nodeName?
a.field:null;a.bound=!!(void 0!==a.bound?a.field&&a.bound:a.field);a.trigger=a.trigger&&a.trigger.nodeName?a.trigger:a.field;a.disableWeekends=!!a.disableWeekends;a.disableDayFn="function"==typeof a.disableDayFn?a.disableDayFn:null;var b=parseInt(a.numberOfMonths,10)||1;a.numberOfMonths=4<b?4:b;q(a.minDate)||(a.minDate=!1);q(a.maxDate)||(a.maxDate=!1);a.minDate&&a.maxDate&&a.maxDate<a.minDate&&(a.maxDate=a.minDate=!1);a.minDate&&(r(a.minDate),a.minYear=a.minDate.getFullYear(),a.minMonth=a.minDate.getMonth());
a.maxDate&&(r(a.maxDate),a.maxYear=a.maxDate.getFullYear(),a.maxMonth=a.maxDate.getMonth());g(a.yearRange)?(b=(new Date).getFullYear()-10,a.yearRange[0]=parseInt(a.yearRange[0],10)||b,a.yearRange[1]=parseInt(a.yearRange[1],10)||b):(a.yearRange=Math.abs(parseInt(a.yearRange,10))||w.yearRange,100<a.yearRange&&(a.yearRange=100));return a},toString:function(b){return q(this._d)?e?a(this._d).format(b||this._o.format):this._d.toDateString():""},getMoment:function(){return e?a(this._d):null},setMoment:function(b,
c){e&&a.isMoment(b)&&this.setDate(b.toDate(),c)},getDate:function(){return q(this._d)?new Date(this._d.getTime()):null},setDate:function(a,b){if(!a)return this._d=null,this._o.field&&(this._o.field.value="",p(this._o.field,"change",{firedBy:this})),this.draw();"string"===typeof a&&(a=new Date(Date.parse(a)));if(q(a)){var c=this._o.minDate,d=this._o.maxDate;q(c)&&a<c?a=c:q(d)&&a>d&&(a=d);this._d=new Date(a.getTime());r(this._d);this.gotoDate(this._d);this._o.field&&(this._o.field.value=this.toString(),
p(this._o.field,"change",{firedBy:this}));b||"function"!==typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(a){var b=!0;if(q(a)){if(this.calendars){var b=new Date(this.calendars[0].year,this.calendars[0].month,1),c=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),d=a.getTime();c.setMonth(c.getMonth()+1);c.setDate(c.getDate()-1);b=d<b.getTime()||c.getTime()<d}b&&(this.calendars=[{month:a.getMonth(),year:a.getFullYear()}],
"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths));this.adjustCalendars()}},adjustCalendars:function(){this.calendars[0]=n(this.calendars[0]);for(var a=1;a<this._o.numberOfMonths;a++)this.calendars[a]=n({month:this.calendars[0].month+a,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(a){isNaN(a)||(this.calendars[0].month=parseInt(a,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++;
this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--;this.adjustCalendars()},gotoYear:function(a){isNaN(a)||(this.calendars[0].year=parseInt(a,10),this.adjustCalendars())},setMinDate:function(a){this._o.minDate=a},setMaxDate:function(a){this._o.maxDate=a},draw:function(a){if(this._v||a){var b=this._o,c=b.minYear,d=b.maxYear,e=b.minMonth,f=b.maxMonth;a="";this._y<=c&&(this._y=c,!isNaN(e)&&this._m<e&&(this._m=e));this._y>=d&&(this._y=d,!isNaN(f)&&this._m>f&&(this._m=f));for(c=0;c<
b.numberOfMonths;c++)a+='<div class="pika-lendar">'+F(this,c,this.calendars[c].year,this.calendars[c].month,this.calendars[0].year)+this.render(this.calendars[c].year,this.calendars[c].month)+"</div>";this.el.innerHTML=a;b.bound&&"hidden"!==b.field.type&&h(function(){b.trigger.focus()},1);if("function"===typeof this._o.onDraw){var g=this;h(function(){g._o.onDraw.call(g)},0)}}},adjustPosition:function(){if(!this._o.container){var a=this._o.trigger,b=a,c=this.el.offsetWidth,d=this.el.offsetHeight,e=
window.innerWidth||k.documentElement.clientWidth,f=window.innerHeight||k.documentElement.clientHeight,g=window.pageYOffset||k.body.scrollTop||k.documentElement.scrollTop,h,l;if("function"===typeof a.getBoundingClientRect)b=a.getBoundingClientRect(),h=b.left+window.pageXOffset,l=b.bottom+window.pageYOffset;else for(h=b.offsetLeft,l=b.offsetTop+b.offsetHeight;b=b.offsetParent;)h+=b.offsetLeft,l+=b.offsetTop;if(this._o.reposition&&h+c>e||-1<this._o.position.indexOf("right")&&0<h-c+a.offsetWidth)h=h-
c+a.offsetWidth;if(this._o.reposition&&l+d>f+g||-1<this._o.position.indexOf("top")&&0<l-d-a.offsetHeight)l=l-d-a.offsetHeight;this.el.style.cssText=["position: absolute","left: "+h+"px","top: "+l+"px"].join(";")}},render:function(a,b){var c=this._o,d=new Date,e;e=[31,0===a%4&&0!==a%100||0===a%400?29:28,31,30,31,30,31,31,30,31,30,31][b];var f=(new Date(a,b,1)).getDay(),g=[],h=[];r(d);0<c.firstDay&&(f-=c.firstDay,0>f&&(f+=7));for(var k=e+f,l=k;7<l;)l-=7;for(var k=k+(7-l),m=l=0;l<k;l++){var n=new Date(a,
b,1+(l-f)),p;q(this._d)?(p=this._d,p=n.getTime()===p.getTime()):p=!1;var w;w=d;w=n.getTime()===w.getTime();var u=l<f||l>=e+f,B;!(B=c.minDate&&n<c.minDate||c.maxDate&&n>c.maxDate)&&(B=c.disableWeekends)&&(B=n.getDay(),B=0===B||6===B);n=B||c.disableDayFn&&c.disableDayFn(n);h.push(N(1+(l-f),b,a,p,w,n,u));7===++m&&(c.showWeekNumber&&h.unshift(W(l-f,b,a)),g.push(y(h,c.isRTL)),h=[],m=0)}e=[];c.showWeekNumber&&e.push("<th></th>");for(d=0;7>d;d++)e.push('<th scope="col"><abbr title="'+I(c,d)+'">'+I(c,d,!0)+
"</abbr></th>");return'<table cellpadding="0" cellspacing="0" class="pika-table">'+("<thead>"+(c.isRTL?e.reverse():e).join("")+"</thead>")+("<tbody>"+g.join("")+"</tbody>")+"</table>"},isVisible:function(){return this._v},show:function(){if(!this._v){var a=this.el,b;b=(" "+a.className+" ").replace(" is-hidden "," ");b=b.trim?b.trim():b.replace(/^\s+|\s+$/g,"");a.className=b;this._v=!0;this.draw();this._o.bound&&(c(k,"click",this._onClick),this.adjustPosition());"function"===typeof this._o.onOpen&&
this._o.onOpen.call(this)}},hide:function(){var a=this._v;if(!1!==a){this._o.bound&&b(k,"click",this._onClick);this.el.style.cssText="";var c=this.el;l(c,"is-hidden")||(c.className=""===c.className?"is-hidden":c.className+" is-hidden");this._v=!1;void 0!==a&&"function"===typeof this._o.onClose&&this._o.onClose.call(this)}},destroy:function(){this.hide();b(this.el,"mousedown",this._onMouseDown,!0);b(this.el,"change",this._onChange);this._o.field&&(b(this._o.field,"change",this._onInputChange),this._o.bound&&
(b(this._o.trigger,"click",this._onInputClick),b(this._o.trigger,"focus",this._onInputFocus),b(this._o.trigger,"blur",this._onInputBlur)));this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};return B})},{moment:"moment"}],zeroclipboard:[function(h,q,r){(function(a,e){var d=a.document,h=a.navigator,m=a.setTimeout,c=a.clearTimeout,b=a.setInterval,p=a.clearInterval,l=a.getComputedStyle,g=a.encodeURIComponent,r=a.ActiveXObject,v=a.Error,f=a.Number.parseInt||a.parseInt,n=a.Number.parseFloat||
a.parseFloat,w=a.Number.isNaN||a.isNaN,I=a.Date.now,N=a.Object.keys,W=a.Object.defineProperty,y=a.Object.prototype.hasOwnProperty,F=a.Array.prototype.slice,B=function(){var b=function(a){return a};if("function"===typeof a.wrap&&"function"===typeof a.unwrap)try{var c=d.createElement("div"),e=a.unwrap(c);1===c.nodeType&&e&&1===e.nodeType&&(b=a.unwrap)}catch(f){}return b}(),z=function(a){return F.call(a,0)},A=function(){var a,b,c,d,f,g=z(arguments),h=g[0]||{};a=1;for(b=g.length;a<b;a++)if(null!=(c=g[a]))for(d in c)y.call(c,
d)&&(f=c[d],h!==f&&f!==e&&(h[d]=f));return h},H=function(a){var b,c,d;if("object"!==typeof a||null==a||"number"===typeof a.nodeType)b=a;else if("number"===typeof a.length)for(b=[],c=0,d=a.length;c<d;c++)y.call(a,c)&&(b[c]=H(a[c]));else for(c in b={},a)y.call(a,c)&&(b[c]=H(a[c]));return b},M=function(a,b){if(a&&1===a.nodeType&&a.ownerDocument&&b&&(1===b.nodeType&&b.ownerDocument&&b.ownerDocument===a.ownerDocument||9===b.nodeType&&!b.ownerDocument&&b===a.ownerDocument)){do{if(a===b)return!0;a=a.parentNode}while(a)
}return!1},O=function(a){var b;"string"===typeof a&&a&&(a.split("#")[0].split("?"),b=a.slice(0,a.lastIndexOf("/")+1));return b},U=function(){var a,b,c;if(d.currentScript&&(a=d.currentScript.src))return a;b=d.getElementsByTagName("script");if(1===b.length)return b[0].src||e;if("readyState"in b[0])for(c=b.length;c--;)if("interactive"===b[c].readyState&&(a=b[c].src))return a;if("loading"===d.readyState&&(a=b[b.length-1].src))return a;var f;try{throw new v;}catch(g){b=g}if(b&&!(f=b.sourceURL||b.fileName)){f=
b.stack;var h;"string"===typeof f&&f&&((b=f.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/))&&b[1]?h=b[1]:(b=f.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/))&&b[1]&&(h=b[1]));f=h}return(a=f)?a:e},D=null==a.opener&&(!!a.top&&a!=a.top||!!a.parent&&a!=a.parent),x={bridge:null,version:"0.0.0",pluginType:"unknown",disabled:null,outdated:null,sandboxed:null,unavailable:null,degraded:null,
deactivated:null,overdue:null,ready:null},Z,S={},L,ca,E={},da=null,u=0,R=0,K={ready:"Flash communication is established",error:{"flash-disabled":"Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-sandboxed":"Attempting to run Flash in a sandboxed iframe, which is impossible","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript",
"flash-degraded":"Flash is unable to preserve data fidelity when communicating with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-overdue":"Flash communication was established but NOT within the acceptable time limit",
"version-mismatch":"ZeroClipboard JS version number does not match ZeroClipboard SWF version number","clipboard-error":"At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard","config-mismatch":"ZeroClipboard configuration does not match Flash's reality","swf-not-found":"The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity"}},ea="flash-unavailable flash-degraded flash-overdue version-mismatch config-mismatch clipboard-error".split(" "),
Y="flash-disabled flash-outdated flash-sandboxed flash-unavailable flash-degraded flash-deactivated flash-overdue".split(" "),fa=new RegExp("^flash-("+Y.map(function(a){return a.replace(/^flash-/,"")}).join("|")+")$"),ga=new RegExp("^flash-("+Y.slice(1).map(function(a){return a.replace(/^flash-/,"")}).join("|")+")$"),J={swfPath:function(){var a;if(!(a=O(U()))){var b,c,f=d.getElementsByTagName("script");for(a=f.length;a--;){if(!(c=f[a].src)){b=null;break}c=O(c);if(null==b)b=c;else if(b!==c){b=null;
break}}a=b||e}return(a||"")+"ZeroClipboard.swf"}(),trustedDomains:a.location.host?[a.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3E4,autoActivate:!0,bubbleEvents:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999},ba=function(a){if("object"===typeof a&&null!==
a)for(var b in a)if(y.call(a,b))if(/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(b))J[b]=a[b];else if(null==x.bridge)if("containerId"===b||"swfObjectId"===b){var c=a[b];if("string"===typeof c&&c&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(c))J[b]=a[b];else throw Error("The specified `"+b+"` value is not valid as an HTML4 Element ID");}else J[b]=a[b];if("string"===typeof a&&a){if(y.call(J,a))return J[a]}else return H(J)},oa=function(){Ta();for(var a=["userAgent","platform","appName"],b={},c=0,d=
a.length;c<d;c++)a[c]in h&&(b[a[c]]=h[a[c]]);var a=["bridge"],c={},e;for(e in x)-1===a.indexOf(e)&&(c[e]=x[e]);return{browser:b,flash:c,zeroclipboard:{version:C.version,config:C.config()}}},sa=function(){return!!(x.disabled||x.outdated||x.sandboxed||x.unavailable||x.degraded||x.deactivated)},ra=function(a,b){var c,d,f,g={};if("string"===typeof a&&a)f=a.toLowerCase().split(/\s+/);else if("object"===typeof a&&a&&"undefined"===typeof b)for(c in a)if(y.call(a,c)&&"string"===typeof c&&c&&"function"===
typeof a[c])C.on(c,a[c]);if(f&&f.length){c=0;for(d=f.length;c<d;c++)a=f[c].replace(/^on/,""),g[a]=!0,S[a]||(S[a]=[]),S[a].push(b);g.ready&&x.ready&&C.emit({type:"ready"});if(g.error){c=0;for(d=Y.length;c<d;c++)if(!0===x[Y[c].replace(/^flash-/,"")]){C.emit({type:"error",name:Y[c]});break}Z!==e&&C.version!==Z&&C.emit({type:"error",name:"version-mismatch",jsVersion:C.version,swfVersion:Z})}}return C},ha=function(a,b){var c,d,e,f,g;if(0===arguments.length)f=N(S);else if("string"===typeof a&&a)f=a.split(/\s+/);
else if("object"===typeof a&&a&&"undefined"===typeof b)for(c in a)y.call(a,c)&&"string"===typeof c&&c&&"function"===typeof a[c]&&C.off(c,a[c]);if(f&&f.length)for(c=0,d=f.length;c<d;c++)if(a=f[c].toLowerCase().replace(/^on/,""),(g=S[a])&&g.length)if(b)for(e=g.indexOf(b);-1!==e;)g.splice(e,1),e=g.indexOf(b,e);else g.length=0;return C},ia=function(a){return"string"===typeof a&&a?H(S[a])||null:H(S)},ja=function(b){var c,e,f;if(b=Ga(b)){c=b;var g=c.target||L||null,h="swf"===c._source;delete c._source;
switch(c.type){case "error":!(g="flash-sandboxed"===c.name)&&(g=null,!1===D||c&&"error"===c.type&&c.name&&-1!==ea.indexOf(c.name))&&(g=!1);"boolean"===typeof g&&(x.sandboxed=g);-1!==Y.indexOf(c.name)?A(x,{disabled:"flash-disabled"===c.name,outdated:"flash-outdated"===c.name,unavailable:"flash-unavailable"===c.name,degraded:"flash-degraded"===c.name,deactivated:"flash-deactivated"===c.name,overdue:"flash-overdue"===c.name,ready:!1}):"version-mismatch"===c.name&&(Z=c.swfVersion,A(x,{disabled:!1,outdated:!1,
unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1}));Ba();break;case "ready":Z=c.swfVersion;g=!0===x.deactivated;A(x,{disabled:!1,outdated:!1,sandboxed:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:g,ready:!g});Ba();break;case "beforecopy":ca=g;break;case "copy":var k,l,g=c.relatedTarget;!E["text/html"]&&!E["text/plain"]&&g&&(l=g.value||g.outerHTML||g.innerHTML)&&(k=g.value||g.textContent||g.innerText)?(c.clipboardData.clearData(),c.clipboardData.setData("text/plain",k),l!==k&&
c.clipboardData.setData("text/html",l)):!E["text/plain"]&&c.target&&(k=c.target.getAttribute("data-clipboard-text"))&&(c.clipboardData.clearData(),c.clipboardData.setData("text/plain",k));break;case "aftercopy":Za(c);C.clearData();if(k=g){var m;try{m=d.activeElement}catch(n){m=null}k=g!==m}k&&g.focus&&g.focus();break;case "_mouseover":C.focus(g);!0===J.bubbleEvents&&h&&(g&&g!==c.relatedTarget&&!M(c.relatedTarget,g)&&pa(A({},c,{type:"mouseenter",bubbles:!1,cancelable:!1})),pa(A({},c,{type:"mouseover"})));
break;case "_mouseout":C.blur();!0===J.bubbleEvents&&h&&(g&&g!==c.relatedTarget&&!M(c.relatedTarget,g)&&pa(A({},c,{type:"mouseleave",bubbles:!1,cancelable:!1})),pa(A({},c,{type:"mouseout"})));break;case "_mousedown":ma(g,J.activeClass);!0===J.bubbleEvents&&h&&pa(A({},c,{type:c.type.slice(1)}));break;case "_mouseup":Da(g,J.activeClass);!0===J.bubbleEvents&&h&&pa(A({},c,{type:c.type.slice(1)}));break;case "_click":ca=null;!0===J.bubbleEvents&&h&&pa(A({},c,{type:c.type.slice(1)}));break;case "_mousemove":!0===
J.bubbleEvents&&h&&pa(A({},c,{type:c.type.slice(1)}))}c=/^_(?:click|mouse(?:over|out|down|up|move))$/.test(c.type)?!0:void 0;if(!c){if("ready"===b.type&&!0===x.overdue)return C.emit({type:"error",name:"flash-overdue"});c=A({},b);if("object"===typeof c&&c&&c.type&&(g=Oa(c),(k=(S["*"]||[]).concat(S[c.type]||[]))&&k.length)){var p,q;l=0;for(m=k.length;l<m;l++)h=k[l],p=this,"string"===typeof h&&"function"===typeof a[h]&&(h=a[h]),"object"===typeof h&&h&&"function"===typeof h.handleEvent&&(p=h,h=h.handleEvent),
"function"===typeof h&&(q=A({},c),Ya(h,p,[q],g))}if("copy"===b.type){e={};b={};if("object"===typeof E&&E){for(f in E)if(f&&y.call(E,f)&&"string"===typeof E[f]&&E[f])switch(f.toLowerCase()){case "text/plain":case "text":case "air:text":case "flash:text":e.text=E[f];b.text=f;break;case "text/html":case "html":case "air:html":case "flash:html":e.html=E[f];b.html=f;break;case "application/rtf":case "text/rtf":case "rtf":case "richtext":case "air:rtf":case "flash:rtf":e.rtf=E[f],b.rtf=f}f={data:e,formatMap:b}}else f=
void 0;e=f.data;da=f.formatMap}return e}}},X=function(){var a=x.sandboxed;Ta();"boolean"!==typeof x.ready&&(x.ready=!1);x.sandboxed!==a&&!0===x.sandboxed?(x.ready=!1,C.emit({type:"error",name:"flash-sandboxed"})):C.isFlashUnusable()||null!==x.bridge||(a=J.flashLoadTimeout,"number"===typeof a&&0<=a&&(u=m(function(){"boolean"!==typeof x.deactivated&&(x.deactivated=!0);!0===x.deactivated&&C.emit({type:"error",name:"flash-deactivated"})},a)),x.overdue=!1,Aa())},va=function(){C.clearData();C.blur();C.emit("destroy");
lb();C.off()},Fa=function(a,b){var c;if("object"===typeof a&&a&&"undefined"===typeof b)c=a,C.clearData();else if("string"===typeof a&&a)c={},c[a]=b;else return;for(var d in c)"string"===typeof d&&d&&y.call(c,d)&&"string"===typeof c[d]&&c[d]&&(E[d]=c[d])},Ma=function(a){if("undefined"===typeof a){if(E)for(var b in E)y.call(E,b)&&delete E[b];da=null}else"string"===typeof a&&y.call(E,a)&&delete E[a]},Na=function(a){if("undefined"===typeof a)return H(E);if("string"===typeof a&&y.call(E,a))return E[a]},
fb=function(a){if(a&&1===a.nodeType){L&&(Da(L,J.activeClass),L!==a&&Da(L,J.hoverClass));L=a;ma(a,J.hoverClass);var b=a.getAttribute("title")||J.title;if("string"===typeof b&&b){var c=la(x.bridge);c&&c.setAttribute("title",b)}a=!0===J.forceHandCursor||"pointer"===cb(a,"cursor");!0===x.ready&&(x.bridge&&"function"===typeof x.bridge.setHandCursor?x.bridge.setHandCursor(a):x.ready=!1);var d;L&&(d=la(x.bridge))&&(a=Ra(L),A(d.style,{width:a.width+"px",height:a.height+"px",top:a.top+"px",left:a.left+"px",
zIndex:""+Sa(J.zIndex)}))}},T=function(){var a=la(x.bridge);a&&(a.removeAttribute("title"),a.style.left="0px",a.style.top="-9999px",a.style.width="1px",a.style.height="1px");L&&(Da(L,J.hoverClass),Da(L,J.activeClass),L=null)},gb=function(){return L||null},Ga=function(b){var c;"string"===typeof b&&b?(c=b,b={}):"object"===typeof b&&b&&"string"===typeof b.type&&b.type&&(c=b.type);if(c){c=c.toLowerCase();!b.target&&(/^(copy|aftercopy|_click)$/.test(c)||"error"===c&&"clipboard-error"===b.name)&&(b.target=
ca);A(b,{type:c,target:b.target||L||null,relatedTarget:b.relatedTarget||null,currentTarget:x&&x.bridge||null,timeStamp:b.timeStamp||I()||null});c=K[b.type];"error"===b.type&&b.name&&c&&(c=c[b.name]);c&&(b.message=c);"ready"===b.type&&A(b,{target:null,version:x.version});"error"===b.type&&(fa.test(b.name)&&A(b,{target:null,minimumVersion:"11.0.0"}),ga.test(b.name)&&A(b,{version:x.version}));"copy"===b.type&&(b.clipboardData={setData:C.setData,clearData:C.clearData});if("aftercopy"===b.type&&(c=da,
"object"===typeof b&&b&&"object"===typeof c&&c)){var f={},g;for(g in b)if(y.call(b,g))if("errors"===g){f[g]=b[g]?b[g].slice():[];for(var h=0,k=f[g].length;h<k;h++)f[g][h].format=c[f[g][h].format]}else if("success"!==g&&"data"!==g)f[g]=b[g];else{f[g]={};var h=b[g],l;for(l in h)l&&y.call(h,l)&&y.call(c,l)&&(f[g][c[l]]=h[l])}b=f}b.target&&!b.relatedTarget&&(g=b,l=(l=(l=b.target)&&l.getAttribute&&l.getAttribute("data-clipboard-target"))?d.getElementById(l):null,g.relatedTarget=l);if((g=b)&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(g.type)){l=
g.target;b="_mouseover"===g.type&&g.relatedTarget?g.relatedTarget:e;c="_mouseout"===g.type&&g.relatedTarget?g.relatedTarget:e;var h=Ra(l),f=h.left+("number"===typeof g._stageX?g._stageX:0),h=h.top+("number"===typeof g._stageY?g._stageY:0),k=f-(d.body.scrollLeft+d.documentElement.scrollLeft),m=h-(d.body.scrollTop+d.documentElement.scrollTop),n=(a.screenLeft||a.screenX||0)+k,p=(a.screenTop||a.screenY||0)+m,q="number"===typeof g.movementX?g.movementX:0,r="number"===typeof g.movementY?g.movementY:0;delete g._stageX;
delete g._stageY;A(g,{srcElement:l,fromElement:b,toElement:c,screenX:n,screenY:p,pageX:f,pageY:h,clientX:k,clientY:m,x:k,y:m,movementX:q,movementY:r,offsetX:0,offsetY:0,layerX:0,layerY:0})}return g}},Oa=function(a){return!/^(?:(?:before)?copy|destroy)$/.test(a&&"string"===typeof a.type&&a.type||"")},Ya=function(a,b,c,d){d?m(function(){a.apply(b,c)},0):a.apply(b,c)},Za=function(a){if(a.errors&&0<a.errors.length){var b=H(a);A(b,{type:"error",name:"clipboard-error"});delete b.success;m(function(){C.emit(b)},
0)}},pa=function(b){if(b&&"string"===typeof b.type&&b){var c,e=b.target||null;c=e&&e.ownerDocument||d;b=A({view:c.defaultView||a,canBubble:!0,cancelable:!0,detail:"click"===b.type?1:0,button:"number"===typeof b.which?b.which-1:"number"===typeof b.button?b.button:c.createEvent?0:1},b);e&&c.createEvent&&e.dispatchEvent&&(b=[b.type,b.canBubble,b.cancelable,b.view,b.detail,b.screenX,b.screenY,b.clientX,b.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,b.button,b.relatedTarget],c=c.createEvent("MouseEvents"),
c.initMouseEvent&&(c.initMouseEvent.apply(c,b),c._source="js",e.dispatchEvent(c)))}},kb=function(){var a=J.flashLoadTimeout;if("number"===typeof a&&0<=a){var a=Math.min(1E3,a/10),c=J.swfObjectId+"_fallbackContent";R=b(function(){var a;var b=d.getElementById(c);if(b){a=l(b,null);var e=0<n(a.height),f=0<n(a.width),g=0<=n(a.top),h=0<=n(a.left),k=e&&f&&g&&h,b=k?null:Ra(b);a="none"!==a.display&&"collapse"!==a.visibility&&(k||!!b&&(e||0<b.height)&&(f||0<b.width)&&(g||0<=b.top)&&(h||0<=b.left))}else a=!1;
a&&(Ba(),x.deactivated=null,C.emit({type:"error",name:"swf-not-found"}))},a)}},la=function(a){for(a=a&&a.parentNode;a&&"OBJECT"===a.nodeName&&a.parentNode;)a=a.parentNode;return a||null},Aa=function(){var b,c=x.bridge,e=la(c);if(!c){var c=mb(a.location.host,J),f="never"===c?"none":"all",h,e=A({jsVersion:C.version},J),k,l,m,n="",p=[];e.trustedDomains&&("string"===typeof e.trustedDomains?h=[e.trustedDomains]:"object"===typeof e.trustedDomains&&"length"in e.trustedDomains&&(h=e.trustedDomains));if(h&&
h.length)for(k=0,l=h.length;k<l;k++)if(y.call(h,k)&&h[k]&&"string"===typeof h[k]&&(m=Qa(h[k]))){if("*"===m){p.length=0;p.push(m);break}p.push.apply(p,[m,"//"+m,a.location.protocol+"//"+m])}p.length&&(n+="trustedOrigins="+g(p.join(",")));!0===e.forceEnhancedClipboard&&(n+=(n?"&":"")+"forceEnhancedClipboard=true");"string"===typeof e.swfObjectId&&e.swfObjectId&&(n+=(n?"&":"")+"swfObjectId="+g(e.swfObjectId));"string"===typeof e.jsVersion&&e.jsVersion&&(n+=(n?"&":"")+"jsVersion="+g(e.jsVersion));h=n;
e=J.swfPath;k=null==J||J&&!0===J.cacheBust?(-1===J.swfPath.indexOf("?")?"?":"&")+"noCache="+I():"";k=e+k;e=d.createElement("div");e.id=J.containerId;e.className=J.containerClass;e.style.position="absolute";e.style.left="0px";e.style.top="-9999px";e.style.width="1px";e.style.height="1px";e.style.zIndex=""+Sa(J.zIndex);l=d.createElement("div");e.appendChild(l);d.body.appendChild(e);m=d.createElement("div");n="activex"===x.pluginType;m.innerHTML='<object id="'+J.swfObjectId+'" name="'+J.swfObjectId+
'" width="100%" height="100%" '+(n?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+k+'"')+">"+(n?'<param name="movie" value="'+k+'"/>':"")+'<param name="allowScriptAccess" value="'+c+'"/><param name="allowNetworking" value="'+f+'"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="'+h+'"/><div id="'+J.swfObjectId+'_fallbackContent">&nbsp;</div></object>';c=m.firstChild;B(c).ZeroClipboard=C;
e.replaceChild(c,l);kb()}c||((c=d[J.swfObjectId])&&(b=c.length)&&(c=c[b-1]),!c&&e&&(c=e.firstChild));x.bridge=c||null;return c},lb=function(){var a=x.bridge;if(a){var b=la(a);b&&("activex"===x.pluginType&&"readyState"in a?(a.style.display="none",function pb(){if(4===a.readyState){for(var c in a)"function"===typeof a[c]&&(a[c]=null);a.parentNode&&a.parentNode.removeChild(a);b.parentNode&&b.parentNode.removeChild(b)}else m(pb,10)}()):(a.parentNode&&a.parentNode.removeChild(a),b.parentNode&&b.parentNode.removeChild(b)));
Ba();x.ready=null;x.bridge=null;x.deactivated=null;Z=e}},Qa=function(a){if(null==a||""===a)return null;a=a.replace(/^\s+|\s+$/g,"");if(""===a)return null;var b=a.indexOf("//");a=-1===b?a:a.slice(b+2);var c=a.indexOf("/");return(a=-1===c?a:-1===b||0===c?null:a.slice(0,c))&&".swf"===a.slice(-4).toLowerCase()?null:a||null},mb=function(){return function(a,b){var c=Qa(b.swfPath);null===c&&(c=a);var d=b.trustedDomains,e,f,g,h=[];"string"===typeof d&&(d=[d]);if("object"===typeof d&&d&&"number"===typeof d.length)for(e=
0,f=d.length;e<f;e++)if(y.call(d,e)&&(g=Qa(d[e]))){if("*"===g){h.length=0;h.push("*");break}-1===h.indexOf(g)&&h.push(g)}d=h.length;if(0<d){if(1===d&&"*"===h[0])return"always";if(-1!==h.indexOf(a))return 1===d&&a===c?"sameDomain":"always"}return"never"}}(),ma=function(a,b){var c,d,e,f=[];"string"===typeof b&&b&&(f=b.split(/\s+/));if(a&&1===a.nodeType&&0<f.length)if(a.classList)for(c=0,d=f.length;c<d;c++)a.classList.add(f[c]);else if(a.hasOwnProperty("className")){e=" "+a.className+" ";c=0;for(d=f.length;c<
d;c++)-1===e.indexOf(" "+f[c]+" ")&&(e+=f[c]+" ");a.className=e.replace(/^\s+|\s+$/g,"")}return a},Da=function(a,b){var c,d,e,f=[];"string"===typeof b&&b&&(f=b.split(/\s+/));if(a&&1===a.nodeType&&0<f.length)if(a.classList&&0<a.classList.length)for(c=0,d=f.length;c<d;c++)a.classList.remove(f[c]);else if(a.className){e=(" "+a.className+" ").replace(/[\r\n\t]/g," ");c=0;for(d=f.length;c<d;c++)e=e.replace(" "+f[c]+" "," ");a.className=e.replace(/^\s+|\s+$/g,"")}return a},cb=function(a,b){var c=l(a,null).getPropertyValue(b);
return"cursor"!==b||c&&"auto"!==c||"A"!==a.nodeName?c:"pointer"},Ra=function(b){var c={left:0,top:0,width:0,height:0};if(b.getBoundingClientRect){b=b.getBoundingClientRect();var e=a.pageXOffset,f=a.pageYOffset,g=d.documentElement.clientLeft||0,h=d.documentElement.clientTop||0,k=0,l=0;if("relative"===cb(d.body,"position"))var l=d.body.getBoundingClientRect(),m=d.documentElement.getBoundingClientRect(),k=l.left-m.left||0,l=l.top-m.top||0;c.left=b.left+e-g-k;c.top=b.top+f-h-l;c.width="width"in b?b.width:
b.right-b.left;c.height="height"in b?b.height:b.bottom-b.top}return c},Ba=function(){c(u);u=0;p(R);R=0},Sa=function(a){if(/^(?:auto|inherit)$/.test(a))return a;var b;"number"!==typeof a||w(a)?"string"===typeof a&&(b=Sa(f(a,10))):b=a;return"number"===typeof b?b:"auto"},Ta=function(b){var c,d,e,f=x.sandboxed,g=null;b=!0===b;if(!1===D)g=!1;else{try{d=a.frameElement||null}catch(h){e={name:h.name,message:h.message}}if(d&&1===d.nodeType&&"IFRAME"===d.nodeName)try{g=d.hasAttribute("sandbox")}catch(k){g=
null}else{try{c=document.domain||null}catch(l){c=null}if(null===c||e&&"SecurityError"===e.name&&/(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(e.message.toLowerCase()))g=!0}}x.sandboxed=g;f===g||b||db(r);return g},db=function(a){function b(a){a=a.match(/[\d]+/g);a.length=3;return a.join(".")}function c(a){a&&(e=!0,a.version&&(l=b(a.version)),!l&&a.description&&(l=b(a.description)),a.filename&&(a=a.filename,g=!!a&&(a=a.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(a)||
"chrome.plugin"===a.slice(-13))))}var d,e=!1,f=!1,g=!1,l="";if(h.plugins&&h.plugins.length)a=h.plugins["Shockwave Flash"],c(a),h.plugins["Shockwave Flash 2.0"]&&(e=!0,l="2.0.0.11");else if(h.mimeTypes&&h.mimeTypes.length)a=(a=h.mimeTypes["application/x-shockwave-flash"])&&a.enabledPlugin,c(a);else if("undefined"!==typeof a){f=!0;try{d=new a("ShockwaveFlash.ShockwaveFlash.7"),e=!0,l=b(d.GetVariable("$version"))}catch(m){try{d=new a("ShockwaveFlash.ShockwaveFlash.6"),e=!0,l="6.0.21"}catch(p){try{d=
new a("ShockwaveFlash.ShockwaveFlash"),e=!0,l=b(d.GetVariable("$version"))}catch(q){f=!1}}}}x.disabled=!0!==e;x.outdated=l&&n(l)<n("11.0.0");x.version=l||"0.0.0";x.pluginType=g?"pepper":f?"activex":e?"netscape":"unknown"};db(r);Ta(!0);var C=function(){if(!(this instanceof C))return new C;"function"===typeof C._createClient&&C._createClient.apply(this,z(arguments))};W(C,"version",{value:"2.2.0",writable:!1,configurable:!0,enumerable:!0});C.config=function(){return ba.apply(this,z(arguments))};C.state=
function(){return oa.apply(this,z(arguments))};C.isFlashUnusable=function(){return sa.apply(this,z(arguments))};C.on=function(){return ra.apply(this,z(arguments))};C.off=function(){return ha.apply(this,z(arguments))};C.handlers=function(){return ia.apply(this,z(arguments))};C.emit=function(){return ja.apply(this,z(arguments))};C.create=function(){return X.apply(this,z(arguments))};C.destroy=function(){return va.apply(this,z(arguments))};C.setData=function(){return Fa.apply(this,z(arguments))};C.clearData=
function(){return Ma.apply(this,z(arguments))};C.getData=function(){return Na.apply(this,z(arguments))};C.focus=C.activate=function(){return fb.apply(this,z(arguments))};C.blur=C.deactivate=function(){return T.apply(this,z(arguments))};C.activeElement=function(){return gb.apply(this,z(arguments))};var nb=0,V={},ob=0,na={},ta={};A(J,{autoActivate:!0});var yb=function(a){var b=this;b.id=""+nb++;V[b.id]={instance:b,elements:[],handlers:{}};a&&b.clip(a);C.on("*",function(a){return b.emit(a)});C.on("destroy",
function(){b.destroy()});C.create()},Ua=function(a,b){var c,d,f,g={},h=(d=V[this.id])&&d.handlers;if(!d)throw Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");if("string"===typeof a&&a)f=a.toLowerCase().split(/\s+/);else if("object"===typeof a&&a&&"undefined"===typeof b)for(c in a)if(y.call(a,c)&&"string"===typeof c&&c&&"function"===typeof a[c])this.on(c,a[c]);if(f&&f.length){c=0;for(d=f.length;c<d;c++)a=f[c].replace(/^on/,""),g[a]=!0,h[a]||(h[a]=[]),h[a].push(b);
g.ready&&x.ready&&this.emit({type:"ready",client:this});if(g.error){c=0;for(d=Y.length;c<d;c++)if(x[Y[c].replace(/^flash-/,"")]){this.emit({type:"error",name:Y[c],client:this});break}Z!==e&&C.version!==Z&&this.emit({type:"error",name:"version-mismatch",jsVersion:C.version,swfVersion:Z})}}return this},hb=function(a,b){var c,d,e,f,g,h=(d=V[this.id])&&d.handlers;if(!h)return this;if(0===arguments.length)f=N(h);else if("string"===typeof a&&a)f=a.split(/\s+/);else if("object"===typeof a&&a&&"undefined"===
typeof b)for(c in a)y.call(a,c)&&"string"===typeof c&&c&&"function"===typeof a[c]&&this.off(c,a[c]);if(f&&f.length)for(c=0,d=f.length;c<d;c++)if(a=f[c].toLowerCase().replace(/^on/,""),(g=h[a])&&g.length)if(b)for(e=g.indexOf(b);-1!==e;)g.splice(e,1),e=g.indexOf(b,e);else g.length=0;return this},$a=function(a){var b=null,c=V[this.id]&&V[this.id].handlers;c&&(b="string"===typeof a&&a?c[a]?c[a].slice(0):[]:H(c));return b},ab=function(b){var c;var d=b;if(!d||!d.type||d.client&&d.client!==this)c=!1;else{var e=
(c=V[this.id])&&c.elements,f=!!e&&0<e.length,g=!d.target||f&&-1!==e.indexOf(d.target),e=d.relatedTarget&&f&&-1!==e.indexOf(d.relatedTarget),d=d.client&&d.client===this;c=c&&(g||e||d)?!0:!1}if(c&&("object"===typeof b&&b&&"string"===typeof b.type&&b.type&&(b=A({},b)),b=A({},Ga(b),{client:this}),g=V[this.id],"object"===typeof b&&b&&b.type&&g&&(c=Oa(b),(g=(g&&g.handlers["*"]||[]).concat(g&&g.handlers[b.type]||[]))&&g.length)))for(var h,k,d=0,e=g.length;d<e;d++)f=g[d],h=this,"string"===typeof f&&"function"===
typeof a[f]&&(f=a[f]),"object"===typeof f&&f&&"function"===typeof f.handleEvent&&(h=f,f=f.handleEvent),"function"===typeof f&&(k=A({},b),Ya(f,h,[k],c));return this},wa=function(a){if(!V[this.id])throw Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");a=Ia(a);for(var b=0;b<a.length;b++)if(y.call(a,b)&&a[b]&&1===a[b].nodeType){a[b].zcClippingId?-1===na[a[b].zcClippingId].indexOf(this.id)&&na[a[b].zcClippingId].push(this.id):(a[b].zcClippingId="zcClippingId_"+ob++,na[a[b].zcClippingId]=
[this.id],!0===J.autoActivate&&bb(a[b]));var c=V[this.id]&&V[this.id].elements;-1===c.indexOf(a[b])&&c.push(a[b])}return this},Pa=function(a){var b=V[this.id];if(!b)return this;var b=b.elements,c;a="undefined"===typeof a?b.slice(0):Ia(a);for(var d=a.length;d--;)if(y.call(a,d)&&a[d]&&1===a[d].nodeType){for(c=0;-1!==(c=b.indexOf(a[d],c));)b.splice(c,1);var e=na[a[d].zcClippingId];if(e){for(c=0;-1!==(c=e.indexOf(this.id,c));)e.splice(c,1);if(0===e.length){if(!0===J.autoActivate&&(c=a[d])&&1===c.nodeType&&
(e=ta[c.zcClippingId],"object"===typeof e&&e)){for(var f=void 0,g=void 0,h=["move","leave","enter","out","over"],k=0,l=h.length;k<l;k++)f="mouse"+h[k],g=e[f],"function"===typeof g&&c.removeEventListener(f,g,!1);delete ta[c.zcClippingId]}delete a[d].zcClippingId}}}return this},Ha=function(){var a=V[this.id];return a&&a.elements?a.elements.slice(0):[]},ib=function(){V[this.id]&&(this.unclip(),this.off(),delete V[this.id])},Ia=function(a){"string"===typeof a&&(a=[]);return"number"!==typeof a.length?
[a]:a},bb=function(b){if(b&&1===b.nodeType){var c=function(b){if(b||(b=a.event))"js"!==b._source&&(b.stopImmediatePropagation(),b.preventDefault()),delete b._source},d=function(d){if(d||(d=a.event))c(d),C.focus(b)};b.addEventListener("mouseover",d,!1);b.addEventListener("mouseout",c,!1);b.addEventListener("mouseenter",c,!1);b.addEventListener("mouseleave",c,!1);b.addEventListener("mousemove",c,!1);ta[b.zcClippingId]={mouseover:d,mouseout:c,mouseenter:c,mouseleave:c,mousemove:c}}};C._createClient=
function(){yb.apply(this,z(arguments))};C.prototype.on=function(){return Ua.apply(this,z(arguments))};C.prototype.off=function(){return hb.apply(this,z(arguments))};C.prototype.handlers=function(){return $a.apply(this,z(arguments))};C.prototype.emit=function(){return ab.apply(this,z(arguments))};C.prototype.clip=function(){return wa.apply(this,z(arguments))};C.prototype.unclip=function(){return Pa.apply(this,z(arguments))};C.prototype.elements=function(){return Ha.apply(this,z(arguments))};C.prototype.destroy=
function(){return ib.apply(this,z(arguments))};C.prototype.setText=function(a){if(!V[this.id])throw Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");C.setData("text/plain",a);return this};C.prototype.setHtml=function(a){if(!V[this.id])throw Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");C.setData("text/html",a);return this};C.prototype.setRichText=function(a){if(!V[this.id])throw Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
C.setData("application/rtf",a);return this};C.prototype.setData=function(){if(!V[this.id])throw Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");C.setData.apply(this,z(arguments));return this};C.prototype.clearData=function(){if(!V[this.id])throw Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");C.clearData.apply(this,z(arguments));return this};C.prototype.getData=function(){if(!V[this.id])throw Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");
return C.getData.apply(this,z(arguments))};"function"===typeof define&&define.amd?define(function(){return C}):"object"===typeof q&&q&&"object"===typeof q.exports&&q.exports?q.exports=C:a.ZeroClipboard=C})(function(){return this||window}())},{}]},{},[23,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,86,87,88,72,73,74,75,76,77,31,35,40,32,33,34,36,37,38,39]);
